<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>forecast &mdash; Merlion 2.0.1 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="ensemble" href="merlion.models.ensemble.html" />
    <link rel="prev" title="anomaly.change_point" href="merlion.models.anomaly.change_point.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Merlion
          </a>
              <div class="version">
                latest
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="merlion.html">merlion: Time Series Intelligence</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="merlion.models.html">merlion.models package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="merlion.models.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="merlion.models.anomaly.html">anomaly</a></li>
<li class="toctree-l4"><a class="reference internal" href="merlion.models.anomaly.change_point.html">anomaly.change_point</a></li>
<li class="toctree-l4"><a class="reference internal" href="merlion.models.anomaly.forecast_based.html">anomaly.forecast_based</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">forecast</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#base-classes">Base classes</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#module-merlion.models.forecast.base">forecast.base</a><ul>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.base.ForecasterConfig"><code class="docutils literal notranslate"><span class="pre">ForecasterConfig</span></code></a><ul>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.base.ForecasterConfig.max_forecast_steps"><code class="docutils literal notranslate"><span class="pre">ForecasterConfig.max_forecast_steps</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.base.ForecasterConfig.target_seq_index"><code class="docutils literal notranslate"><span class="pre">ForecasterConfig.target_seq_index</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.base.ForecasterConfig.invert_transform"><code class="docutils literal notranslate"><span class="pre">ForecasterConfig.invert_transform</span></code></a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase"><code class="docutils literal notranslate"><span class="pre">ForecasterBase</span></code></a><ul>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase.config_class"><code class="docutils literal notranslate"><span class="pre">ForecasterBase.config_class</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase.target_name"><code class="docutils literal notranslate"><span class="pre">ForecasterBase.target_name</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase.max_forecast_steps"><code class="docutils literal notranslate"><span class="pre">ForecasterBase.max_forecast_steps</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase.target_seq_index"><code class="docutils literal notranslate"><span class="pre">ForecasterBase.target_seq_index</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase.invert_transform"><code class="docutils literal notranslate"><span class="pre">ForecasterBase.invert_transform</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase.require_univariate"><code class="docutils literal notranslate"><span class="pre">ForecasterBase.require_univariate</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase.support_multivariate_output"><code class="docutils literal notranslate"><span class="pre">ForecasterBase.support_multivariate_output</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase.resample_time_stamps"><code class="docutils literal notranslate"><span class="pre">ForecasterBase.resample_time_stamps()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase.train_pre_process"><code class="docutils literal notranslate"><span class="pre">ForecasterBase.train_pre_process()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase.train"><code class="docutils literal notranslate"><span class="pre">ForecasterBase.train()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase.train_post_process"><code class="docutils literal notranslate"><span class="pre">ForecasterBase.train_post_process()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase.transform_exog_data"><code class="docutils literal notranslate"><span class="pre">ForecasterBase.transform_exog_data()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase.forecast"><code class="docutils literal notranslate"><span class="pre">ForecasterBase.forecast()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase.batch_forecast"><code class="docutils literal notranslate"><span class="pre">ForecasterBase.batch_forecast()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase.get_figure"><code class="docutils literal notranslate"><span class="pre">ForecasterBase.get_figure()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase.plot_forecast"><code class="docutils literal notranslate"><span class="pre">ForecasterBase.plot_forecast()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase.plot_forecast_plotly"><code class="docutils literal notranslate"><span class="pre">ForecasterBase.plot_forecast_plotly()</span></code></a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.base.ForecasterExogConfig"><code class="docutils literal notranslate"><span class="pre">ForecasterExogConfig</span></code></a><ul>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.base.ForecasterExogConfig.exog_transform"><code class="docutils literal notranslate"><span class="pre">ForecasterExogConfig.exog_transform</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.base.ForecasterExogConfig.exog_aggregation_policy"><code class="docutils literal notranslate"><span class="pre">ForecasterExogConfig.exog_aggregation_policy</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.base.ForecasterExogConfig.exog_missing_value_policy"><code class="docutils literal notranslate"><span class="pre">ForecasterExogConfig.exog_missing_value_policy</span></code></a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.base.ForecasterExogBase"><code class="docutils literal notranslate"><span class="pre">ForecasterExogBase</span></code></a><ul>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.base.ForecasterExogBase.supports_exog"><code class="docutils literal notranslate"><span class="pre">ForecasterExogBase.supports_exog</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.base.ForecasterExogBase.exog_transform"><code class="docutils literal notranslate"><span class="pre">ForecasterExogBase.exog_transform</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.base.ForecasterExogBase.exog_aggregation_policy"><code class="docutils literal notranslate"><span class="pre">ForecasterExogBase.exog_aggregation_policy</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.base.ForecasterExogBase.exog_missing_value_policy"><code class="docutils literal notranslate"><span class="pre">ForecasterExogBase.exog_missing_value_policy</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.base.ForecasterExogBase.transform_exog_data"><code class="docutils literal notranslate"><span class="pre">ForecasterExogBase.transform_exog_data()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="#module-merlion.models.forecast.deep_base">forecast.deep_base</a><ul>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.deep_base.DeepForecasterConfig"><code class="docutils literal notranslate"><span class="pre">DeepForecasterConfig</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.deep_base.DeepForecaster"><code class="docutils literal notranslate"><span class="pre">DeepForecaster</span></code></a><ul>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.deep_base.DeepForecaster.config_class"><code class="docutils literal notranslate"><span class="pre">DeepForecaster.config_class</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.deep_base.DeepForecaster.support_multivariate_output"><code class="docutils literal notranslate"><span class="pre">DeepForecaster.support_multivariate_output</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.deep_base.DeepForecaster.require_even_sampling"><code class="docutils literal notranslate"><span class="pre">DeepForecaster.require_even_sampling</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="#module-merlion.models.forecast.sklearn_base">forecast.sklearn_base</a><ul>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.sklearn_base.SKLearnForecasterConfig"><code class="docutils literal notranslate"><span class="pre">SKLearnForecasterConfig</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.sklearn_base.SKLearnForecaster"><code class="docutils literal notranslate"><span class="pre">SKLearnForecaster</span></code></a><ul>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.sklearn_base.SKLearnForecaster.config_class"><code class="docutils literal notranslate"><span class="pre">SKLearnForecaster.config_class</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.sklearn_base.SKLearnForecaster.model"><code class="docutils literal notranslate"><span class="pre">SKLearnForecaster.model</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.sklearn_base.SKLearnForecaster.maxlags"><code class="docutils literal notranslate"><span class="pre">SKLearnForecaster.maxlags</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.sklearn_base.SKLearnForecaster.prediction_stride"><code class="docutils literal notranslate"><span class="pre">SKLearnForecaster.prediction_stride</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.sklearn_base.SKLearnForecaster.require_even_sampling"><code class="docutils literal notranslate"><span class="pre">SKLearnForecaster.require_even_sampling</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.sklearn_base.SKLearnForecaster.require_univariate"><code class="docutils literal notranslate"><span class="pre">SKLearnForecaster.require_univariate</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="#univariate-models">Univariate models</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#module-merlion.models.forecast.arima">forecast.arima</a><ul>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.arima.ArimaConfig"><code class="docutils literal notranslate"><span class="pre">ArimaConfig</span></code></a><ul>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.arima.ArimaConfig.seasonal_order"><code class="docutils literal notranslate"><span class="pre">ArimaConfig.seasonal_order</span></code></a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.arima.Arima"><code class="docutils literal notranslate"><span class="pre">Arima</span></code></a><ul>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.arima.Arima.config_class"><code class="docutils literal notranslate"><span class="pre">Arima.config_class</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="#module-merlion.models.forecast.sarima">forecast.sarima</a><ul>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.sarima.SarimaConfig"><code class="docutils literal notranslate"><span class="pre">SarimaConfig</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.sarima.Sarima"><code class="docutils literal notranslate"><span class="pre">Sarima</span></code></a><ul>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.sarima.Sarima.config_class"><code class="docutils literal notranslate"><span class="pre">Sarima.config_class</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.sarima.Sarima.require_even_sampling"><code class="docutils literal notranslate"><span class="pre">Sarima.require_even_sampling</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.sarima.Sarima.order"><code class="docutils literal notranslate"><span class="pre">Sarima.order</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.sarima.Sarima.seasonal_order"><code class="docutils literal notranslate"><span class="pre">Sarima.seasonal_order</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.sarima.Sarima.set_seasonality"><code class="docutils literal notranslate"><span class="pre">Sarima.set_seasonality()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="#module-merlion.models.forecast.ets">forecast.ets</a><ul>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.ets.ETSConfig"><code class="docutils literal notranslate"><span class="pre">ETSConfig</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.ets.ETS"><code class="docutils literal notranslate"><span class="pre">ETS</span></code></a><ul>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.ets.ETS.config_class"><code class="docutils literal notranslate"><span class="pre">ETS.config_class</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.ets.ETS.require_even_sampling"><code class="docutils literal notranslate"><span class="pre">ETS.require_even_sampling</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.ets.ETS.error"><code class="docutils literal notranslate"><span class="pre">ETS.error</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.ets.ETS.trend"><code class="docutils literal notranslate"><span class="pre">ETS.trend</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.ets.ETS.damped_trend"><code class="docutils literal notranslate"><span class="pre">ETS.damped_trend</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.ets.ETS.seasonal"><code class="docutils literal notranslate"><span class="pre">ETS.seasonal</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.ets.ETS.seasonal_periods"><code class="docutils literal notranslate"><span class="pre">ETS.seasonal_periods</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.ets.ETS.set_seasonality"><code class="docutils literal notranslate"><span class="pre">ETS.set_seasonality()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="#module-merlion.models.forecast.prophet">forecast.prophet</a><ul>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.prophet.ProphetConfig"><code class="docutils literal notranslate"><span class="pre">ProphetConfig</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.prophet.Prophet"><code class="docutils literal notranslate"><span class="pre">Prophet</span></code></a><ul>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.prophet.Prophet.config_class"><code class="docutils literal notranslate"><span class="pre">Prophet.config_class</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.prophet.Prophet.require_even_sampling"><code class="docutils literal notranslate"><span class="pre">Prophet.require_even_sampling</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.prophet.Prophet.yearly_seasonality"><code class="docutils literal notranslate"><span class="pre">Prophet.yearly_seasonality</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.prophet.Prophet.weekly_seasonality"><code class="docutils literal notranslate"><span class="pre">Prophet.weekly_seasonality</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.prophet.Prophet.daily_seasonality"><code class="docutils literal notranslate"><span class="pre">Prophet.daily_seasonality</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.prophet.Prophet.add_seasonality"><code class="docutils literal notranslate"><span class="pre">Prophet.add_seasonality</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.prophet.Prophet.seasonality_mode"><code class="docutils literal notranslate"><span class="pre">Prophet.seasonality_mode</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.prophet.Prophet.holidays"><code class="docutils literal notranslate"><span class="pre">Prophet.holidays</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.prophet.Prophet.uncertainty_samples"><code class="docutils literal notranslate"><span class="pre">Prophet.uncertainty_samples</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.prophet.Prophet.set_seasonality"><code class="docutils literal notranslate"><span class="pre">Prophet.set_seasonality()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="#module-merlion.models.forecast.smoother">forecast.smoother</a><ul>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.smoother.MSESConfig"><code class="docutils literal notranslate"><span class="pre">MSESConfig</span></code></a><ul>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.smoother.MSESConfig.max_scale"><code class="docutils literal notranslate"><span class="pre">MSESConfig.max_scale</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.smoother.MSESConfig.backsteps"><code class="docutils literal notranslate"><span class="pre">MSESConfig.backsteps</span></code></a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.smoother.MSESTrainConfig"><code class="docutils literal notranslate"><span class="pre">MSESTrainConfig</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.smoother.MSES"><code class="docutils literal notranslate"><span class="pre">MSES</span></code></a><ul>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.smoother.MSES.config_class"><code class="docutils literal notranslate"><span class="pre">MSES.config_class</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.smoother.MSES.require_even_sampling"><code class="docutils literal notranslate"><span class="pre">MSES.require_even_sampling</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.smoother.MSES.rho"><code class="docutils literal notranslate"><span class="pre">MSES.rho</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.smoother.MSES.backsteps"><code class="docutils literal notranslate"><span class="pre">MSES.backsteps</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.smoother.MSES.max_horizon"><code class="docutils literal notranslate"><span class="pre">MSES.max_horizon</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.smoother.MSES.update"><code class="docutils literal notranslate"><span class="pre">MSES.update()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.smoother.MSES.xhat_h"><code class="docutils literal notranslate"><span class="pre">MSES.xhat_h()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.smoother.MSES.marginalize_xhat_h"><code class="docutils literal notranslate"><span class="pre">MSES.marginalize_xhat_h()</span></code></a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.smoother.DeltaStats"><code class="docutils literal notranslate"><span class="pre">DeltaStats</span></code></a><ul>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.smoother.DeltaStats.lag"><code class="docutils literal notranslate"><span class="pre">DeltaStats.lag</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.smoother.DeltaStats.update_velocity"><code class="docutils literal notranslate"><span class="pre">DeltaStats.update_velocity()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.smoother.DeltaStats.update_acceleration"><code class="docutils literal notranslate"><span class="pre">DeltaStats.update_acceleration()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.smoother.DeltaStats.update_loss"><code class="docutils literal notranslate"><span class="pre">DeltaStats.update_loss()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.smoother.DeltaStats.tune"><code class="docutils literal notranslate"><span class="pre">DeltaStats.tune()</span></code></a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.smoother.DeltaEstimator"><code class="docutils literal notranslate"><span class="pre">DeltaEstimator</span></code></a><ul>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.smoother.DeltaEstimator.acc_max_scale"><code class="docutils literal notranslate"><span class="pre">DeltaEstimator.acc_max_scale</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.smoother.DeltaEstimator.max_scale"><code class="docutils literal notranslate"><span class="pre">DeltaEstimator.max_scale</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.smoother.DeltaEstimator.data"><code class="docutils literal notranslate"><span class="pre">DeltaEstimator.data</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.smoother.DeltaEstimator.x"><code class="docutils literal notranslate"><span class="pre">DeltaEstimator.x</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.smoother.DeltaEstimator.train"><code class="docutils literal notranslate"><span class="pre">DeltaEstimator.train()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.smoother.DeltaEstimator.process_losses"><code class="docutils literal notranslate"><span class="pre">DeltaEstimator.process_losses()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.smoother.DeltaEstimator.velocity"><code class="docutils literal notranslate"><span class="pre">DeltaEstimator.velocity()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.smoother.DeltaEstimator.acceleration"><code class="docutils literal notranslate"><span class="pre">DeltaEstimator.acceleration()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.smoother.DeltaEstimator.vel_err"><code class="docutils literal notranslate"><span class="pre">DeltaEstimator.vel_err()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.smoother.DeltaEstimator.pos_err"><code class="docutils literal notranslate"><span class="pre">DeltaEstimator.pos_err()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.smoother.DeltaEstimator.neg_err"><code class="docutils literal notranslate"><span class="pre">DeltaEstimator.neg_err()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.smoother.DeltaEstimator.loss_err"><code class="docutils literal notranslate"><span class="pre">DeltaEstimator.loss_err()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.smoother.DeltaEstimator.delta_hat"><code class="docutils literal notranslate"><span class="pre">DeltaEstimator.delta_hat()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="#multivariate-models">Multivariate models</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#module-merlion.models.forecast.vector_ar">forecast.vector_ar</a><ul>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.vector_ar.VectorARConfig"><code class="docutils literal notranslate"><span class="pre">VectorARConfig</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.vector_ar.VectorAR"><code class="docutils literal notranslate"><span class="pre">VectorAR</span></code></a><ul>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.vector_ar.VectorAR.config_class"><code class="docutils literal notranslate"><span class="pre">VectorAR.config_class</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.vector_ar.VectorAR.require_even_sampling"><code class="docutils literal notranslate"><span class="pre">VectorAR.require_even_sampling</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.vector_ar.VectorAR.maxlags"><code class="docutils literal notranslate"><span class="pre">VectorAR.maxlags</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="#module-merlion.models.forecast.trees">forecast.trees</a><ul>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.trees.RandomForestForecasterConfig"><code class="docutils literal notranslate"><span class="pre">RandomForestForecasterConfig</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.trees.RandomForestForecaster"><code class="docutils literal notranslate"><span class="pre">RandomForestForecaster</span></code></a><ul>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.trees.RandomForestForecaster.config_class"><code class="docutils literal notranslate"><span class="pre">RandomForestForecaster.config_class</span></code></a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.trees.ExtraTreesForecasterConfig"><code class="docutils literal notranslate"><span class="pre">ExtraTreesForecasterConfig</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.trees.ExtraTreesForecaster"><code class="docutils literal notranslate"><span class="pre">ExtraTreesForecaster</span></code></a><ul>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.trees.ExtraTreesForecaster.config_class"><code class="docutils literal notranslate"><span class="pre">ExtraTreesForecaster.config_class</span></code></a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.trees.LGBMForecasterConfig"><code class="docutils literal notranslate"><span class="pre">LGBMForecasterConfig</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.trees.LGBMForecaster"><code class="docutils literal notranslate"><span class="pre">LGBMForecaster</span></code></a><ul>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.trees.LGBMForecaster.config_class"><code class="docutils literal notranslate"><span class="pre">LGBMForecaster.config_class</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="#module-merlion.models.forecast.deep_ar">forecast.deep_ar</a><ul>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.deep_ar.DeepARConfig"><code class="docutils literal notranslate"><span class="pre">DeepARConfig</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.deep_ar.DeepARModel"><code class="docutils literal notranslate"><span class="pre">DeepARModel</span></code></a><ul>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.deep_ar.DeepARModel.get_lagged_subsequences"><code class="docutils literal notranslate"><span class="pre">DeepARModel.get_lagged_subsequences()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.deep_ar.DeepARModel.unroll_encoder"><code class="docutils literal notranslate"><span class="pre">DeepARModel.unroll_encoder()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.deep_ar.DeepARModel.calculate_loss"><code class="docutils literal notranslate"><span class="pre">DeepARModel.calculate_loss()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.deep_ar.DeepARModel.sampling_decoder"><code class="docutils literal notranslate"><span class="pre">DeepARModel.sampling_decoder()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.deep_ar.DeepARModel.forward"><code class="docutils literal notranslate"><span class="pre">DeepARModel.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.deep_ar.DeepARForecaster"><code class="docutils literal notranslate"><span class="pre">DeepARForecaster</span></code></a><ul>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.deep_ar.DeepARForecaster.config_class"><code class="docutils literal notranslate"><span class="pre">DeepARForecaster.config_class</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.deep_ar.DeepARForecaster.deep_model_class"><code class="docutils literal notranslate"><span class="pre">DeepARForecaster.deep_model_class</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="#module-merlion.models.forecast.autoformer">forecast.autoformer</a><ul>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.autoformer.AutoformerConfig"><code class="docutils literal notranslate"><span class="pre">AutoformerConfig</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.autoformer.AutoformerModel"><code class="docutils literal notranslate"><span class="pre">AutoformerModel</span></code></a><ul>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.autoformer.AutoformerModel.forward"><code class="docutils literal notranslate"><span class="pre">AutoformerModel.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.autoformer.AutoformerForecaster"><code class="docutils literal notranslate"><span class="pre">AutoformerForecaster</span></code></a><ul>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.autoformer.AutoformerForecaster.config_class"><code class="docutils literal notranslate"><span class="pre">AutoformerForecaster.config_class</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.autoformer.AutoformerForecaster.deep_model_class"><code class="docutils literal notranslate"><span class="pre">AutoformerForecaster.deep_model_class</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="#module-merlion.models.forecast.etsformer">forecast.etsformer</a><ul>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.etsformer.ETSformerConfig"><code class="docutils literal notranslate"><span class="pre">ETSformerConfig</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.etsformer.ETSformerModel"><code class="docutils literal notranslate"><span class="pre">ETSformerModel</span></code></a><ul>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.etsformer.ETSformerModel.forward"><code class="docutils literal notranslate"><span class="pre">ETSformerModel.forward()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.etsformer.ETSformerModel.transform"><code class="docutils literal notranslate"><span class="pre">ETSformerModel.transform()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.etsformer.ETSformerModel.jitter"><code class="docutils literal notranslate"><span class="pre">ETSformerModel.jitter()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.etsformer.ETSformerModel.scale"><code class="docutils literal notranslate"><span class="pre">ETSformerModel.scale()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.etsformer.ETSformerModel.shift"><code class="docutils literal notranslate"><span class="pre">ETSformerModel.shift()</span></code></a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.etsformer.ETSformerForecaster"><code class="docutils literal notranslate"><span class="pre">ETSformerForecaster</span></code></a><ul>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.etsformer.ETSformerForecaster.config_class"><code class="docutils literal notranslate"><span class="pre">ETSformerForecaster.config_class</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.etsformer.ETSformerForecaster.deep_model_class"><code class="docutils literal notranslate"><span class="pre">ETSformerForecaster.deep_model_class</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="#module-merlion.models.forecast.informer">forecast.informer</a><ul>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.informer.InformerConfig"><code class="docutils literal notranslate"><span class="pre">InformerConfig</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.informer.InformerModel"><code class="docutils literal notranslate"><span class="pre">InformerModel</span></code></a><ul>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.informer.InformerModel.forward"><code class="docutils literal notranslate"><span class="pre">InformerModel.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.informer.InformerForecaster"><code class="docutils literal notranslate"><span class="pre">InformerForecaster</span></code></a><ul>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.informer.InformerForecaster.config_class"><code class="docutils literal notranslate"><span class="pre">InformerForecaster.config_class</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.informer.InformerForecaster.deep_model_class"><code class="docutils literal notranslate"><span class="pre">InformerForecaster.deep_model_class</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="#module-merlion.models.forecast.transformer">forecast.transformer</a><ul>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.transformer.TransformerConfig"><code class="docutils literal notranslate"><span class="pre">TransformerConfig</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.transformer.TransformerModel"><code class="docutils literal notranslate"><span class="pre">TransformerModel</span></code></a><ul>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.transformer.TransformerModel.forward"><code class="docutils literal notranslate"><span class="pre">TransformerModel.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="#merlion.models.forecast.transformer.TransformerForecaster"><code class="docutils literal notranslate"><span class="pre">TransformerForecaster</span></code></a><ul>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.transformer.TransformerForecaster.config_class"><code class="docutils literal notranslate"><span class="pre">TransformerForecaster.config_class</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="#merlion.models.forecast.transformer.TransformerForecaster.deep_model_class"><code class="docutils literal notranslate"><span class="pre">TransformerForecaster.deep_model_class</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="merlion.models.ensemble.html">ensemble</a></li>
<li class="toctree-l4"><a class="reference internal" href="merlion.models.automl.html">automl</a></li>
<li class="toctree-l4"><a class="reference internal" href="merlion.models.utils.html">utils</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="merlion.models.html#module-merlion.models.defaults">defaults</a></li>
<li class="toctree-l3"><a class="reference internal" href="merlion.models.html#module-merlion.models.factory">factory</a></li>
<li class="toctree-l3"><a class="reference internal" href="merlion.models.html#module-merlion.models.base">base</a></li>
<li class="toctree-l3"><a class="reference internal" href="merlion.models.html#module-merlion.models.deep_base">deep_base</a></li>
<li class="toctree-l3"><a class="reference internal" href="merlion.models.html#module-merlion.models.layers">layers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="merlion.dashboard.html">merlion.dashboard package</a></li>
<li class="toctree-l2"><a class="reference internal" href="merlion.spark.html">merlion.spark package</a></li>
<li class="toctree-l2"><a class="reference internal" href="merlion.transform.html">merlion.transform package</a></li>
<li class="toctree-l2"><a class="reference internal" href="merlion.post_process.html">merlion.post_process package</a></li>
<li class="toctree-l2"><a class="reference internal" href="merlion.evaluate.html">merlion.evaluate package</a></li>
<li class="toctree-l2"><a class="reference internal" href="merlion.plot.html">merlion.plot package</a></li>
<li class="toctree-l2"><a class="reference internal" href="merlion.utils.html">merlion.utils package</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ts_datasets.html">ts_datasets: Easy Data Loading</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials &amp; Example Code</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Merlion</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="merlion.html">merlion: Time Series Intelligence</a></li>
          <li class="breadcrumb-item"><a href="merlion.models.html">merlion.models package</a></li>
      <li class="breadcrumb-item active">forecast</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/merlion.models.forecast.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="module-merlion.models.forecast">
<span id="forecast"></span><h1>forecast<a class="headerlink" href="#module-merlion.models.forecast" title="Permalink to this heading">ÔÉÅ</a></h1>
<p>Contains all forecasting models, including those which support
<a class="reference internal" href="tutorials/forecast/3_ForecastExogenous.html"><span class="doc">exogenous regressors</span></a>.</p>
<p>For forecasting, we define an abstract base <a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase" title="merlion.models.forecast.base.ForecasterBase"><code class="xref any py py-class docutils literal notranslate"><span class="pre">ForecasterBase</span></code></a> class which inherits from <a class="reference internal" href="merlion.models.html#merlion.models.base.ModelBase" title="merlion.models.base.ModelBase"><code class="xref any py py-class docutils literal notranslate"><span class="pre">ModelBase</span></code></a> and supports the
following interface, in addition to <code class="docutils literal notranslate"><span class="pre">model.save()</span></code> and <code class="docutils literal notranslate"><span class="pre">ForecasterClass.load</span></code> defined for <code class="docutils literal notranslate"><span class="pre">ModelBase</span></code>:</p>
<ol class="arabic">
<li><p><code class="docutils literal notranslate"><span class="pre">model</span> <span class="pre">=</span> <span class="pre">ForecasterClass(config)</span></code></p>
<blockquote>
<div><ul class="simple">
<li><p>initialization with a model-specific config (which inherits from <a class="reference internal" href="#merlion.models.forecast.base.ForecasterConfig" title="merlion.models.forecast.base.ForecasterConfig"><code class="xref any py py-class docutils literal notranslate"><span class="pre">ForecasterConfig</span></code></a>)</p></li>
<li><p>configs contain:</p>
<ul>
<li><p>a (potentially trainable) data pre-processing transform from <a class="reference internal" href="merlion.transform.html#module-merlion.transform" title="merlion.transform"><code class="xref py py-mod docutils literal notranslate"><span class="pre">merlion.transform</span></code></a>;
note that <code class="docutils literal notranslate"><span class="pre">model.transform</span></code> is a property which refers to <code class="docutils literal notranslate"><span class="pre">model.config.transform</span></code></p></li>
<li><p>model-specific hyperparameters</p></li>
<li><p><strong>optionally, a maximum number of steps the model can forecast for</strong></p></li>
</ul>
</li>
</ul>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">model.forecast(time_stamps,</span> <span class="pre">time_series_prev=None)</span></code></p>
<blockquote>
<div><ul class="simple">
<li><p>returns the forecast (<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref any py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>) for future values at the time stamps specified by <code class="docutils literal notranslate"><span class="pre">time_stamps</span></code>,
as well as the standard error of that forecast (<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref any py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, may be <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p>if <code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code> is specified, it is used as the most recent context. Otherwise, the training data is used</p></li>
</ul>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">model.train(train_data,</span> <span class="pre">train_config=None)</span></code></p>
<ul class="simple">
<li><p>trains the model on the <a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref any py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a> <code class="docutils literal notranslate"><span class="pre">train_data</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">train_config</span></code> (optional): extra configuration describing how the model should be trained. 
Not used for all models. Class-level default provided for models which do use it.</p></li>
<li><p>returns the model‚Äôs prediction <code class="docutils literal notranslate"><span class="pre">train_data</span></code>, in the same format as if you called <a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase.forecast" title="merlion.models.forecast.base.ForecasterBase.forecast"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">ForecasterBase.forecast</span></code></a>
on the time stamps of <code class="docutils literal notranslate"><span class="pre">train_data</span></code></p></li>
</ul>
</li>
</ol>
<p>Base classes:</p>
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-merlion.models.forecast.base" title="merlion.models.forecast.base"><code class="xref py py-obj docutils literal notranslate"><span class="pre">base</span></code></a></p></td>
<td><p>Base class for forecasting models.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#module-merlion.models.forecast.deep_base" title="merlion.models.forecast.deep_base"><code class="xref py py-obj docutils literal notranslate"><span class="pre">deep_base</span></code></a></p></td>
<td><p>Base class for Deep Learning Forecasting Models</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-merlion.models.forecast.sklearn_base" title="merlion.models.forecast.sklearn_base"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sklearn_base</span></code></a></p></td>
<td><p>Base class for forecasters which use arbitrary <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> regression models internally.</p></td>
</tr>
</tbody>
</table>
<p>Univariate models:</p>
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-merlion.models.forecast.arima" title="merlion.models.forecast.arima"><code class="xref py py-obj docutils literal notranslate"><span class="pre">arima</span></code></a></p></td>
<td><p>The classic statistical forecasting model ARIMA (AutoRegressive Integrated Moving Average).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#module-merlion.models.forecast.sarima" title="merlion.models.forecast.sarima"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sarima</span></code></a></p></td>
<td><p>A variant of ARIMA with a user-specified Seasonality.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-merlion.models.forecast.ets" title="merlion.models.forecast.ets"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ets</span></code></a></p></td>
<td><p>ETS (Error, Trend, Seasonal) forecasting model.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#module-merlion.models.forecast.prophet" title="merlion.models.forecast.prophet"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prophet</span></code></a></p></td>
<td><p>Wrapper around Facebook's popular Prophet model for time series forecasting.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-merlion.models.forecast.smoother" title="merlion.models.forecast.smoother"><code class="xref py py-obj docutils literal notranslate"><span class="pre">smoother</span></code></a></p></td>
<td><p>Multi-Scale Exponential Smoother for univariate time series forecasting.</p></td>
</tr>
</tbody>
</table>
<p><a class="reference internal" href="tutorials/forecast/2_ForecastMultivariate.html"><span class="doc">Multivariate</span></a> models:</p>
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-merlion.models.forecast.vector_ar" title="merlion.models.forecast.vector_ar"><code class="xref py py-obj docutils literal notranslate"><span class="pre">vector_ar</span></code></a></p></td>
<td><p>Vector AutoRegressive model for multivariate time series forecasting.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#module-merlion.models.forecast.trees" title="merlion.models.forecast.trees"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trees</span></code></a></p></td>
<td><p>Tree-based models for multivariate time series forecasting.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-merlion.models.forecast.deep_ar" title="merlion.models.forecast.deep_ar"><code class="xref py py-obj docutils literal notranslate"><span class="pre">deep_ar</span></code></a></p></td>
<td><p>Implementation of Deep AR</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#module-merlion.models.forecast.autoformer" title="merlion.models.forecast.autoformer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">autoformer</span></code></a></p></td>
<td><p>Implementation of Autoformer.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-merlion.models.forecast.etsformer" title="merlion.models.forecast.etsformer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">etsformer</span></code></a></p></td>
<td><p>Implementation of ETSformer.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#module-merlion.models.forecast.informer" title="merlion.models.forecast.informer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">informer</span></code></a></p></td>
<td><p>Implementation of Informer.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-merlion.models.forecast.transformer" title="merlion.models.forecast.transformer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transformer</span></code></a></p></td>
<td><p>Implementation of Transformer for time series data.</p></td>
</tr>
</tbody>
</table>
<p><a class="reference internal" href="tutorials/forecast/3_ForecastExogenous.html"><span class="doc">Exogenous regressor</span></a> models:</p>
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-merlion.models.forecast.trees" title="merlion.models.forecast.trees"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trees</span></code></a></p></td>
<td><p>Tree-based models for multivariate time series forecasting.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#module-merlion.models.forecast.prophet" title="merlion.models.forecast.prophet"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prophet</span></code></a></p></td>
<td><p>Wrapper around Facebook's popular Prophet model for time series forecasting.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-merlion.models.forecast.sarima" title="merlion.models.forecast.sarima"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sarima</span></code></a></p></td>
<td><p>A variant of ARIMA with a user-specified Seasonality.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#module-merlion.models.forecast.vector_ar" title="merlion.models.forecast.vector_ar"><code class="xref py py-obj docutils literal notranslate"><span class="pre">vector_ar</span></code></a></p></td>
<td><p>Vector AutoRegressive model for multivariate time series forecasting.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-merlion.models.forecast.arima" title="merlion.models.forecast.arima"><code class="xref py py-obj docutils literal notranslate"><span class="pre">arima</span></code></a></p></td>
<td><p>The classic statistical forecasting model ARIMA (AutoRegressive Integrated Moving Average).</p></td>
</tr>
</tbody>
</table>
<p>Deep Learning models:</p>
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-merlion.models.forecast.deep_ar" title="merlion.models.forecast.deep_ar"><code class="xref py py-obj docutils literal notranslate"><span class="pre">deep_ar</span></code></a></p></td>
<td><p>Implementation of Deep AR</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#module-merlion.models.forecast.autoformer" title="merlion.models.forecast.autoformer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">autoformer</span></code></a></p></td>
<td><p>Implementation of Autoformer.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-merlion.models.forecast.etsformer" title="merlion.models.forecast.etsformer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">etsformer</span></code></a></p></td>
<td><p>Implementation of ETSformer.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#module-merlion.models.forecast.informer" title="merlion.models.forecast.informer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">informer</span></code></a></p></td>
<td><p>Implementation of Informer.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-merlion.models.forecast.transformer" title="merlion.models.forecast.transformer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transformer</span></code></a></p></td>
<td><p>Implementation of Transformer for time series data.</p></td>
</tr>
</tbody>
</table>
<p>Note that the AutoML variants
<a class="reference internal" href="merlion.models.automl.html#module-merlion.models.automl.autosarima" title="merlion.models.automl.autosarima"><code class="xref py py-mod docutils literal notranslate"><span class="pre">AutoSarima</span></code></a> and
<a class="reference internal" href="merlion.models.automl.html#module-merlion.models.automl.autoprophet" title="merlion.models.automl.autoprophet"><code class="xref py py-mod docutils literal notranslate"><span class="pre">AutoProphet</span></code></a>
also support exogenous regressors.</p>
<div class="section" id="base-classes">
<h2>Base classes<a class="headerlink" href="#base-classes" title="Permalink to this heading">ÔÉÅ</a></h2>
<div class="section" id="module-merlion.models.forecast.base">
<span id="forecast-base"></span><h3>forecast.base<a class="headerlink" href="#module-merlion.models.forecast.base" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>Base class for forecasting models.</p>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.base.</span></span><span class="sig-name descname"><span class="pre">ForecasterConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_forecast_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_seq_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invert_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterConfig" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="merlion.models.html#merlion.models.base.Config" title="merlion.models.base.Config"><code class="xref py py-class docutils literal notranslate"><span class="pre">Config</span></code></a></p>
<p>Config object used to define a forecaster model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_forecast_steps</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) ‚Äì Max # of steps we would like to forecast for.  Required for some models like <cite>MSES</cite>.</p></li>
<li><p><strong>target_seq_index</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) ‚Äì The index of the univariate (amongst all univariates in a general multivariate time
series) whose value we would like to forecast.</p></li>
<li><p><strong>invert_transform</strong> ‚Äì Whether to automatically invert the <code class="docutils literal notranslate"><span class="pre">transform</span></code> before returning a forecast.
By default, we will invert the transform for all base forecasters if it supports a proper inversion, but
we will not invert it for forecaster-based anomaly detectors or transforms without proper inversions.</p></li>
<li><p><strong>transform</strong> ‚Äì Transformation to pre-process input time series.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterConfig.max_forecast_steps">
<span class="sig-name descname"><span class="pre">max_forecast_steps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code><span class="pre">]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#merlion.models.forecast.base.ForecasterConfig.max_forecast_steps" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterConfig.target_seq_index">
<span class="sig-name descname"><span class="pre">target_seq_index</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code><span class="pre">]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#merlion.models.forecast.base.ForecasterConfig.target_seq_index" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterConfig.invert_transform">
<span class="sig-name descname"><span class="pre">invert_transform</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#merlion.models.forecast.base.ForecasterConfig.invert_transform" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.base.</span></span><span class="sig-name descname"><span class="pre">ForecasterBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterBase" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="merlion.models.html#merlion.models.base.ModelBase" title="merlion.models.base.ModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelBase</span></code></a></p>
<p>Base class for a forecaster model.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If your model depends on an evenly spaced time series, make sure to</p>
<ol class="arabic simple">
<li><p>Call <cite>ForecasterBase.train_pre_process</cite> in <cite>ForecasterBase.train</cite></p></li>
<li><p>Call <cite>ForecasterBase.resample_time_stamps</cite> at the start of
<cite>ForecasterBase.forecast</cite> to get a set of resampled time stamps, and
call <code class="docutils literal notranslate"><span class="pre">time_series.align(reference=time_stamps)</span></code> to align the forecast
with the original time stamps.</p></li>
</ol>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterBase.config_class">
<span class="sig-name descname"><span class="pre">config_class</span></span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterBase.config_class" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>alias of <a class="reference internal" href="#merlion.models.forecast.base.ForecasterConfig" title="merlion.models.forecast.base.ForecasterConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForecasterConfig</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterBase.target_name">
<span class="sig-name descname"><span class="pre">target_name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#merlion.models.forecast.base.ForecasterBase.target_name" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>The name of the target univariate to forecast.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterBase.max_forecast_steps">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">max_forecast_steps</span></span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterBase.max_forecast_steps" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterBase.target_seq_index">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">target_seq_index</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#merlion.models.forecast.base.ForecasterBase.target_seq_index" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the index of the univariate (amongst all univariates in a
general multivariate time series) whose value we would like to forecast.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterBase.invert_transform">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">invert_transform</span></span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterBase.invert_transform" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Whether to automatically invert the <code class="docutils literal notranslate"><span class="pre">transform</span></code> before returning a forecast.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterBase.require_univariate">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">require_univariate</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#merlion.models.forecast.base.ForecasterBase.require_univariate" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>All forecasters can work on multivariate data, since they only forecast a single target univariate.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterBase.support_multivariate_output">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">support_multivariate_output</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#merlion.models.forecast.base.ForecasterBase.support_multivariate_output" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Indicating whether the forecasting model can forecast multivariate output.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterBase.resample_time_stamps">
<span class="sig-name descname"><span class="pre">resample_time_stamps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_stamps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_series_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterBase.resample_time_stamps" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterBase.train_pre_process">
<span class="sig-name descname"><span class="pre">train_pre_process</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_exog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterBase.train_pre_process" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Applies pre-processing steps common for training most models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>train_data</strong> (<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>) ‚Äì the original time series of training data</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the training data, after any necessary pre-processing has been applied</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterBase.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterBase.train" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Trains the forecaster on the input time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_data</strong> (<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>) ‚Äì a <cite>TimeSeries</cite> of metric values to train the model.</p></li>
<li><p><strong>train_config</strong> ‚Äì Additional training configs, if needed. Only required for some models.</p></li>
<li><p><strong>exog_data</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]) ‚Äì A time series of exogenous variables, sampled at the same time stamps as <code class="docutils literal notranslate"><span class="pre">train_data</span></code>.
Exogenous variables are known a priori, and they are independent of the variable being forecasted.
Only supported for models which inherit from <cite>ForecasterExogBase</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the model‚Äôs prediction on <code class="docutils literal notranslate"><span class="pre">train_data</span></code>, in the same format as
if you called <cite>ForecasterBase.forecast</cite> on the time stamps of <code class="docutils literal notranslate"><span class="pre">train_data</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterBase.train_post_process">
<span class="sig-name descname"><span class="pre">train_post_process</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_result</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterBase.train_post_process" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Converts the train result (forecast &amp; stderr for training data) into TimeSeries objects, and inverts the
model‚Äôs transform if desired.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterBase.transform_exog_data">
<span class="sig-name descname"><span class="pre">transform_exog_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exog_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_stamps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_series_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterBase.transform_exog_data" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterBase.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_stamps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_series_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_iqr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterBase.forecast" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Returns the model‚Äôs forecast on the timestamps given. If <code class="docutils literal notranslate"><span class="pre">self.transform</span></code> is specified in the config, the
forecast is a forecast of transformed values by default. To invert the transform and forecast the actual
values of the time series, specify <code class="docutils literal notranslate"><span class="pre">invert_transform</span> <span class="pre">=</span> <span class="pre">True</span></code> when specifying the config.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_stamps</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) ‚Äì Either a <code class="docutils literal notranslate"><span class="pre">list</span></code> of timestamps we wish to forecast for, or the number of steps (<code class="docutils literal notranslate"><span class="pre">int</span></code>)
we wish to forecast for.</p></li>
<li><p><strong>time_series_prev</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]) ‚Äì a time series immediately preceding <code class="docutils literal notranslate"><span class="pre">time_series</span></code>. If given, we use it to initialize
the forecaster‚Äôs state. Otherwise, we assume that <code class="docutils literal notranslate"><span class="pre">time_series</span></code> immediately follows the training data.</p></li>
<li><p><strong>exog_data</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]) ‚Äì A time series of exogenous variables. Exogenous variables are known a priori, and they are
independent of the variable being forecasted. <code class="docutils literal notranslate"><span class="pre">exog_data</span></code> must include data for all of <code class="docutils literal notranslate"><span class="pre">time_stamps</span></code>;
if <code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code> is given, it must include data for all of <code class="docutils literal notranslate"><span class="pre">time_series_prev.time_stamps</span></code> as well.
Optional. Only supported for models which inherit from <cite>ForecasterExogBase</cite>.</p></li>
<li><p><strong>return_iqr</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) ‚Äì whether to return the inter-quartile range for the forecast.
Only supported for models which return error bars.</p></li>
<li><p><strong>return_prev</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) ‚Äì whether to return the forecast for <code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code> (and its stderr or IQR if relevant),
in addition to the forecast for <code class="docutils literal notranslate"><span class="pre">time_stamps</span></code>. Only used if <code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code> is provided.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]], <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p><code class="docutils literal notranslate"><span class="pre">(forecast,</span> <span class="pre">stderr)</span></code> if <code class="docutils literal notranslate"><span class="pre">return_iqr</span></code> is false, <code class="docutils literal notranslate"><span class="pre">(forecast,</span> <span class="pre">lb,</span> <span class="pre">ub)</span></code> otherwise.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">forecast</span></code>: the forecast for the timestamps given</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stderr</span></code>: the standard error of each forecast value. May be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lb</span></code>: 25th percentile of forecast values for each timestamp</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ub</span></code>: 75th percentile of forecast values for each timestamp</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterBase.batch_forecast">
<span class="sig-name descname"><span class="pre">batch_forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_stamps_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_series_prev_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_iqr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterBase.batch_forecast" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Returns the model‚Äôs forecast on a batch of timestamps given.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_stamps_list</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) ‚Äì a list of lists of timestamps we wish to forecast for</p></li>
<li><p><strong>time_series_prev_list</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]) ‚Äì a list of TimeSeries immediately preceding the time stamps in time_stamps_list</p></li>
<li><p><strong>return_iqr</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) ‚Äì whether to return the inter-quartile range for the forecast.
Only supported by models which can return error bars.</p></li>
<li><p><strong>return_prev</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) ‚Äì whether to return the forecast for <code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code> (and its stderr or IQR if relevant),
in addition to the forecast for <code class="docutils literal notranslate"><span class="pre">time_stamps</span></code>. Only used if <code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code> is provided.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]], <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]]]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p><code class="docutils literal notranslate"><span class="pre">(forecast,</span> <span class="pre">forecast_stderr)</span></code> if <code class="docutils literal notranslate"><span class="pre">return_iqr</span></code> is false,
<code class="docutils literal notranslate"><span class="pre">(forecast,</span> <span class="pre">forecast_lb,</span> <span class="pre">forecast_ub)</span></code> otherwise.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">forecast</span></code>: the forecast for the timestamps given</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">forecast_stderr</span></code>: the standard error of each forecast value. May be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">forecast_lb</span></code>: 25th percentile of forecast values for each timestamp</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">forecast_ub</span></code>: 75th percentile of forecast values for each timestamp</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterBase.get_figure">
<span class="sig-name descname"><span class="pre">get_figure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_series</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_stamps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_series_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_forecast_uncertainty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_time_series_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterBase.get_figure" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_series</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]) ‚Äì the time series over whose timestamps we wish to make a forecast. Exactly one of
<code class="docutils literal notranslate"><span class="pre">time_series</span></code> or <code class="docutils literal notranslate"><span class="pre">time_stamps</span></code> should be provided.</p></li>
<li><p><strong>time_stamps</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) ‚Äì Either a <code class="docutils literal notranslate"><span class="pre">list</span></code> of timestamps we wish to forecast for, or the number of steps (<code class="docutils literal notranslate"><span class="pre">int</span></code>)
we wish to forecast for. Exactly one of <code class="docutils literal notranslate"><span class="pre">time_series</span></code> or <code class="docutils literal notranslate"><span class="pre">time_stamps</span></code> should be provided.</p></li>
<li><p><strong>time_series_prev</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]) ‚Äì a time series immediately preceding <code class="docutils literal notranslate"><span class="pre">time_series</span></code>. If given, we use it to initialize
the forecaster‚Äôs state. Otherwise, we assume that <code class="docutils literal notranslate"><span class="pre">time_series</span></code> immediately follows the training data.</p></li>
<li><p><strong>exog_data</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]) ‚Äì A time series of exogenous variables. Exogenous variables are known a priori, and they are
independent of the variable being forecasted. <code class="docutils literal notranslate"><span class="pre">exog_data</span></code> must include data for all of <code class="docutils literal notranslate"><span class="pre">time_stamps</span></code>;
if <code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code> is given, it must include data for all of <code class="docutils literal notranslate"><span class="pre">time_series_prev.time_stamps</span></code> as well.
Optional. Only supported for models which inherit from <cite>ForecasterExogBase</cite>.</p></li>
<li><p><strong>plot_forecast_uncertainty</strong> ‚Äì whether to plot uncertainty estimates (the inter-quartile range) for forecast
values. Not supported for all  models.</p></li>
<li><p><strong>plot_time_series_prev</strong> ‚Äì whether to plot <code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code> (and  the model‚Äôs fit for it).
Only used if <code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code> is given.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="merlion.plot.html#merlion.plot.Figure" title="merlion.plot.Figure"><code class="xref py py-class docutils literal notranslate"><span class="pre">Figure</span></code></a></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a <cite>Figure</cite> of the model‚Äôs forecast.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterBase.plot_forecast">
<span class="sig-name descname"><span class="pre">plot_forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_series</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_stamps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_series_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_forecast_uncertainty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_time_series_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1000,</span> <span class="pre">600)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterBase.plot_forecast" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Plots the forecast for the time series in matplotlib, optionally also
plotting the uncertainty of the forecast, as well as the past values
(both true and predicted) of the time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_series</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]) ‚Äì the time series over whose timestamps we wish to make a forecast. Exactly one of
<code class="docutils literal notranslate"><span class="pre">time_series</span></code> or <code class="docutils literal notranslate"><span class="pre">time_stamps</span></code> should be provided.</p></li>
<li><p><strong>time_stamps</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) ‚Äì Either a <code class="docutils literal notranslate"><span class="pre">list</span></code> of timestamps we wish to forecast for, or the number of steps (<code class="docutils literal notranslate"><span class="pre">int</span></code>)
we wish to forecast for. Exactly one of <code class="docutils literal notranslate"><span class="pre">time_series</span></code> or <code class="docutils literal notranslate"><span class="pre">time_stamps</span></code> should be provided.</p></li>
<li><p><strong>time_series_prev</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]) ‚Äì a time series immediately preceding <code class="docutils literal notranslate"><span class="pre">time_series</span></code>. If given, we use it to initialize
the forecaster‚Äôs state. Otherwise, we assume that <code class="docutils literal notranslate"><span class="pre">time_series</span></code> immediately follows the training data.</p></li>
<li><p><strong>exog_data</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]) ‚Äì A time series of exogenous variables. Exogenous variables are known a priori, and they are
independent of the variable being forecasted. <code class="docutils literal notranslate"><span class="pre">exog_data</span></code> must include data for all of <code class="docutils literal notranslate"><span class="pre">time_stamps</span></code>;
if <code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code> is given, it must include data for all of <code class="docutils literal notranslate"><span class="pre">time_series_prev.time_stamps</span></code> as well.
Optional. Only supported for models which inherit from <cite>ForecasterExogBase</cite>.</p></li>
<li><p><strong>plot_forecast_uncertainty</strong> ‚Äì whether to plot uncertainty estimates (the inter-quartile range) for forecast
values. Not supported for all models.</p></li>
<li><p><strong>plot_time_series_prev</strong> ‚Äì whether to plot <code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code> (and the model‚Äôs fit for it). Only used if
<code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code> is given.</p></li>
<li><p><strong>figsize</strong> ‚Äì figure size in pixels</p></li>
<li><p><strong>ax</strong> ‚Äì matplotlib axis to add this plot to</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(fig, ax): matplotlib figure &amp; axes the figure was plotted on</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterBase.plot_forecast_plotly">
<span class="sig-name descname"><span class="pre">plot_forecast_plotly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_series</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_stamps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_series_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_forecast_uncertainty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_time_series_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1000,</span> <span class="pre">600)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterBase.plot_forecast_plotly" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Plots the forecast for the time series in plotly, optionally also
plotting the uncertainty of the forecast, as well as the past values
(both true and predicted) of the time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_series</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]) ‚Äì the time series over whose timestamps we wish to make a forecast. Exactly one of
<code class="docutils literal notranslate"><span class="pre">time_series</span></code> or <code class="docutils literal notranslate"><span class="pre">time_stamps</span></code> should be provided.</p></li>
<li><p><strong>time_stamps</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) ‚Äì Either a <code class="docutils literal notranslate"><span class="pre">list</span></code> of timestamps we wish to forecast for, or the number of steps (<code class="docutils literal notranslate"><span class="pre">int</span></code>)
we wish to forecast for. Exactly one of <code class="docutils literal notranslate"><span class="pre">time_series</span></code> or <code class="docutils literal notranslate"><span class="pre">time_stamps</span></code> should be provided.</p></li>
<li><p><strong>time_series_prev</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]) ‚Äì a time series immediately preceding <code class="docutils literal notranslate"><span class="pre">time_series</span></code>. If given, we use it to initialize
the forecaster‚Äôs state. Otherwise, we assume that <code class="docutils literal notranslate"><span class="pre">time_series</span></code> immediately follows the training data.</p></li>
<li><p><strong>exog_data</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]) ‚Äì A time series of exogenous variables. Exogenous variables are known a priori, and they are
independent of the variable being forecasted. <code class="docutils literal notranslate"><span class="pre">exog_data</span></code> must include data for all of <code class="docutils literal notranslate"><span class="pre">time_stamps</span></code>;
if <code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code> is given, it must include data for all of <code class="docutils literal notranslate"><span class="pre">time_series_prev.time_stamps</span></code> as well.
Optional. Only supported for models which inherit from <cite>ForecasterExogBase</cite>.</p></li>
<li><p><strong>plot_forecast_uncertainty</strong> ‚Äì whether to plot uncertainty estimates (the
inter-quartile range) for forecast values. Not supported for all
models.</p></li>
<li><p><strong>plot_time_series_prev</strong> ‚Äì whether to plot <code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code> (and
the model‚Äôs fit for it). Only used if <code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code> is given.</p></li>
<li><p><strong>figsize</strong> ‚Äì figure size in pixels</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterExogConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.base.</span></span><span class="sig-name descname"><span class="pre">ForecasterExogConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exog_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog_aggregation_policy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog_missing_value_policy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ZFill'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_forecast_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_seq_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invert_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterExogConfig" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.base.ForecasterConfig" title="merlion.models.forecast.base.ForecasterConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForecasterConfig</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exog_transform</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="merlion.transform.html#merlion.transform.base.TransformBase" title="merlion.transform.base.TransformBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">TransformBase</span></code></a>]) ‚Äì The pre-processing transform for exogenous data. Note: resampling is handled separately.</p></li>
<li><p><strong>exog_aggregation_policy</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.resample.AggregationPolicy" title="merlion.utils.resample.AggregationPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">AggregationPolicy</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) ‚Äì The policy to use for aggregating values in exogenous data,
to ensure it is sampled at the same timestamps as the endogenous data.</p></li>
<li><p><strong>exog_missing_value_policy</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.resample.MissingValuePolicy" title="merlion.utils.resample.MissingValuePolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">MissingValuePolicy</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) ‚Äì The policy to use for imputing missing values in exogenous data,
to ensure it is sampled at the same timestamps as the endogenous data.</p></li>
<li><p><strong>max_forecast_steps</strong> ‚Äì Max # of steps we would like to forecast for.  Required for some models like <cite>MSES</cite>.</p></li>
<li><p><strong>target_seq_index</strong> ‚Äì The index of the univariate (amongst all univariates in a general multivariate time
series) whose value we would like to forecast.</p></li>
<li><p><strong>invert_transform</strong> ‚Äì Whether to automatically invert the <code class="docutils literal notranslate"><span class="pre">transform</span></code> before returning a forecast.
By default, we will invert the transform for all base forecasters if it supports a proper inversion, but
we will not invert it for forecaster-based anomaly detectors or transforms without proper inversions.</p></li>
<li><p><strong>transform</strong> ‚Äì Transformation to pre-process input time series.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterExogConfig.exog_transform">
<span class="sig-name descname"><span class="pre">exog_transform</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="merlion.transform.html#merlion.transform.base.TransformBase" title="merlion.transform.base.TransformBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">TransformBase</span></code></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#merlion.models.forecast.base.ForecasterExogConfig.exog_transform" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterExogConfig.exog_aggregation_policy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">exog_aggregation_policy</span></span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterExogConfig.exog_aggregation_policy" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterExogConfig.exog_missing_value_policy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">exog_missing_value_policy</span></span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterExogConfig.exog_missing_value_policy" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterExogBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.base.</span></span><span class="sig-name descname"><span class="pre">ForecasterExogBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterExogBase" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase" title="merlion.models.forecast.base.ForecasterBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForecasterBase</span></code></a></p>
<p>Base class for a forecaster model which supports exogenous variables. Exogenous variables are known a priori, and
they are independent of the variable being forecasted.</p>
<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterExogBase.supports_exog">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">supports_exog</span></span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterExogBase.supports_exog" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Whether the model supports exogenous regressors.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterExogBase.exog_transform">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">exog_transform</span></span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterExogBase.exog_transform" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterExogBase.exog_aggregation_policy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">exog_aggregation_policy</span></span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterExogBase.exog_aggregation_policy" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterExogBase.exog_missing_value_policy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">exog_missing_value_policy</span></span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterExogBase.exog_missing_value_policy" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterExogBase.transform_exog_data">
<span class="sig-name descname"><span class="pre">transform_exog_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exog_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_stamps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_series_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterExogBase.transform_exog_data" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Transforms &amp; resamples exogenous data and splits it into two subsets:
one with the same timestamps as <code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code> (<code class="docutils literal notranslate"><span class="pre">None</span></code> if <code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>),
and one with the timestamps <code class="docutils literal notranslate"><span class="pre">time_stamps</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exog_data</strong> (<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>) ‚Äì The exogenous data of interest.</p></li>
<li><p><strong>time_stamps</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">DatetimeIndex</span></code>]) ‚Äì The timestamps of interest (either the timestamps of data, or the timestamps at which
we want to obtain a forecast)</p></li>
<li><p><strong>time_series_prev</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]) ‚Äì The timestamps of a time series preceding <code class="docutils literal notranslate"><span class="pre">time_stamps</span></code> as context. Optional.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">(exog_data,</span> <span class="pre">exog_data_prev)</span></code>, where <code class="docutils literal notranslate"><span class="pre">exog_data</span></code> has been resampled to match the <code class="docutils literal notranslate"><span class="pre">time_stamps</span></code>
and <code class="docutils literal notranslate"><span class="pre">exog_data_prev`</span> <span class="pre">has</span> <span class="pre">been</span> <span class="pre">resampled</span> <span class="pre">to</span> <span class="pre">match</span> <span class="pre">``time_series_prev.time_stamps</span></code>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-merlion.models.forecast.deep_base">
<span id="forecast-deep-base"></span><h3>forecast.deep_base<a class="headerlink" href="#module-merlion.models.forecast.deep_base" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>Base class for Deep Learning Forecasting Models</p>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.deep_base.DeepForecasterConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.deep_base.</span></span><span class="sig-name descname"><span class="pre">DeepForecasterConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_past</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Optimizer.Adam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">LossFunction.mse</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip_gradient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ts_encoding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'h'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_fraction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">early_stop_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_forecast_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_seq_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invert_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.deep_base.DeepForecasterConfig" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="merlion.models.html#merlion.models.deep_base.DeepConfig" title="merlion.models.deep_base.DeepConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeepConfig</span></code></a>, <a class="reference internal" href="#merlion.models.forecast.base.ForecasterConfig" title="merlion.models.forecast.base.ForecasterConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForecasterConfig</span></code></a></p>
<p>Config object used to define a forecaster with deep model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_past</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì # of past steps used for forecasting future.</p></li>
<li><p><strong>batch_size</strong> ‚Äì Batch size of a batch for stochastic training of deep models</p></li>
<li><p><strong>num_epochs</strong> ‚Äì Total number of epochs for training.</p></li>
<li><p><strong>optimizer</strong> ‚Äì The optimizer for learning the parameters of the deep learning models. The value of optimizer
can be <code class="docutils literal notranslate"><span class="pre">Adam</span></code>, <code class="docutils literal notranslate"><span class="pre">AdamW</span></code>, <code class="docutils literal notranslate"><span class="pre">SGD</span></code>, <code class="docutils literal notranslate"><span class="pre">Adagrad</span></code>, <code class="docutils literal notranslate"><span class="pre">RMSprop</span></code>.</p></li>
<li><p><strong>loss_fn</strong> ‚Äì Loss function for optimizing deep learning models. The value of loss_fn can be
<code class="docutils literal notranslate"><span class="pre">mse</span></code> for l2 loss, <code class="docutils literal notranslate"><span class="pre">l1</span></code> for l1 loss, <code class="docutils literal notranslate"><span class="pre">huber</span></code> for huber loss.</p></li>
<li><p><strong>clip_gradient</strong> ‚Äì Clipping gradient norm of model parameters before updating. If <code class="docutils literal notranslate"><span class="pre">clip_gradient</span> <span class="pre">is</span> <span class="pre">None</span></code>,
then the gradient will not be clipped.</p></li>
<li><p><strong>use_gpu</strong> ‚Äì Whether to use gpu for training deep models. If <code class="docutils literal notranslate"><span class="pre">use_gpu</span> <span class="pre">=</span> <span class="pre">True</span></code> while thre is no GPU device,
the model will use CPU for training instead.</p></li>
<li><p><strong>ts_encoding</strong> ‚Äì whether the timestamp should be encoded to a float vector, which can be used
for training deep learning based time series models; if <code class="docutils literal notranslate"><span class="pre">None</span></code>, the timestamp is not encoded.
If not <code class="docutils literal notranslate"><span class="pre">None</span></code>, it represents the frequency for time features encoding options:[s:secondly, t:minutely, h:hourly,
d:daily, b:business days, w:weekly, m:monthly]</p></li>
<li><p><strong>lr</strong> ‚Äì Learning rate for optimizing deep learning models.</p></li>
<li><p><strong>weight_decay</strong> ‚Äì Weight decay (L2 penalty) (default: 0)</p></li>
<li><p><strong>valid_fraction</strong> ‚Äì Fraction of validation set to be split from training data</p></li>
<li><p><strong>early_stop_patience</strong> ‚Äì Number of epochs with no improvement after which training will be stopped for
early stopping function. If <code class="docutils literal notranslate"><span class="pre">early_stop_patience</span> <span class="pre">=</span> <span class="pre">None</span></code>, the training process will not stop early.</p></li>
<li><p><strong>transform</strong> ‚Äì Transformation to pre-process input time series.</p></li>
<li><p><strong>max_forecast_steps</strong> ‚Äì Max # of steps we would like to forecast for.  Required for some models like <cite>MSES</cite>.</p></li>
<li><p><strong>target_seq_index</strong> ‚Äì The index of the univariate (amongst all univariates in a general multivariate time
series) whose value we would like to forecast.</p></li>
<li><p><strong>invert_transform</strong> ‚Äì Whether to automatically invert the <code class="docutils literal notranslate"><span class="pre">transform</span></code> before returning a forecast.
By default, we will invert the transform for all base forecasters if it supports a proper inversion, but
we will not invert it for forecaster-based anomaly detectors or transforms without proper inversions.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.deep_base.DeepForecaster">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.deep_base.</span></span><span class="sig-name descname"><span class="pre">DeepForecaster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.deep_base.DeepForecaster" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="merlion.models.html#merlion.models.deep_base.DeepModelBase" title="merlion.models.deep_base.DeepModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeepModelBase</span></code></a>, <a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase" title="merlion.models.forecast.base.ForecasterBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForecasterBase</span></code></a></p>
<p>Base class for a deep forecaster model</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.deep_base.DeepForecaster.config_class">
<span class="sig-name descname"><span class="pre">config_class</span></span><a class="headerlink" href="#merlion.models.forecast.deep_base.DeepForecaster.config_class" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>alias of <a class="reference internal" href="#merlion.models.forecast.deep_base.DeepForecasterConfig" title="merlion.models.forecast.deep_base.DeepForecasterConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeepForecasterConfig</span></code></a></p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.deep_base.DeepForecaster.support_multivariate_output">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">support_multivariate_output</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#merlion.models.forecast.deep_base.DeepForecaster.support_multivariate_output" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Deep models support multivariate output by default.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.deep_base.DeepForecaster.require_even_sampling">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">require_even_sampling</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#merlion.models.forecast.deep_base.DeepForecaster.require_even_sampling" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Whether the model assumes that training data is sampled at a fixed frequency</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-merlion.models.forecast.sklearn_base">
<span id="forecast-sklearn-base"></span><h3>forecast.sklearn_base<a class="headerlink" href="#module-merlion.models.forecast.sklearn_base" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>Base class for forecasters which use arbitrary <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> regression models internally.</p>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.sklearn_base.SKLearnForecasterConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.sklearn_base.</span></span><span class="sig-name descname"><span class="pre">SKLearnForecasterConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maxlags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_forecast_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_seq_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog_aggregation_policy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog_missing_value_policy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ZFill'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invert_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.sklearn_base.SKLearnForecasterConfig" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.base.ForecasterExogConfig" title="merlion.models.forecast.base.ForecasterExogConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForecasterExogConfig</span></code></a></p>
<p>Configuration class for a <cite>SKLearnForecaster</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>maxlags</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) ‚Äì Size of historical window to base the forecast on.</p></li>
<li><p><strong>max_forecast_steps</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) ‚Äì Max # of steps we would like to forecast for.</p></li>
<li><p><strong>target_seq_index</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) ‚Äì The index of the univariate (amongst all univariates in a general multivariate time
series) whose value we would like to forecast.</p></li>
<li><p><strong>prediction_stride</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì <p>the number of steps being forecasted in a single call to underlying the model</p>
<ul>
<li><p>If univariate: the sequence target of the length of prediction_stride will be utilized, forecasting will
be done autoregressively, with the stride unit of prediction_stride</p></li>
<li><p>If multivariate:</p>
<blockquote>
<div><ul class="simple">
<li><p>if = 1: autoregressively forecast all variables in the time series, one step at a time</p></li>
<li><p>if &gt; 1: only support directly forecasting the next prediction_stride steps in the future.
Autoregression not supported. Note that the model will set prediction_stride = max_forecast_steps.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</p></li>
<li><p><strong>exog_transform</strong> ‚Äì The pre-processing transform for exogenous data. Note: resampling is handled separately.</p></li>
<li><p><strong>exog_aggregation_policy</strong> ‚Äì The policy to use for aggregating values in exogenous data,
to ensure it is sampled at the same timestamps as the endogenous data.</p></li>
<li><p><strong>exog_missing_value_policy</strong> ‚Äì The policy to use for imputing missing values in exogenous data,
to ensure it is sampled at the same timestamps as the endogenous data.</p></li>
<li><p><strong>invert_transform</strong> ‚Äì Whether to automatically invert the <code class="docutils literal notranslate"><span class="pre">transform</span></code> before returning a forecast.
By default, we will invert the transform for all base forecasters if it supports a proper inversion, but
we will not invert it for forecaster-based anomaly detectors or transforms without proper inversions.</p></li>
<li><p><strong>transform</strong> ‚Äì Transformation to pre-process input time series.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.sklearn_base.SKLearnForecaster">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.sklearn_base.</span></span><span class="sig-name descname"><span class="pre">SKLearnForecaster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.sklearn_base.SKLearnForecaster" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.base.ForecasterExogBase" title="merlion.models.forecast.base.ForecasterExogBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForecasterExogBase</span></code></a></p>
<p>Wrapper around a sklearn-style model for time series forecasting. The underlying model must support
<code class="docutils literal notranslate"><span class="pre">fit()</span></code> and <code class="docutils literal notranslate"><span class="pre">predict()</span></code> methods. The model can be trained to be either an autoregressive model of order
<code class="docutils literal notranslate"><span class="pre">maxlags</span></code>, or to directly predict the next <code class="docutils literal notranslate"><span class="pre">prediction_stride</span></code> timestamps from a history of length <code class="docutils literal notranslate"><span class="pre">maxlags</span></code>.</p>
<p>If the data is univariate, the model will predict the next <code class="docutils literal notranslate"><span class="pre">prediction_stride</span></code> elements of the time series.
It can then use these predictions to autoregressively predict the next <code class="docutils literal notranslate"><span class="pre">prediction_stride</span></code> elements. If the data
is multivariate, the model will either autoregressively predict the next timestamp of all univariates
(if <code class="docutils literal notranslate"><span class="pre">prediction_stride</span> <span class="pre">=</span> <span class="pre">1</span></code>), or it will directly predict the next <code class="docutils literal notranslate"><span class="pre">prediction_stride</span></code> timestamps of the target
univariate (if <code class="docutils literal notranslate"><span class="pre">prediction_stride</span> <span class="pre">&gt;</span> <span class="pre">1</span></code>).</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.sklearn_base.SKLearnForecaster.config_class">
<span class="sig-name descname"><span class="pre">config_class</span></span><a class="headerlink" href="#merlion.models.forecast.sklearn_base.SKLearnForecaster.config_class" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>alias of <a class="reference internal" href="#merlion.models.forecast.sklearn_base.SKLearnForecasterConfig" title="merlion.models.forecast.sklearn_base.SKLearnForecasterConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">SKLearnForecasterConfig</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.sklearn_base.SKLearnForecaster.model">
<span class="sig-name descname"><span class="pre">model</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#merlion.models.forecast.sklearn_base.SKLearnForecaster.model" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.sklearn_base.SKLearnForecaster.maxlags">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">maxlags</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#merlion.models.forecast.sklearn_base.SKLearnForecaster.maxlags" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.sklearn_base.SKLearnForecaster.prediction_stride">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">prediction_stride</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#merlion.models.forecast.sklearn_base.SKLearnForecaster.prediction_stride" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.sklearn_base.SKLearnForecaster.require_even_sampling">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">require_even_sampling</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#merlion.models.forecast.sklearn_base.SKLearnForecaster.require_even_sampling" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Whether the model assumes that training data is sampled at a fixed frequency</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.sklearn_base.SKLearnForecaster.require_univariate">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">require_univariate</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#merlion.models.forecast.sklearn_base.SKLearnForecaster.require_univariate" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>All forecasters can work on multivariate data, since they only forecast a single target univariate.</p>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="univariate-models">
<h2>Univariate models<a class="headerlink" href="#univariate-models" title="Permalink to this heading">ÔÉÅ</a></h2>
<div class="section" id="module-merlion.models.forecast.arima">
<span id="forecast-arima"></span><h3>forecast.arima<a class="headerlink" href="#module-merlion.models.forecast.arima" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>The classic statistical forecasting model ARIMA (AutoRegressive Integrated
Moving Average).</p>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.arima.ArimaConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.arima.</span></span><span class="sig-name descname"><span class="pre">ArimaConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(4,</span> <span class="pre">1,</span> <span class="pre">2)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seasonal_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog_transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="merlion.transform.html#merlion.transform.base.TransformBase" title="merlion.transform.base.TransformBase"><span class="pre">TransformBase</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog_aggregation_policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="merlion.utils.html#merlion.utils.resample.AggregationPolicy" title="merlion.utils.resample.AggregationPolicy"><span class="pre">AggregationPolicy</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog_missing_value_policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="merlion.utils.html#merlion.utils.resample.MissingValuePolicy" title="merlion.utils.resample.MissingValuePolicy"><span class="pre">MissingValuePolicy</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'ZFill'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_forecast_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_seq_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invert_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="merlion.transform.html#merlion.transform.base.TransformBase" title="merlion.transform.base.TransformBase"><span class="pre">TransformBase</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_score</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_calibrator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.arima.ArimaConfig" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.sarima.SarimaConfig" title="merlion.models.forecast.sarima.SarimaConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">SarimaConfig</span></code></a></p>
<p>Configuration class for <cite>Arima</cite>. Just a <cite>Sarima</cite> model with seasonal order <code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">0)</span></code>.</p>
<p>Base class of the object used to configure an anomaly detection model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> ‚Äì Order is (p, d, q) for an ARIMA(p, d, q) process. d must
be an integer indicating the integration order of the process, while
p and q must be integers indicating the AR and MA orders (so that
all lags up to those orders are included).</p></li>
<li><p><strong>seasonal_order</strong> ‚Äì (0, 0, 0, 0) because ARIMA has no seasonal order.</p></li>
<li><p><strong>exog_transform</strong> ‚Äì The pre-processing transform for exogenous data. Note: resampling is handled separately.</p></li>
<li><p><strong>exog_aggregation_policy</strong> ‚Äì The policy to use for aggregating values in exogenous data,
to ensure it is sampled at the same timestamps as the endogenous data.</p></li>
<li><p><strong>exog_missing_value_policy</strong> ‚Äì The policy to use for imputing missing values in exogenous data,
to ensure it is sampled at the same timestamps as the endogenous data.</p></li>
<li><p><strong>max_forecast_steps</strong> ‚Äì Max # of steps we would like to forecast for.  Required for some models like <cite>MSES</cite>.</p></li>
<li><p><strong>target_seq_index</strong> ‚Äì The index of the univariate (amongst all univariates in a general multivariate time
series) whose value we would like to forecast.</p></li>
<li><p><strong>invert_transform</strong> ‚Äì Whether to automatically invert the <code class="docutils literal notranslate"><span class="pre">transform</span></code> before returning a forecast.
By default, we will invert the transform for all base forecasters if it supports a proper inversion, but
we will not invert it for forecaster-based anomaly detectors or transforms without proper inversions.</p></li>
<li><p><strong>transform</strong> ‚Äì Transformation to pre-process input time series.</p></li>
<li><p><strong>max_score</strong> ‚Äì maximum possible uncalibrated anomaly score</p></li>
<li><p><strong>threshold</strong> ‚Äì the rule to use for thresholding anomaly scores</p></li>
<li><p><strong>enable_calibrator</strong> ‚Äì whether to enable a calibrator which
automatically transforms all raw anomaly scores to be z-scores
(i.e. distributed as N(0, 1)).</p></li>
<li><p><strong>enable_threshold</strong> ‚Äì whether to enable the thresholding rule
when post-processing anomaly scores</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.arima.ArimaConfig.seasonal_order">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">seasonal_order</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#merlion.models.forecast.arima.ArimaConfig.seasonal_order" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>(0, 0, 0, 0) because ARIMA has no seasonal order.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.arima.Arima">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.arima.</span></span><span class="sig-name descname"><span class="pre">Arima</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.arima.Arima" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.sarima.Sarima" title="merlion.models.forecast.sarima.Sarima"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sarima</span></code></a></p>
<p>Implementation of the classic statistical model ARIMA (AutoRegressive Integrated Moving Average) for forecasting.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.arima.Arima.config_class">
<span class="sig-name descname"><span class="pre">config_class</span></span><a class="headerlink" href="#merlion.models.forecast.arima.Arima.config_class" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>alias of <a class="reference internal" href="#merlion.models.forecast.arima.ArimaConfig" title="merlion.models.forecast.arima.ArimaConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ArimaConfig</span></code></a></p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-merlion.models.forecast.sarima">
<span id="forecast-sarima"></span><h3>forecast.sarima<a class="headerlink" href="#module-merlion.models.forecast.sarima" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>A variant of ARIMA with a user-specified Seasonality.</p>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.sarima.SarimaConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.sarima.</span></span><span class="sig-name descname"><span class="pre">SarimaConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(4,</span> <span class="pre">1,</span> <span class="pre">2)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seasonal_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(2,</span> <span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">24)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog_aggregation_policy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog_missing_value_policy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ZFill'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_forecast_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_seq_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invert_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_score</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_calibrator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.sarima.SarimaConfig" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.base.ForecasterExogConfig" title="merlion.models.forecast.base.ForecasterExogConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForecasterExogConfig</span></code></a></p>
<p>Config class for <cite>Sarima</cite> (Seasonal AutoRegressive Integrated Moving Average).</p>
<p>Base class of the object used to configure an anomaly detection model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) ‚Äì Order is (p, d, q) for an ARIMA(p, d, q) process. d must
be an integer indicating the integration order of the process, while
p and q must be integers indicating the AR and MA orders (so that
all lags up to those orders are included).</p></li>
<li><p><strong>seasonal_order</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) ‚Äì Seasonal order is (P, D, Q, S) for seasonal ARIMA
process, where s is the length of the seasonality cycle (e.g. s=24
for 24 hours on hourly granularity). P, D, Q are as for ARIMA.</p></li>
<li><p><strong>exog_transform</strong> ‚Äì The pre-processing transform for exogenous data. Note: resampling is handled separately.</p></li>
<li><p><strong>exog_aggregation_policy</strong> ‚Äì The policy to use for aggregating values in exogenous data,
to ensure it is sampled at the same timestamps as the endogenous data.</p></li>
<li><p><strong>exog_missing_value_policy</strong> ‚Äì The policy to use for imputing missing values in exogenous data,
to ensure it is sampled at the same timestamps as the endogenous data.</p></li>
<li><p><strong>max_forecast_steps</strong> ‚Äì Max # of steps we would like to forecast for.  Required for some models like <cite>MSES</cite>.</p></li>
<li><p><strong>target_seq_index</strong> ‚Äì The index of the univariate (amongst all univariates in a general multivariate time
series) whose value we would like to forecast.</p></li>
<li><p><strong>invert_transform</strong> ‚Äì Whether to automatically invert the <code class="docutils literal notranslate"><span class="pre">transform</span></code> before returning a forecast.
By default, we will invert the transform for all base forecasters if it supports a proper inversion, but
we will not invert it for forecaster-based anomaly detectors or transforms without proper inversions.</p></li>
<li><p><strong>transform</strong> ‚Äì Transformation to pre-process input time series.</p></li>
<li><p><strong>max_score</strong> ‚Äì maximum possible uncalibrated anomaly score</p></li>
<li><p><strong>threshold</strong> ‚Äì the rule to use for thresholding anomaly scores</p></li>
<li><p><strong>enable_calibrator</strong> ‚Äì whether to enable a calibrator which
automatically transforms all raw anomaly scores to be z-scores
(i.e. distributed as N(0, 1)).</p></li>
<li><p><strong>enable_threshold</strong> ‚Äì whether to enable the thresholding rule
when post-processing anomaly scores</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.sarima.Sarima">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.sarima.</span></span><span class="sig-name descname"><span class="pre">Sarima</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.sarima.Sarima" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.base.ForecasterExogBase" title="merlion.models.forecast.base.ForecasterExogBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForecasterExogBase</span></code></a>, <a class="reference internal" href="merlion.models.automl.html#merlion.models.automl.seasonality.SeasonalityModel" title="merlion.models.automl.seasonality.SeasonalityModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeasonalityModel</span></code></a></p>
<p>Implementation of the classic statistical model SARIMA (Seasonal
AutoRegressive Integrated Moving Average) for forecasting.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.sarima.Sarima.config_class">
<span class="sig-name descname"><span class="pre">config_class</span></span><a class="headerlink" href="#merlion.models.forecast.sarima.Sarima.config_class" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>alias of <a class="reference internal" href="#merlion.models.forecast.sarima.SarimaConfig" title="merlion.models.forecast.sarima.SarimaConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">SarimaConfig</span></code></a></p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.sarima.Sarima.require_even_sampling">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">require_even_sampling</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#merlion.models.forecast.sarima.Sarima.require_even_sampling" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Whether the model assumes that training data is sampled at a fixed frequency</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.sarima.Sarima.order">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">order</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#merlion.models.forecast.sarima.Sarima.order" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the order (p, d, q) of the model, where p is the AR order,
d is the integration order, and q is the MA order.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.sarima.Sarima.seasonal_order">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">seasonal_order</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#merlion.models.forecast.sarima.Sarima.seasonal_order" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the seasonal order (P, D, Q, S) for the seasonal ARIMA
process, where p is the AR order, D is the integration order,
Q is the MA order, and S is the length of the seasonality cycle.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.sarima.Sarima.set_seasonality">
<span class="sig-name descname"><span class="pre">set_seasonality</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.sarima.Sarima.set_seasonality" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Implement this method to do any model-specific adjustments on the seasonality that was provided by
<cite>SeasonalityLayer</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> ‚Äì Seasonality processed by <cite>SeasonalityLayer</cite>.</p></li>
<li><p><strong>train_data</strong> (<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.UnivariateTimeSeries" title="merlion.utils.time_series.UnivariateTimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">UnivariateTimeSeries</span></code></a>) ‚Äì Training data (or numpy array representing the target univariate)
for any model-specific adjustments you might want to make.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-merlion.models.forecast.ets">
<span id="forecast-ets"></span><h3>forecast.ets<a class="headerlink" href="#module-merlion.models.forecast.ets" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>ETS (Error, Trend, Seasonal) forecasting model.</p>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.ets.ETSConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.ets.</span></span><span class="sig-name descname"><span class="pre">ETSConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_forecast_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_seq_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'add'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'add'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">damped_trend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seasonal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'add'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seasonal_periods</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invert_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_calibrator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_score</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.ets.ETSConfig" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.base.ForecasterConfig" title="merlion.models.forecast.base.ForecasterConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForecasterConfig</span></code></a></p>
<p>Configuration class for <a class="reference internal" href="#merlion.models.forecast.ets.ETS" title="merlion.models.forecast.ets.ETS"><code class="xref py py-class docutils literal notranslate"><span class="pre">ETS</span></code></a> model. ETS model is an underlying state space
model consisting of an error term (E), a trend component (T), a seasonal
component (S), and a level component. Each component is flexible with
different traits with additive (‚Äòadd‚Äô) or multiplicative (‚Äòmul‚Äô) formulation.
Refer to <a class="reference external" href="https://otexts.com/fpp2/taxonomy.html">https://otexts.com/fpp2/taxonomy.html</a> for more information
about ETS model.</p>
<p>Base class of the object used to configure an anomaly detection model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_forecast_steps</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) ‚Äì Number of steps we would like to forecast for.</p></li>
<li><p><strong>target_seq_index</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) ‚Äì The index of the univariate (amongst all
univariates in a general multivariate time series) whose value we
would like to forecast.</p></li>
<li><p><strong>error</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) ‚Äì The error term. ‚Äúadd‚Äù or ‚Äúmul‚Äù.</p></li>
<li><p><strong>trend</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) ‚Äì The trend component. ‚Äúadd‚Äù, ‚Äúmul‚Äù or None.</p></li>
<li><p><strong>damped_trend</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) ‚Äì Whether or not an included trend component is damped.</p></li>
<li><p><strong>seasonal</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) ‚Äì The seasonal component. ‚Äúadd‚Äù, ‚Äúmul‚Äù or None.</p></li>
<li><p><strong>seasonal_periods</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) ‚Äì The length of the seasonality cycle. <code class="docutils literal notranslate"><span class="pre">None</span></code> by default.</p></li>
<li><p><strong>refit</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) ‚Äì if <code class="docutils literal notranslate"><span class="pre">True</span></code>, refit the full ETS model when <code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code> is given to the forecast method
(slower). If <code class="docutils literal notranslate"><span class="pre">False</span></code>, simply perform exponential smoothing (faster).</p></li>
<li><p><strong>invert_transform</strong> ‚Äì Whether to automatically invert the <code class="docutils literal notranslate"><span class="pre">transform</span></code> before returning a forecast.
By default, we will invert the transform for all base forecasters if it supports a proper inversion, but
we will not invert it for forecaster-based anomaly detectors or transforms without proper inversions.</p></li>
<li><p><strong>transform</strong> ‚Äì Transformation to pre-process input time series.</p></li>
<li><p><strong>enable_calibrator</strong> ‚Äì <code class="docutils literal notranslate"><span class="pre">False</span></code> because this config assumes calibrated outputs from the model.</p></li>
<li><p><strong>max_score</strong> ‚Äì maximum possible uncalibrated anomaly score</p></li>
<li><p><strong>threshold</strong> ‚Äì the rule to use for thresholding anomaly scores</p></li>
<li><p><strong>enable_threshold</strong> ‚Äì whether to enable the thresholding rule
when post-processing anomaly scores</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.ets.ETS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.ets.</span></span><span class="sig-name descname"><span class="pre">ETS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.ets.ETS" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="merlion.models.automl.html#merlion.models.automl.seasonality.SeasonalityModel" title="merlion.models.automl.seasonality.SeasonalityModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeasonalityModel</span></code></a>, <a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase" title="merlion.models.forecast.base.ForecasterBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForecasterBase</span></code></a></p>
<p>Implementation of the classic local statistical model ETS (Error, Trend, Seasonal) for forecasting.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.ets.ETS.config_class">
<span class="sig-name descname"><span class="pre">config_class</span></span><a class="headerlink" href="#merlion.models.forecast.ets.ETS.config_class" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>alias of <a class="reference internal" href="#merlion.models.forecast.ets.ETSConfig" title="merlion.models.forecast.ets.ETSConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ETSConfig</span></code></a></p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.ets.ETS.require_even_sampling">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">require_even_sampling</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#merlion.models.forecast.ets.ETS.require_even_sampling" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Whether the model assumes that training data is sampled at a fixed frequency</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.ets.ETS.error">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">error</span></span><a class="headerlink" href="#merlion.models.forecast.ets.ETS.error" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.ets.ETS.trend">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">trend</span></span><a class="headerlink" href="#merlion.models.forecast.ets.ETS.trend" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.ets.ETS.damped_trend">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">damped_trend</span></span><a class="headerlink" href="#merlion.models.forecast.ets.ETS.damped_trend" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.ets.ETS.seasonal">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">seasonal</span></span><a class="headerlink" href="#merlion.models.forecast.ets.ETS.seasonal" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.ets.ETS.seasonal_periods">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">seasonal_periods</span></span><a class="headerlink" href="#merlion.models.forecast.ets.ETS.seasonal_periods" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.ets.ETS.set_seasonality">
<span class="sig-name descname"><span class="pre">set_seasonality</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.ets.ETS.set_seasonality" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Implement this method to do any model-specific adjustments on the seasonality that was provided by
<cite>SeasonalityLayer</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> ‚Äì Seasonality processed by <cite>SeasonalityLayer</cite>.</p></li>
<li><p><strong>train_data</strong> (<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.UnivariateTimeSeries" title="merlion.utils.time_series.UnivariateTimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">UnivariateTimeSeries</span></code></a>) ‚Äì Training data (or numpy array representing the target univariate)
for any model-specific adjustments you might want to make.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-merlion.models.forecast.prophet">
<span id="forecast-prophet"></span><h3>forecast.prophet<a class="headerlink" href="#module-merlion.models.forecast.prophet" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>Wrapper around Facebook‚Äôs popular Prophet model for time series forecasting.</p>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.prophet.ProphetConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.prophet.</span></span><span class="sig-name descname"><span class="pre">ProphetConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_forecast_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_seq_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yearly_seasonality</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weekly_seasonality</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">daily_seasonality</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seasonality_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'additive'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">holidays</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uncertainty_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog_aggregation_policy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog_missing_value_policy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ZFill'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invert_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_score</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_calibrator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.prophet.ProphetConfig" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.base.ForecasterExogConfig" title="merlion.models.forecast.base.ForecasterExogConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForecasterExogConfig</span></code></a></p>
<p>Configuration class for Facebook‚Äôs <cite>Prophet</cite> model, as described by
<a class="reference external" href="https://peerj.com/preprints/3190/">Taylor &amp; Letham, 2017</a>.</p>
<p>Base class of the object used to configure an anomaly detection model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_forecast_steps</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) ‚Äì Max # of steps we would like to forecast for.</p></li>
<li><p><strong>target_seq_index</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) ‚Äì The index of the univariate (amongst all
univariates in a general multivariate time series) whose value we
would like to forecast.</p></li>
<li><p><strong>yearly_seasonality</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) ‚Äì If bool, whether to enable yearly seasonality.
By default, it is activated if there are &gt;= 2 years of history, but
deactivated otherwise. If int, this is the number of Fourier series
components used to model the seasonality (default = 10).</p></li>
<li><p><strong>weekly_seasonality</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) ‚Äì If bool, whether to enable weekly seasonality.
By default, it is activated if there are &gt;= 2 weeks of history, but
deactivated otherwise. If int, this is the number of Fourier series
components used to model the seasonality (default = 3).</p></li>
<li><p><strong>daily_seasonality</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) ‚Äì If bool, whether to enable daily seasonality.
By default, it is activated if there are &gt;= 2 days of history, but
deactivated otherwise. If int, this is the number of Fourier series
components used to model the seasonality (default = 4).</p></li>
<li><p><strong>seasonality_mode</strong> ‚Äì ‚Äòadditive‚Äô (default) or ‚Äòmultiplicative‚Äô.</p></li>
<li><p><strong>holidays</strong> ‚Äì pd.DataFrame with columns holiday (string) and ds (date type)
and optionally columns lower_window and upper_window which specify a
range of days around the date to be included as holidays.
lower_window=-2 will include 2 days prior to the date as holidays. Also
optionally can have a column prior_scale specifying the prior scale for
that holiday. Can also be a dict corresponding to the desired pd.DataFrame.</p></li>
<li><p><strong>uncertainty_samples</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì The number of posterior samples to draw in
order to calibrate the anomaly scores.</p></li>
<li><p><strong>exog_transform</strong> ‚Äì The pre-processing transform for exogenous data. Note: resampling is handled separately.</p></li>
<li><p><strong>exog_aggregation_policy</strong> ‚Äì The policy to use for aggregating values in exogenous data,
to ensure it is sampled at the same timestamps as the endogenous data.</p></li>
<li><p><strong>exog_missing_value_policy</strong> ‚Äì The policy to use for imputing missing values in exogenous data,
to ensure it is sampled at the same timestamps as the endogenous data.</p></li>
<li><p><strong>invert_transform</strong> ‚Äì Whether to automatically invert the <code class="docutils literal notranslate"><span class="pre">transform</span></code> before returning a forecast.
By default, we will invert the transform for all base forecasters if it supports a proper inversion, but
we will not invert it for forecaster-based anomaly detectors or transforms without proper inversions.</p></li>
<li><p><strong>transform</strong> ‚Äì Transformation to pre-process input time series.</p></li>
<li><p><strong>max_score</strong> ‚Äì maximum possible uncalibrated anomaly score</p></li>
<li><p><strong>threshold</strong> ‚Äì the rule to use for thresholding anomaly scores</p></li>
<li><p><strong>enable_calibrator</strong> ‚Äì whether to enable a calibrator which
automatically transforms all raw anomaly scores to be z-scores
(i.e. distributed as N(0, 1)).</p></li>
<li><p><strong>enable_threshold</strong> ‚Äì whether to enable the thresholding rule
when post-processing anomaly scores</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.prophet.Prophet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.prophet.</span></span><span class="sig-name descname"><span class="pre">Prophet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.prophet.Prophet" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.base.ForecasterExogBase" title="merlion.models.forecast.base.ForecasterExogBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForecasterExogBase</span></code></a>, <a class="reference internal" href="merlion.models.automl.html#merlion.models.automl.seasonality.SeasonalityModel" title="merlion.models.automl.seasonality.SeasonalityModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeasonalityModel</span></code></a></p>
<p>Facebook‚Äôs model for time series forecasting. See docs for <cite>ProphetConfig</cite>
and <a class="reference external" href="https://peerj.com/preprints/3190/">Taylor &amp; Letham, 2017</a> for more details.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.prophet.Prophet.config_class">
<span class="sig-name descname"><span class="pre">config_class</span></span><a class="headerlink" href="#merlion.models.forecast.prophet.Prophet.config_class" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>alias of <a class="reference internal" href="#merlion.models.forecast.prophet.ProphetConfig" title="merlion.models.forecast.prophet.ProphetConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProphetConfig</span></code></a></p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.prophet.Prophet.require_even_sampling">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">require_even_sampling</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#merlion.models.forecast.prophet.Prophet.require_even_sampling" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Whether the model assumes that training data is sampled at a fixed frequency</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.prophet.Prophet.yearly_seasonality">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">yearly_seasonality</span></span><a class="headerlink" href="#merlion.models.forecast.prophet.Prophet.yearly_seasonality" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.prophet.Prophet.weekly_seasonality">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">weekly_seasonality</span></span><a class="headerlink" href="#merlion.models.forecast.prophet.Prophet.weekly_seasonality" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.prophet.Prophet.daily_seasonality">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">daily_seasonality</span></span><a class="headerlink" href="#merlion.models.forecast.prophet.Prophet.daily_seasonality" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.prophet.Prophet.add_seasonality">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">add_seasonality</span></span><a class="headerlink" href="#merlion.models.forecast.prophet.Prophet.add_seasonality" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.prophet.Prophet.seasonality_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">seasonality_mode</span></span><a class="headerlink" href="#merlion.models.forecast.prophet.Prophet.seasonality_mode" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.prophet.Prophet.holidays">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">holidays</span></span><a class="headerlink" href="#merlion.models.forecast.prophet.Prophet.holidays" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.prophet.Prophet.uncertainty_samples">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">uncertainty_samples</span></span><a class="headerlink" href="#merlion.models.forecast.prophet.Prophet.uncertainty_samples" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.prophet.Prophet.set_seasonality">
<span class="sig-name descname"><span class="pre">set_seasonality</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.prophet.Prophet.set_seasonality" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Implement this method to do any model-specific adjustments on the seasonality that was provided by
<cite>SeasonalityLayer</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> ‚Äì Seasonality processed by <cite>SeasonalityLayer</cite>.</p></li>
<li><p><strong>train_data</strong> (<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.UnivariateTimeSeries" title="merlion.utils.time_series.UnivariateTimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">UnivariateTimeSeries</span></code></a>) ‚Äì Training data (or numpy array representing the target univariate)
for any model-specific adjustments you might want to make.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-merlion.models.forecast.smoother">
<span id="forecast-smoother"></span><h3>forecast.smoother<a class="headerlink" href="#module-merlion.models.forecast.smoother" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>Multi-Scale Exponential Smoother for univariate time series forecasting.</p>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.MSESConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.smoother.</span></span><span class="sig-name descname"><span class="pre">MSESConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_forecast_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_backstep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recency_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accel_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimize_acc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inflation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_seq_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invert_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.MSESConfig" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.base.ForecasterConfig" title="merlion.models.forecast.base.ForecasterConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForecasterConfig</span></code></a></p>
<p>Configuration class for an MSES forecasting model.</p>
<p>Letting <code class="docutils literal notranslate"><span class="pre">w</span></code> be the recency weight, <code class="docutils literal notranslate"><span class="pre">B</span></code> the maximum backstep, <code class="docutils literal notranslate"><span class="pre">x_t</span></code> the last seen data point,
and <code class="docutils literal notranslate"><span class="pre">l_s,t</span></code> the series of losses for scale <code class="docutils literal notranslate"><span class="pre">s</span></code>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
\hat{x}_{t+h} &amp; = \sum_{b=0}^B p_{b} \cdot (x_{t-b} + v_{b+h,t} + a_{b+h,t}) \\
\space \\
\text{where} \space\space &amp; v_{b+h,t} = \text{EMA}_w(\Delta_{b+h} x_t)   \\
&amp; a_{b+h,t} = \text{EMA}_w(\Delta_{b+h}^2 x_t) \\
\text{and} \space\space &amp; p_b = \sigma(z)_b \space\space \\
\text{if} &amp; \space\space  z_b = (b+h)^\phi \cdot \text{EMA}_w(l_{b+h,t}) \cdot \text{RWSE}_w(l_{b+h,t})\\
\end{align*}\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_forecast_steps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì Max # of steps we would like to forecast for.  Required for some models like <cite>MSES</cite>.</p></li>
<li><p><strong>max_backstep</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) ‚Äì Max backstep to use in forecasting. If we train with x(0),‚Ä¶,x(t),
Then, the b-th model MSES uses will forecast x(t+h) by anchoring at x(t-b) and 
predicting xhat(t+h) = x(t-b) + delta_hat(b+h).</p></li>
<li><p><strong>recency_weight</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) ‚Äì The recency weight parameter to use when estimating delta_hat.</p></li>
<li><p><strong>accel_weight</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) ‚Äì The weight to scale the acceleration by when computing delta_hat.
Specifically, delta_hat(b+h) = velocity(b+h) + accel_weight * acceleration(b+h).</p></li>
<li><p><strong>optimize_acc</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) ‚Äì If True, the acceleration correction will only be used at scales
ranging from 1,‚Ä¶(max_backstep+max_forecast_steps)/2.</p></li>
<li><p><strong>eta</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) ‚Äì The parameter used to control the rate at which recency_weight gets
tuned when online updates are made to the model and losses can be computed.</p></li>
<li><p><strong>rho</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) ‚Äì The parameter that determines what fraction of the overall error is due to
velcity error, while the rest is due to the complement. The error at any scale 
will be determined as <code class="docutils literal notranslate"><span class="pre">rho</span> <span class="pre">*</span> <span class="pre">velocity_error</span> <span class="pre">+</span> <span class="pre">(1-rho)</span> <span class="pre">*</span> <span class="pre">loss_error</span></code>.</p></li>
<li><p><strong>phi</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) ‚Äì The parameter used to exponentially inflate the magnitude of loss error at
different scales. Loss error for scale <code class="docutils literal notranslate"><span class="pre">s</span></code> will be increased by a factor of <code class="docutils literal notranslate"><span class="pre">phi</span> <span class="pre">**</span> <span class="pre">s</span></code>.</p></li>
<li><p><strong>inflation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) ‚Äì The inflation exponent to use when computing the distribution
p(b|h) over the models when forecasting at horizon h according to standard
errors of the estimated velocities over the models; inflation=1 is equivalent
to using the softmax function.</p></li>
<li><p><strong>target_seq_index</strong> ‚Äì The index of the univariate (amongst all univariates in a general multivariate time
series) whose value we would like to forecast.</p></li>
<li><p><strong>invert_transform</strong> ‚Äì Whether to automatically invert the <code class="docutils literal notranslate"><span class="pre">transform</span></code> before returning a forecast.
By default, we will invert the transform for all base forecasters if it supports a proper inversion, but
we will not invert it for forecaster-based anomaly detectors or transforms without proper inversions.</p></li>
<li><p><strong>transform</strong> ‚Äì Transformation to pre-process input time series.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.MSESConfig.max_scale">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">max_scale</span></span><a class="headerlink" href="#merlion.models.forecast.smoother.MSESConfig.max_scale" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.MSESConfig.backsteps">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">backsteps</span></span><a class="headerlink" href="#merlion.models.forecast.smoother.MSESConfig.backsteps" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.MSESTrainConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.smoother.</span></span><span class="sig-name descname"><span class="pre">MSESTrainConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">incremental</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_losses</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tune_recency_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_batch_sz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_cadence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.MSESTrainConfig" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>MSES training configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>incremental</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) ‚Äì If True, train the MSES model incrementally with the initial
training data at the given <code class="docutils literal notranslate"><span class="pre">train_cadence</span></code>. This allows MSES to return a
forecast for the training data.</p></li>
<li><p><strong>init_batch_sz</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì The size of the inital training batch for MSES. This is
necessary because MSES cannot predict the past, but needs to start with some
data. This should be very small. 2 is the minimum, and is recommended because
2 will result in the most representative train forecast.</p></li>
<li><p><strong>train_cadence</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) ‚Äì The frequency at which the training forecasts will be generated
during incremental training.</p></li>
</ul>
</dd>
<dt class="field-even">Param</dt>
<dd class="field-even"><p>If True, track the losses encountered during incremental initial training.</p>
</dd>
<dt class="field-odd">Tune_recency_weights</dt>
<dd class="field-odd"><p>If True, tune recency weights during incremental initial
training.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.MSES">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.smoother.</span></span><span class="sig-name descname"><span class="pre">MSES</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.MSES" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase" title="merlion.models.forecast.base.ForecasterBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForecasterBase</span></code></a></p>
<p>Multi-scale Exponential Smoother (MSES) is a forecasting algorithm modeled heavily 
after classical mechanical concepts, namely, velocity and acceleration.</p>
<p>Having seen data points of a time series up to time t, MSES forecasts x(t+h) by
anchoring at a value b steps back from the last known value, x(t-b), and estimating the
delta between x(t-b) and x(t+h). The delta over these b+h timesteps, delta(b+h), also known 
as the delta at scale b+h, is predicted by estimating the velocity over these timesteps 
as well as the change in the velocity, acceleration. Specifically,</p>
<blockquote>
<div><p>xhat(t+h) = x(t-b) + velocity_hat(b+h) + acceleration_hat(b+h)</p>
</div></blockquote>
<p>This estimation is done for each b, known as a backstep, from 0, which anchors at x(t), 
1,‚Ä¶ up to a maximum backstep configurable by the user. The algorithm then takes the 
seperate forecasts of x(t+h), indexed by which backstep was used, xhat_b(t+h), and determines
a final forecast: p(b|h) dot xhat_b, where p(b|h) is a distribution over the xhat_b‚Äôs that is 
determined according to the lowest standard errors of the recency-weighted velocity estimates.</p>
<p>Letting <code class="docutils literal notranslate"><span class="pre">w</span></code> be the recency weight, <code class="docutils literal notranslate"><span class="pre">B</span></code> the maximum backstep, <code class="docutils literal notranslate"><span class="pre">x_t</span></code> the last seen data point,
and <code class="docutils literal notranslate"><span class="pre">l_s,t</span></code> the series of losses for scale <code class="docutils literal notranslate"><span class="pre">s</span></code>.</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
\hat{x}_{t+h} &amp; = \sum_{b=0}^B p_{b} \cdot (x_{t-b} + v_{b+h,t} + a_{b+h,t}) \\
\space \\
\text{where} \space\space &amp; v_{b+h,t} = \text{EMA}_w(\Delta_{b+h} x_t)   \\
&amp; a_{b+h,t} = \text{EMA}_w(\Delta_{b+h}^2 x_t) \\
\text{and} \space\space &amp; p_b = \sigma(z)_b \space\space \\
\text{if} &amp; \space\space  z_b = (b+h)^\phi \cdot \text{EMA}_w(l_{b+h,t}) \cdot \text{RWSE}_w(l_{b+h,t})\\
\end{align*}\end{split}\]</div>
</div></blockquote>
<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.MSES.config_class">
<span class="sig-name descname"><span class="pre">config_class</span></span><a class="headerlink" href="#merlion.models.forecast.smoother.MSES.config_class" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>alias of <a class="reference internal" href="#merlion.models.forecast.smoother.MSESConfig" title="merlion.models.forecast.smoother.MSESConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">MSESConfig</span></code></a></p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.MSES.require_even_sampling">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">require_even_sampling</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#merlion.models.forecast.smoother.MSES.require_even_sampling" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Whether the model assumes that training data is sampled at a fixed frequency</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.MSES.rho">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rho</span></span><a class="headerlink" href="#merlion.models.forecast.smoother.MSES.rho" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.MSES.backsteps">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">backsteps</span></span><a class="headerlink" href="#merlion.models.forecast.smoother.MSES.backsteps" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.MSES.max_horizon">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">max_horizon</span></span><a class="headerlink" href="#merlion.models.forecast.smoother.MSES.max_horizon" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.MSES.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tune_recency_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_cadence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.MSES.update" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Updates the MSES model with new data that has been acquired since the model‚Äôs initial training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>new_data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code>) ‚Äì New data that has occured since the last training time.</p></li>
<li><p><strong>tune_recency_weights</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) ‚Äì If True, the model will first forecast the values at the
new_data‚Äôs timestamps, calculate the associated losses, and use these losses
to make updates to the recency weight.</p></li>
<li><p><strong>train_cadence</strong> ‚Äì The frequency at which the training forecasts will be generated
during incremental training.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.MSES.xhat_h">
<span class="sig-name descname"><span class="pre">xhat_h</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">horizon</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.MSES.xhat_h" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Returns the forecasts for the input horizon at every backstep.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.MSES.marginalize_xhat_h">
<span class="sig-name descname"><span class="pre">marginalize_xhat_h</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">horizon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xhat_h</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.MSES.marginalize_xhat_h" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Given a list of forecasted values produced by delta estimators at
different backsteps, compute a weighted average of these values. The
weights are assigned based on the standard errors of the velocities,
where the b‚Äôth estimate will be given more weight if its velocity has a
lower standard error relative to the other estimates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>horizon</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì the horizon at which we want to predict</p></li>
<li><p><strong>xhat_h</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) ‚Äì the forecasted values at this horizon, using each of
the possible backsteps</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaStats">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.smoother.</span></span><span class="sig-name descname"><span class="pre">DeltaStats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recency_weight</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaStats" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A wrapper around the statistics used to estimate deltas at a given scale.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scale</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì The scale associated with the statistics</p></li>
<li><p><strong>recency_weight</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) ‚Äì The recency weight parameter that that the incremental
velocity, acceleration and standard error statistics should use.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaStats.lag">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">lag</span></span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaStats.lag" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaStats.update_velocity">
<span class="sig-name descname"><span class="pre">update_velocity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vels</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaStats.update_velocity" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaStats.update_acceleration">
<span class="sig-name descname"><span class="pre">update_acceleration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">accs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaStats.update_acceleration" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaStats.update_loss">
<span class="sig-name descname"><span class="pre">update_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">losses</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaStats.update_loss" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaStats.tune">
<span class="sig-name descname"><span class="pre">tune</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">losses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaStats.tune" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Tunes the recency weight according to recent forecast losses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>losses</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) ‚Äì List of recent losses.</p></li>
<li><p><strong>eta</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) ‚Äì Constant by which to scale the update to the recency weight.
A bigger eta means more aggressive updates to the recency_weight.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.smoother.</span></span><span class="sig-name descname"><span class="pre">DeltaEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recency_weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accel_weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimize_acc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaEstimator" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for estimating the delta for MSES.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_scale</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì Delta Estimator can estimate delta over multiple scales, or
time steps, ranging from 1,2,‚Ä¶,max_scale.</p></li>
<li><p><strong>recency_weight</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) ‚Äì The recency weight parameter to use when estimating delta_hat.</p></li>
<li><p><strong>accel_weight</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) ‚Äì The weight to scale the acceleration by when computing delta_hat.
Specifically, delta_hat(b+h) = velocity(b+h) + accel_weight * acceleration(b+h).</p></li>
<li><p><strong>optimize_acc</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) ‚Äì If True, the acceleration correction will only be used at scales
ranging from 1,‚Ä¶,max_scale/2.</p></li>
<li><p><strong>eta</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) ‚Äì The parameter used to control the rate at which recency_weight gets
tuned when online updates are made to the model and losses can be computed.</p></li>
<li><p><strong>data</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.UnivariateTimeSeries" title="merlion.utils.time_series.UnivariateTimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">UnivariateTimeSeries</span></code></a>]) ‚Äì The data to initialize the delta estimator with.</p></li>
<li><p><strong>stats</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <a class="reference internal" href="#merlion.models.forecast.smoother.DeltaStats" title="merlion.models.forecast.smoother.DeltaStats"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeltaStats</span></code></a>]]) ‚Äì Dictionary mapping scales to DeltaStats objects to be used for delta
estimation.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaEstimator.acc_max_scale">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">acc_max_scale</span></span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaEstimator.acc_max_scale" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaEstimator.max_scale">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">max_scale</span></span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaEstimator.max_scale" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaEstimator.data">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data</span></span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaEstimator.data" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaEstimator.x">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">x</span></span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaEstimator.x" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaEstimator.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaEstimator.train" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Updates the delta statistics: velocity, acceleration and velocity
standard error at each scale using new data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>new_data</strong> (<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.UnivariateTimeSeries" title="merlion.utils.time_series.UnivariateTimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">UnivariateTimeSeries</span></code></a>) ‚Äì new datapoints in the time series.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaEstimator.process_losses">
<span class="sig-name descname"><span class="pre">process_losses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale_losses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tune_recency_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaEstimator.process_losses" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Uses recent forecast errors to improve the delta estimator. This is done by updating
the recency_weight that is used by delta stats at particular scales.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scale_losses</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) ‚Äì A dictionary mapping a scale to a list of forecasting errors
that associated with that scale.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaEstimator.velocity">
<span class="sig-name descname"><span class="pre">velocity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaEstimator.velocity" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaEstimator.acceleration">
<span class="sig-name descname"><span class="pre">acceleration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaEstimator.acceleration" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaEstimator.vel_err">
<span class="sig-name descname"><span class="pre">vel_err</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaEstimator.vel_err" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaEstimator.pos_err">
<span class="sig-name descname"><span class="pre">pos_err</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaEstimator.pos_err" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaEstimator.neg_err">
<span class="sig-name descname"><span class="pre">neg_err</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaEstimator.neg_err" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaEstimator.loss_err">
<span class="sig-name descname"><span class="pre">loss_err</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaEstimator.loss_err" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaEstimator.delta_hat">
<span class="sig-name descname"><span class="pre">delta_hat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaEstimator.delta_hat" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="multivariate-models">
<h2>Multivariate models<a class="headerlink" href="#multivariate-models" title="Permalink to this heading">ÔÉÅ</a></h2>
<div class="section" id="module-merlion.models.forecast.vector_ar">
<span id="forecast-vector-ar"></span><h3>forecast.vector_ar<a class="headerlink" href="#module-merlion.models.forecast.vector_ar" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>Vector AutoRegressive model for multivariate time series forecasting.</p>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.vector_ar.VectorARConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.vector_ar.</span></span><span class="sig-name descname"><span class="pre">VectorARConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maxlags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_seq_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog_aggregation_policy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog_missing_value_policy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ZFill'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_forecast_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invert_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.vector_ar.VectorARConfig" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.base.ForecasterExogConfig" title="merlion.models.forecast.base.ForecasterExogConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForecasterExogConfig</span></code></a></p>
<p>Config object for <cite>VectorAR</cite> forecaster.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>maxlags</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) ‚Äì Max # of lags for AR</p></li>
<li><p><strong>target_seq_index</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) ‚Äì The index of the univariate (amongst all
univariates in a general multivariate time series) whose value we
would like to forecast.</p></li>
<li><p><strong>exog_transform</strong> ‚Äì The pre-processing transform for exogenous data. Note: resampling is handled separately.</p></li>
<li><p><strong>exog_aggregation_policy</strong> ‚Äì The policy to use for aggregating values in exogenous data,
to ensure it is sampled at the same timestamps as the endogenous data.</p></li>
<li><p><strong>exog_missing_value_policy</strong> ‚Äì The policy to use for imputing missing values in exogenous data,
to ensure it is sampled at the same timestamps as the endogenous data.</p></li>
<li><p><strong>max_forecast_steps</strong> ‚Äì Max # of steps we would like to forecast for.  Required for some models like <cite>MSES</cite>.</p></li>
<li><p><strong>invert_transform</strong> ‚Äì Whether to automatically invert the <code class="docutils literal notranslate"><span class="pre">transform</span></code> before returning a forecast.
By default, we will invert the transform for all base forecasters if it supports a proper inversion, but
we will not invert it for forecaster-based anomaly detectors or transforms without proper inversions.</p></li>
<li><p><strong>transform</strong> ‚Äì Transformation to pre-process input time series.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.vector_ar.VectorAR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.vector_ar.</span></span><span class="sig-name descname"><span class="pre">VectorAR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.vector_ar.VectorAR" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.base.ForecasterExogBase" title="merlion.models.forecast.base.ForecasterExogBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForecasterExogBase</span></code></a></p>
<p>Vector AutoRegressive model for multivariate time series forecasting.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.vector_ar.VectorAR.config_class">
<span class="sig-name descname"><span class="pre">config_class</span></span><a class="headerlink" href="#merlion.models.forecast.vector_ar.VectorAR.config_class" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>alias of <a class="reference internal" href="#merlion.models.forecast.vector_ar.VectorARConfig" title="merlion.models.forecast.vector_ar.VectorARConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">VectorARConfig</span></code></a></p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.vector_ar.VectorAR.require_even_sampling">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">require_even_sampling</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#merlion.models.forecast.vector_ar.VectorAR.require_even_sampling" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Whether the model assumes that training data is sampled at a fixed frequency</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.vector_ar.VectorAR.maxlags">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">maxlags</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#merlion.models.forecast.vector_ar.VectorAR.maxlags" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-merlion.models.forecast.trees">
<span id="forecast-trees"></span><h3>forecast.trees<a class="headerlink" href="#module-merlion.models.forecast.trees" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>Tree-based models for multivariate time series forecasting.</p>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.trees.RandomForestForecasterConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.trees.</span></span><span class="sig-name descname"><span class="pre">RandomForestForecasterConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">min_samples_split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_estimators</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxlags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_forecast_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_seq_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog_aggregation_policy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog_missing_value_policy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ZFill'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invert_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.trees.RandomForestForecasterConfig" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">_TreeEnsembleForecasterConfig</span></code></p>
<p>Config class for <cite>RandomForestForecaster</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>min_samples_split</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì min split for tree leaves</p></li>
<li><p><strong>n_estimators</strong> ‚Äì number of base estimators for the tree ensemble</p></li>
<li><p><strong>max_depth</strong> ‚Äì max depth of base estimators</p></li>
<li><p><strong>random_state</strong> ‚Äì random seed for bagging</p></li>
<li><p><strong>maxlags</strong> ‚Äì Size of historical window to base the forecast on.</p></li>
<li><p><strong>max_forecast_steps</strong> ‚Äì Max # of steps we would like to forecast for.</p></li>
<li><p><strong>target_seq_index</strong> ‚Äì The index of the univariate (amongst all univariates in a general multivariate time
series) whose value we would like to forecast.</p></li>
<li><p><strong>prediction_stride</strong> ‚Äì <p>the number of steps being forecasted in a single call to underlying the model</p>
<ul>
<li><p>If univariate: the sequence target of the length of prediction_stride will be utilized, forecasting will
be done autoregressively, with the stride unit of prediction_stride</p></li>
<li><p>If multivariate:</p>
<blockquote>
<div><ul class="simple">
<li><p>if = 1: autoregressively forecast all variables in the time series, one step at a time</p></li>
<li><p>if &gt; 1: only support directly forecasting the next prediction_stride steps in the future.
Autoregression not supported. Note that the model will set prediction_stride = max_forecast_steps.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</p></li>
<li><p><strong>exog_transform</strong> ‚Äì The pre-processing transform for exogenous data. Note: resampling is handled separately.</p></li>
<li><p><strong>exog_aggregation_policy</strong> ‚Äì The policy to use for aggregating values in exogenous data,
to ensure it is sampled at the same timestamps as the endogenous data.</p></li>
<li><p><strong>exog_missing_value_policy</strong> ‚Äì The policy to use for imputing missing values in exogenous data,
to ensure it is sampled at the same timestamps as the endogenous data.</p></li>
<li><p><strong>invert_transform</strong> ‚Äì Whether to automatically invert the <code class="docutils literal notranslate"><span class="pre">transform</span></code> before returning a forecast.
By default, we will invert the transform for all base forecasters if it supports a proper inversion, but
we will not invert it for forecaster-based anomaly detectors or transforms without proper inversions.</p></li>
<li><p><strong>transform</strong> ‚Äì Transformation to pre-process input time series.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.trees.RandomForestForecaster">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.trees.</span></span><span class="sig-name descname"><span class="pre">RandomForestForecaster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.trees.RandomForestForecaster" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.sklearn_base.SKLearnForecaster" title="merlion.models.forecast.sklearn_base.SKLearnForecaster"><code class="xref py py-class docutils literal notranslate"><span class="pre">SKLearnForecaster</span></code></a></p>
<p>Random Forest Regressor for time series forecasting</p>
<p>Random Forest is a meta estimator that fits a number of classifying decision
trees on various sub-samples of the dataset, and uses averaging to improve
the predictive accuracy and control over-fitting.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.trees.RandomForestForecaster.config_class">
<span class="sig-name descname"><span class="pre">config_class</span></span><a class="headerlink" href="#merlion.models.forecast.trees.RandomForestForecaster.config_class" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>alias of <a class="reference internal" href="#merlion.models.forecast.trees.RandomForestForecasterConfig" title="merlion.models.forecast.trees.RandomForestForecasterConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">RandomForestForecasterConfig</span></code></a></p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.trees.ExtraTreesForecasterConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.trees.</span></span><span class="sig-name descname"><span class="pre">ExtraTreesForecasterConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">min_samples_split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_estimators</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxlags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_forecast_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_seq_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog_aggregation_policy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog_missing_value_policy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ZFill'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invert_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.trees.ExtraTreesForecasterConfig" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">_TreeEnsembleForecasterConfig</span></code></p>
<p>Config class for <cite>ExtraTreesForecaster</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>min_samples_split</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì min split for tree leaves</p></li>
<li><p><strong>n_estimators</strong> ‚Äì number of base estimators for the tree ensemble</p></li>
<li><p><strong>max_depth</strong> ‚Äì max depth of base estimators</p></li>
<li><p><strong>random_state</strong> ‚Äì random seed for bagging</p></li>
<li><p><strong>maxlags</strong> ‚Äì Size of historical window to base the forecast on.</p></li>
<li><p><strong>max_forecast_steps</strong> ‚Äì Max # of steps we would like to forecast for.</p></li>
<li><p><strong>target_seq_index</strong> ‚Äì The index of the univariate (amongst all univariates in a general multivariate time
series) whose value we would like to forecast.</p></li>
<li><p><strong>prediction_stride</strong> ‚Äì <p>the number of steps being forecasted in a single call to underlying the model</p>
<ul>
<li><p>If univariate: the sequence target of the length of prediction_stride will be utilized, forecasting will
be done autoregressively, with the stride unit of prediction_stride</p></li>
<li><p>If multivariate:</p>
<blockquote>
<div><ul class="simple">
<li><p>if = 1: autoregressively forecast all variables in the time series, one step at a time</p></li>
<li><p>if &gt; 1: only support directly forecasting the next prediction_stride steps in the future.
Autoregression not supported. Note that the model will set prediction_stride = max_forecast_steps.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</p></li>
<li><p><strong>exog_transform</strong> ‚Äì The pre-processing transform for exogenous data. Note: resampling is handled separately.</p></li>
<li><p><strong>exog_aggregation_policy</strong> ‚Äì The policy to use for aggregating values in exogenous data,
to ensure it is sampled at the same timestamps as the endogenous data.</p></li>
<li><p><strong>exog_missing_value_policy</strong> ‚Äì The policy to use for imputing missing values in exogenous data,
to ensure it is sampled at the same timestamps as the endogenous data.</p></li>
<li><p><strong>invert_transform</strong> ‚Äì Whether to automatically invert the <code class="docutils literal notranslate"><span class="pre">transform</span></code> before returning a forecast.
By default, we will invert the transform for all base forecasters if it supports a proper inversion, but
we will not invert it for forecaster-based anomaly detectors or transforms without proper inversions.</p></li>
<li><p><strong>transform</strong> ‚Äì Transformation to pre-process input time series.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.trees.ExtraTreesForecaster">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.trees.</span></span><span class="sig-name descname"><span class="pre">ExtraTreesForecaster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.trees.ExtraTreesForecaster" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.sklearn_base.SKLearnForecaster" title="merlion.models.forecast.sklearn_base.SKLearnForecaster"><code class="xref py py-class docutils literal notranslate"><span class="pre">SKLearnForecaster</span></code></a></p>
<p>Extra Trees Regressor for time series forecasting</p>
<p>Extra Trees Regressor implements a meta estimator that fits a number of
randomized decision trees (a.k.a. extra-trees) on various sub-samples of
the dataset and uses averaging to improve the predictive accuracy and
control over-fitting.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.trees.ExtraTreesForecaster.config_class">
<span class="sig-name descname"><span class="pre">config_class</span></span><a class="headerlink" href="#merlion.models.forecast.trees.ExtraTreesForecaster.config_class" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>alias of <a class="reference internal" href="#merlion.models.forecast.trees.ExtraTreesForecasterConfig" title="merlion.models.forecast.trees.ExtraTreesForecasterConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExtraTreesForecasterConfig</span></code></a></p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.trees.LGBMForecasterConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.trees.</span></span><span class="sig-name descname"><span class="pre">LGBMForecasterConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_estimators</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxlags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_forecast_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_seq_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog_aggregation_policy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog_missing_value_policy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ZFill'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invert_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.trees.LGBMForecasterConfig" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">_TreeEnsembleForecasterConfig</span></code></p>
<p>Config class for <cite>LGBMForecaster</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>learning_rate</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) ‚Äì learning rate for boosting</p></li>
<li><p><strong>n_jobs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì num of threading, -1 or 0 indicates device default, positive int indicates num of threads</p></li>
<li><p><strong>n_estimators</strong> ‚Äì number of base estimators for the tree ensemble</p></li>
<li><p><strong>max_depth</strong> ‚Äì max depth of base estimators</p></li>
<li><p><strong>random_state</strong> ‚Äì random seed for bagging</p></li>
<li><p><strong>maxlags</strong> ‚Äì Size of historical window to base the forecast on.</p></li>
<li><p><strong>max_forecast_steps</strong> ‚Äì Max # of steps we would like to forecast for.</p></li>
<li><p><strong>target_seq_index</strong> ‚Äì The index of the univariate (amongst all univariates in a general multivariate time
series) whose value we would like to forecast.</p></li>
<li><p><strong>prediction_stride</strong> ‚Äì <p>the number of steps being forecasted in a single call to underlying the model</p>
<ul>
<li><p>If univariate: the sequence target of the length of prediction_stride will be utilized, forecasting will
be done autoregressively, with the stride unit of prediction_stride</p></li>
<li><p>If multivariate:</p>
<blockquote>
<div><ul class="simple">
<li><p>if = 1: autoregressively forecast all variables in the time series, one step at a time</p></li>
<li><p>if &gt; 1: only support directly forecasting the next prediction_stride steps in the future.
Autoregression not supported. Note that the model will set prediction_stride = max_forecast_steps.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</p></li>
<li><p><strong>exog_transform</strong> ‚Äì The pre-processing transform for exogenous data. Note: resampling is handled separately.</p></li>
<li><p><strong>exog_aggregation_policy</strong> ‚Äì The policy to use for aggregating values in exogenous data,
to ensure it is sampled at the same timestamps as the endogenous data.</p></li>
<li><p><strong>exog_missing_value_policy</strong> ‚Äì The policy to use for imputing missing values in exogenous data,
to ensure it is sampled at the same timestamps as the endogenous data.</p></li>
<li><p><strong>invert_transform</strong> ‚Äì Whether to automatically invert the <code class="docutils literal notranslate"><span class="pre">transform</span></code> before returning a forecast.
By default, we will invert the transform for all base forecasters if it supports a proper inversion, but
we will not invert it for forecaster-based anomaly detectors or transforms without proper inversions.</p></li>
<li><p><strong>transform</strong> ‚Äì Transformation to pre-process input time series.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.trees.LGBMForecaster">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.trees.</span></span><span class="sig-name descname"><span class="pre">LGBMForecaster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.trees.LGBMForecaster" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.sklearn_base.SKLearnForecaster" title="merlion.models.forecast.sklearn_base.SKLearnForecaster"><code class="xref py py-class docutils literal notranslate"><span class="pre">SKLearnForecaster</span></code></a></p>
<p>Light gradient boosting (LGBM) regressor for time series forecasting</p>
<p>LightGBM is a light weight and fast gradient boosting framework that uses tree based learning algorithms, for more
details, please refer to the document <a class="reference external" href="https://lightgbm.readthedocs.io/en/latest/Features.html">https://lightgbm.readthedocs.io/en/latest/Features.html</a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.trees.LGBMForecaster.config_class">
<span class="sig-name descname"><span class="pre">config_class</span></span><a class="headerlink" href="#merlion.models.forecast.trees.LGBMForecaster.config_class" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>alias of <a class="reference internal" href="#merlion.models.forecast.trees.LGBMForecasterConfig" title="merlion.models.forecast.trees.LGBMForecasterConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">LGBMForecasterConfig</span></code></a></p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-merlion.models.forecast.deep_ar">
<span id="forecast-deep-ar"></span><h3>forecast.deep_ar<a class="headerlink" href="#module-merlion.models.forecast.deep_ar" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>Implementation of Deep AR</p>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.deep_ar.DeepARConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.deep_ar.</span></span><span class="sig-name descname"><span class="pre">DeepARConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_past</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_forecast_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_hidden_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lags_seq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_prediction_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">LossFunction.guassian_nll</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.deep_ar.DeepARConfig" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.deep_base.DeepForecasterConfig" title="merlion.models.forecast.deep_base.DeepForecasterConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeepForecasterConfig</span></code></a>, <a class="reference internal" href="merlion.models.html#merlion.models.base.NormalizingConfig" title="merlion.models.base.NormalizingConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">NormalizingConfig</span></code></a></p>
<p>DeepAR: Probabilistic Forecasting with Autoregressive Recurrent Networks: <a class="reference external" href="https://arxiv.org/abs/1704.04110">https://arxiv.org/abs/1704.04110</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_past</strong> ‚Äì # of past steps used for forecasting future.</p></li>
<li><p><strong>max_forecast_steps</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) ‚Äì Max # of steps we would like to forecast for.</p></li>
<li><p><strong>hidden_size</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) ‚Äì hidden_size of the LSTM layers</p></li>
<li><p><strong>num_hidden_layers</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì # of hidden layers in LSTM</p></li>
<li><p><strong>lags_seq</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) ‚Äì Indices of the lagged observations that the RNN takes as input. For example,
<code class="docutils literal notranslate"><span class="pre">[1]</span></code> indicates that the RNN only takes the observation at time <code class="docutils literal notranslate"><span class="pre">t-1</span></code> to produce the
output for time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p></li>
<li><p><strong>num_prediction_samples</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì # of samples to produce the forecasting</p></li>
<li><p><strong>loss_fn</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <a class="reference internal" href="merlion.models.html#merlion.models.deep_base.LossFunction" title="merlion.models.deep_base.LossFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">LossFunction</span></code></a>]) ‚Äì Loss function for optimizing deep learning models. The value of loss_fn can be
<code class="docutils literal notranslate"><span class="pre">mse</span></code> for l2 loss, <code class="docutils literal notranslate"><span class="pre">l1</span></code> for l1 loss, <code class="docutils literal notranslate"><span class="pre">huber</span></code> for huber loss.</p></li>
<li><p><strong>batch_size</strong> ‚Äì Batch size of a batch for stochastic training of deep models</p></li>
<li><p><strong>num_epochs</strong> ‚Äì Total number of epochs for training.</p></li>
<li><p><strong>optimizer</strong> ‚Äì The optimizer for learning the parameters of the deep learning models. The value of optimizer
can be <code class="docutils literal notranslate"><span class="pre">Adam</span></code>, <code class="docutils literal notranslate"><span class="pre">AdamW</span></code>, <code class="docutils literal notranslate"><span class="pre">SGD</span></code>, <code class="docutils literal notranslate"><span class="pre">Adagrad</span></code>, <code class="docutils literal notranslate"><span class="pre">RMSprop</span></code>.</p></li>
<li><p><strong>clip_gradient</strong> ‚Äì Clipping gradient norm of model parameters before updating. If <code class="docutils literal notranslate"><span class="pre">clip_gradient</span> <span class="pre">is</span> <span class="pre">None</span></code>,
then the gradient will not be clipped.</p></li>
<li><p><strong>use_gpu</strong> ‚Äì Whether to use gpu for training deep models. If <code class="docutils literal notranslate"><span class="pre">use_gpu</span> <span class="pre">=</span> <span class="pre">True</span></code> while thre is no GPU device,
the model will use CPU for training instead.</p></li>
<li><p><strong>ts_encoding</strong> ‚Äì whether the timestamp should be encoded to a float vector, which can be used
for training deep learning based time series models; if <code class="docutils literal notranslate"><span class="pre">None</span></code>, the timestamp is not encoded.
If not <code class="docutils literal notranslate"><span class="pre">None</span></code>, it represents the frequency for time features encoding options:[s:secondly, t:minutely, h:hourly,
d:daily, b:business days, w:weekly, m:monthly]</p></li>
<li><p><strong>lr</strong> ‚Äì Learning rate for optimizing deep learning models.</p></li>
<li><p><strong>weight_decay</strong> ‚Äì Weight decay (L2 penalty) (default: 0)</p></li>
<li><p><strong>valid_fraction</strong> ‚Äì Fraction of validation set to be split from training data</p></li>
<li><p><strong>early_stop_patience</strong> ‚Äì Number of epochs with no improvement after which training will be stopped for
early stopping function. If <code class="docutils literal notranslate"><span class="pre">early_stop_patience</span> <span class="pre">=</span> <span class="pre">None</span></code>, the training process will not stop early.</p></li>
<li><p><strong>transform</strong> ‚Äì Transformation to pre-process input time series.</p></li>
<li><p><strong>target_seq_index</strong> ‚Äì The index of the univariate (amongst all univariates in a general multivariate time
series) whose value we would like to forecast.</p></li>
<li><p><strong>invert_transform</strong> ‚Äì Whether to automatically invert the <code class="docutils literal notranslate"><span class="pre">transform</span></code> before returning a forecast.
By default, we will invert the transform for all base forecasters if it supports a proper inversion, but
we will not invert it for forecaster-based anomaly detectors or transforms without proper inversions.</p></li>
<li><p><strong>normalize</strong> ‚Äì Pre-trained normalization transformation (optional).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.deep_ar.DeepARModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.deep_ar.</span></span><span class="sig-name descname"><span class="pre">DeepARModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.deep_ar.DeepARModel" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="merlion.models.html#merlion.models.deep_base.TorchModel" title="merlion.models.deep_base.TorchModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">TorchModel</span></code></a></p>
<p>Implementaion of Deep AR model</p>
<p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.deep_ar.DeepARModel.get_lagged_subsequences">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_lagged_subsequences</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sequence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subsequences_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.deep_ar.DeepARModel.get_lagged_subsequences" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.deep_ar.DeepARModel.unroll_encoder">
<span class="sig-name descname"><span class="pre">unroll_encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">past</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_timestamp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_timestamp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.deep_ar.DeepARModel.unroll_encoder" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.deep_ar.DeepARModel.calculate_loss">
<span class="sig-name descname"><span class="pre">calculate_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">past</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_timestamp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_timestamp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.deep_ar.DeepARModel.calculate_loss" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.deep_ar.DeepARModel.sampling_decoder">
<span class="sig-name descname"><span class="pre">sampling_decoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">past</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">begin_states</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.deep_ar.DeepARModel.sampling_decoder" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.deep_ar.DeepARModel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">past</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_timestamp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_timestamp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.deep_ar.DeepARModel.forward" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.deep_ar.DeepARForecaster">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.deep_ar.</span></span><span class="sig-name descname"><span class="pre">DeepARForecaster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.deep_ar.DeepARForecaster" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.deep_base.DeepForecaster" title="merlion.models.forecast.deep_base.DeepForecaster"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeepForecaster</span></code></a></p>
<p>Implementaion of Deep AR model forecaster</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.deep_ar.DeepARForecaster.config_class">
<span class="sig-name descname"><span class="pre">config_class</span></span><a class="headerlink" href="#merlion.models.forecast.deep_ar.DeepARForecaster.config_class" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>alias of <a class="reference internal" href="#merlion.models.forecast.deep_ar.DeepARConfig" title="merlion.models.forecast.deep_ar.DeepARConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeepARConfig</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.deep_ar.DeepARForecaster.deep_model_class">
<span class="sig-name descname"><span class="pre">deep_model_class</span></span><a class="headerlink" href="#merlion.models.forecast.deep_ar.DeepARForecaster.deep_model_class" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>alias of <a class="reference internal" href="#merlion.models.forecast.deep_ar.DeepARModel" title="merlion.models.forecast.deep_ar.DeepARModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeepARModel</span></code></a></p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-merlion.models.forecast.autoformer">
<span id="forecast-autoformer"></span><h3>forecast.autoformer<a class="headerlink" href="#module-merlion.models.forecast.autoformer" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>Implementation of Autoformer.</p>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.autoformer.AutoformerConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.autoformer.</span></span><span class="sig-name descname"><span class="pre">AutoformerConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_past</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_forecast_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moving_avg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_input_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder_input_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_encoder_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_decoder_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_token_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'timeF'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gelu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcn_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2048</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.autoformer.AutoformerConfig" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.deep_base.DeepForecasterConfig" title="merlion.models.forecast.deep_base.DeepForecasterConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeepForecasterConfig</span></code></a>, <a class="reference internal" href="merlion.models.html#merlion.models.base.NormalizingConfig" title="merlion.models.base.NormalizingConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">NormalizingConfig</span></code></a></p>
<p>Decomposition Transformers with Auto-Correlation for Long-Term Series Forecasting: <a class="reference external" href="https://arxiv.org/abs/2106.13008">https://arxiv.org/abs/2106.13008</a>.
Code adapted from <a class="reference external" href="https://github.com/thuml/Autoformer">https://github.com/thuml/Autoformer</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_past</strong> ‚Äì # of past steps used for forecasting future.</p></li>
<li><p><strong>max_forecast_steps</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) ‚Äì Max # of steps we would like to forecast for.</p></li>
<li><p><strong>moving_avg</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì Window size of moving average for Autoformer.</p></li>
<li><p><strong>encoder_input_size</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) ‚Äì Input size of encoder. If <code class="docutils literal notranslate"><span class="pre">encoder_input_size</span> <span class="pre">=</span> <span class="pre">None</span></code>,
then the model will automatically use <code class="docutils literal notranslate"><span class="pre">config.dim</span></code>,  which is the dimension of the input data.</p></li>
<li><p><strong>decoder_input_size</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) ‚Äì Input size of decoder. If <code class="docutils literal notranslate"><span class="pre">decoder_input_size</span> <span class="pre">=</span> <span class="pre">None</span></code>,
then the model will automatically use <code class="docutils literal notranslate"><span class="pre">config.dim</span></code>, which is the dimension of the input data.</p></li>
<li><p><strong>num_encoder_layers</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì Number of encoder layers.</p></li>
<li><p><strong>num_decoder_layers</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì Number of decoder layers.</p></li>
<li><p><strong>start_token_len</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì Length of start token for deep transformer encoder-decoder based models.
The start token is similar to the special tokens for NLP models (e.g., bos, sep, eos tokens).</p></li>
<li><p><strong>factor</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì Attention factor.</p></li>
<li><p><strong>model_dim</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì Dimension of the model.</p></li>
<li><p><strong>embed</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) ‚Äì Time feature encoding type, options include <code class="docutils literal notranslate"><span class="pre">timeF</span></code>, <code class="docutils literal notranslate"><span class="pre">fixed</span></code> and <code class="docutils literal notranslate"><span class="pre">learned</span></code>.</p></li>
<li><p><strong>dropout</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) ‚Äì dropout rate.</p></li>
<li><p><strong>activation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) ‚Äì Activation function, can be <code class="docutils literal notranslate"><span class="pre">gelu</span></code>, <code class="docutils literal notranslate"><span class="pre">relu</span></code>, <code class="docutils literal notranslate"><span class="pre">sigmoid</span></code>, etc.</p></li>
<li><p><strong>n_heads</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì Number of heads of the model.</p></li>
<li><p><strong>fcn_dim</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì Hidden dimension of the MLP layer in the model.</p></li>
<li><p><strong>batch_size</strong> ‚Äì Batch size of a batch for stochastic training of deep models</p></li>
<li><p><strong>num_epochs</strong> ‚Äì Total number of epochs for training.</p></li>
<li><p><strong>optimizer</strong> ‚Äì The optimizer for learning the parameters of the deep learning models. The value of optimizer
can be <code class="docutils literal notranslate"><span class="pre">Adam</span></code>, <code class="docutils literal notranslate"><span class="pre">AdamW</span></code>, <code class="docutils literal notranslate"><span class="pre">SGD</span></code>, <code class="docutils literal notranslate"><span class="pre">Adagrad</span></code>, <code class="docutils literal notranslate"><span class="pre">RMSprop</span></code>.</p></li>
<li><p><strong>loss_fn</strong> ‚Äì Loss function for optimizing deep learning models. The value of loss_fn can be
<code class="docutils literal notranslate"><span class="pre">mse</span></code> for l2 loss, <code class="docutils literal notranslate"><span class="pre">l1</span></code> for l1 loss, <code class="docutils literal notranslate"><span class="pre">huber</span></code> for huber loss.</p></li>
<li><p><strong>clip_gradient</strong> ‚Äì Clipping gradient norm of model parameters before updating. If <code class="docutils literal notranslate"><span class="pre">clip_gradient</span> <span class="pre">is</span> <span class="pre">None</span></code>,
then the gradient will not be clipped.</p></li>
<li><p><strong>use_gpu</strong> ‚Äì Whether to use gpu for training deep models. If <code class="docutils literal notranslate"><span class="pre">use_gpu</span> <span class="pre">=</span> <span class="pre">True</span></code> while thre is no GPU device,
the model will use CPU for training instead.</p></li>
<li><p><strong>ts_encoding</strong> ‚Äì whether the timestamp should be encoded to a float vector, which can be used
for training deep learning based time series models; if <code class="docutils literal notranslate"><span class="pre">None</span></code>, the timestamp is not encoded.
If not <code class="docutils literal notranslate"><span class="pre">None</span></code>, it represents the frequency for time features encoding options:[s:secondly, t:minutely, h:hourly,
d:daily, b:business days, w:weekly, m:monthly]</p></li>
<li><p><strong>lr</strong> ‚Äì Learning rate for optimizing deep learning models.</p></li>
<li><p><strong>weight_decay</strong> ‚Äì Weight decay (L2 penalty) (default: 0)</p></li>
<li><p><strong>valid_fraction</strong> ‚Äì Fraction of validation set to be split from training data</p></li>
<li><p><strong>early_stop_patience</strong> ‚Äì Number of epochs with no improvement after which training will be stopped for
early stopping function. If <code class="docutils literal notranslate"><span class="pre">early_stop_patience</span> <span class="pre">=</span> <span class="pre">None</span></code>, the training process will not stop early.</p></li>
<li><p><strong>transform</strong> ‚Äì Transformation to pre-process input time series.</p></li>
<li><p><strong>target_seq_index</strong> ‚Äì The index of the univariate (amongst all univariates in a general multivariate time
series) whose value we would like to forecast.</p></li>
<li><p><strong>invert_transform</strong> ‚Äì Whether to automatically invert the <code class="docutils literal notranslate"><span class="pre">transform</span></code> before returning a forecast.
By default, we will invert the transform for all base forecasters if it supports a proper inversion, but
we will not invert it for forecaster-based anomaly detectors or transforms without proper inversions.</p></li>
<li><p><strong>normalize</strong> ‚Äì Pre-trained normalization transformation (optional).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.autoformer.AutoformerModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.autoformer.</span></span><span class="sig-name descname"><span class="pre">AutoformerModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.autoformer.AutoformerModel" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="merlion.models.html#merlion.models.deep_base.TorchModel" title="merlion.models.deep_base.TorchModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">TorchModel</span></code></a></p>
<p>Implementaion of Autoformer deep torch model.</p>
<p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.autoformer.AutoformerModel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">past</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_timestamp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_timestamp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enc_self_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec_self_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec_enc_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.autoformer.AutoformerModel.forward" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.autoformer.AutoformerForecaster">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.autoformer.</span></span><span class="sig-name descname"><span class="pre">AutoformerForecaster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.autoformer.AutoformerForecaster" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.deep_base.DeepForecaster" title="merlion.models.forecast.deep_base.DeepForecaster"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeepForecaster</span></code></a></p>
<p>Implementaion of Autoformer deep forecaster.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.autoformer.AutoformerForecaster.config_class">
<span class="sig-name descname"><span class="pre">config_class</span></span><a class="headerlink" href="#merlion.models.forecast.autoformer.AutoformerForecaster.config_class" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>alias of <a class="reference internal" href="#merlion.models.forecast.autoformer.AutoformerConfig" title="merlion.models.forecast.autoformer.AutoformerConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">AutoformerConfig</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.autoformer.AutoformerForecaster.deep_model_class">
<span class="sig-name descname"><span class="pre">deep_model_class</span></span><a class="headerlink" href="#merlion.models.forecast.autoformer.AutoformerForecaster.deep_model_class" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>alias of <a class="reference internal" href="#merlion.models.forecast.autoformer.AutoformerModel" title="merlion.models.forecast.autoformer.AutoformerModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">AutoformerModel</span></code></a></p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-merlion.models.forecast.etsformer">
<span id="forecast-etsformer"></span><h3>forecast.etsformer<a class="headerlink" href="#module-merlion.models.forecast.etsformer" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>Implementation of ETSformer.</p>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.etsformer.ETSformerConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.etsformer.</span></span><span class="sig-name descname"><span class="pre">ETSformerConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_past</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_forecast_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_input_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder_input_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_encoder_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_decoder_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcn_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2048</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_K</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.etsformer.ETSformerConfig" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.deep_base.DeepForecasterConfig" title="merlion.models.forecast.deep_base.DeepForecasterConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeepForecasterConfig</span></code></a>, <a class="reference internal" href="merlion.models.html#merlion.models.base.NormalizingConfig" title="merlion.models.base.NormalizingConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">NormalizingConfig</span></code></a></p>
<p>ETSformer: Exponential Smoothing Transformers for Time-series Forecasting: <a class="reference external" href="https://arxiv.org/abs/2202.01381">https://arxiv.org/abs/2202.01381</a>
Code adapted from <a class="reference external" href="https://github.com/salesforce/ETSformer">https://github.com/salesforce/ETSformer</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_past</strong> ‚Äì # of past steps used for forecasting future.</p></li>
<li><p><strong>max_forecast_steps</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) ‚Äì Max # of steps we would like to forecast for.</p></li>
<li><p><strong>encoder_input_size</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) ‚Äì Input size of encoder. If <code class="docutils literal notranslate"><span class="pre">encoder_input_size</span> <span class="pre">=</span> <span class="pre">None</span></code>,
then the model will automatically use <code class="docutils literal notranslate"><span class="pre">config.dim</span></code>,  which is the dimension of the input data.</p></li>
<li><p><strong>decoder_input_size</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) ‚Äì Input size of decoder. If <code class="docutils literal notranslate"><span class="pre">decoder_input_size</span> <span class="pre">=</span> <span class="pre">None</span></code>,
then the model will automatically use <code class="docutils literal notranslate"><span class="pre">config.dim</span></code>, which is the dimension of the input data.</p></li>
<li><p><strong>num_encoder_layers</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì Number of encoder layers.</p></li>
<li><p><strong>num_decoder_layers</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì Number of decoder layers.</p></li>
<li><p><strong>model_dim</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì Dimension of the model.</p></li>
<li><p><strong>dropout</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) ‚Äì dropout rate.</p></li>
<li><p><strong>n_heads</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì Number of heads of the model.</p></li>
<li><p><strong>fcn_dim</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì Hidden dimension of the MLP layer in the model.</p></li>
<li><p><strong>top_K</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì Top-K Frequent Fourier basis.</p></li>
<li><p><strong>sigma</strong> ‚Äì Standard derivation for ETS input data transform.</p></li>
<li><p><strong>batch_size</strong> ‚Äì Batch size of a batch for stochastic training of deep models</p></li>
<li><p><strong>num_epochs</strong> ‚Äì Total number of epochs for training.</p></li>
<li><p><strong>optimizer</strong> ‚Äì The optimizer for learning the parameters of the deep learning models. The value of optimizer
can be <code class="docutils literal notranslate"><span class="pre">Adam</span></code>, <code class="docutils literal notranslate"><span class="pre">AdamW</span></code>, <code class="docutils literal notranslate"><span class="pre">SGD</span></code>, <code class="docutils literal notranslate"><span class="pre">Adagrad</span></code>, <code class="docutils literal notranslate"><span class="pre">RMSprop</span></code>.</p></li>
<li><p><strong>loss_fn</strong> ‚Äì Loss function for optimizing deep learning models. The value of loss_fn can be
<code class="docutils literal notranslate"><span class="pre">mse</span></code> for l2 loss, <code class="docutils literal notranslate"><span class="pre">l1</span></code> for l1 loss, <code class="docutils literal notranslate"><span class="pre">huber</span></code> for huber loss.</p></li>
<li><p><strong>clip_gradient</strong> ‚Äì Clipping gradient norm of model parameters before updating. If <code class="docutils literal notranslate"><span class="pre">clip_gradient</span> <span class="pre">is</span> <span class="pre">None</span></code>,
then the gradient will not be clipped.</p></li>
<li><p><strong>use_gpu</strong> ‚Äì Whether to use gpu for training deep models. If <code class="docutils literal notranslate"><span class="pre">use_gpu</span> <span class="pre">=</span> <span class="pre">True</span></code> while thre is no GPU device,
the model will use CPU for training instead.</p></li>
<li><p><strong>ts_encoding</strong> ‚Äì whether the timestamp should be encoded to a float vector, which can be used
for training deep learning based time series models; if <code class="docutils literal notranslate"><span class="pre">None</span></code>, the timestamp is not encoded.
If not <code class="docutils literal notranslate"><span class="pre">None</span></code>, it represents the frequency for time features encoding options:[s:secondly, t:minutely, h:hourly,
d:daily, b:business days, w:weekly, m:monthly]</p></li>
<li><p><strong>lr</strong> ‚Äì Learning rate for optimizing deep learning models.</p></li>
<li><p><strong>weight_decay</strong> ‚Äì Weight decay (L2 penalty) (default: 0)</p></li>
<li><p><strong>valid_fraction</strong> ‚Äì Fraction of validation set to be split from training data</p></li>
<li><p><strong>early_stop_patience</strong> ‚Äì Number of epochs with no improvement after which training will be stopped for
early stopping function. If <code class="docutils literal notranslate"><span class="pre">early_stop_patience</span> <span class="pre">=</span> <span class="pre">None</span></code>, the training process will not stop early.</p></li>
<li><p><strong>transform</strong> ‚Äì Transformation to pre-process input time series.</p></li>
<li><p><strong>target_seq_index</strong> ‚Äì The index of the univariate (amongst all univariates in a general multivariate time
series) whose value we would like to forecast.</p></li>
<li><p><strong>invert_transform</strong> ‚Äì Whether to automatically invert the <code class="docutils literal notranslate"><span class="pre">transform</span></code> before returning a forecast.
By default, we will invert the transform for all base forecasters if it supports a proper inversion, but
we will not invert it for forecaster-based anomaly detectors or transforms without proper inversions.</p></li>
<li><p><strong>normalize</strong> ‚Äì Pre-trained normalization transformation (optional).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.etsformer.ETSformerModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.etsformer.</span></span><span class="sig-name descname"><span class="pre">ETSformerModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.etsformer.ETSformerModel" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="merlion.models.html#merlion.models.deep_base.TorchModel" title="merlion.models.deep_base.TorchModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">TorchModel</span></code></a></p>
<p>Implementaion of ETSformer deep torch model.</p>
<p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.etsformer.ETSformerModel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">past</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_timestamp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_timestamp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enc_self_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec_self_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec_enc_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.etsformer.ETSformerModel.forward" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.etsformer.ETSformerModel.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.etsformer.ETSformerModel.transform" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.etsformer.ETSformerModel.jitter">
<span class="sig-name descname"><span class="pre">jitter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.etsformer.ETSformerModel.jitter" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.etsformer.ETSformerModel.scale">
<span class="sig-name descname"><span class="pre">scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.etsformer.ETSformerModel.scale" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.etsformer.ETSformerModel.shift">
<span class="sig-name descname"><span class="pre">shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.etsformer.ETSformerModel.shift" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.etsformer.ETSformerForecaster">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.etsformer.</span></span><span class="sig-name descname"><span class="pre">ETSformerForecaster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.etsformer.ETSformerForecaster" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.deep_base.DeepForecaster" title="merlion.models.forecast.deep_base.DeepForecaster"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeepForecaster</span></code></a></p>
<p>Implementaion of ETSformer deep forecaster.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.etsformer.ETSformerForecaster.config_class">
<span class="sig-name descname"><span class="pre">config_class</span></span><a class="headerlink" href="#merlion.models.forecast.etsformer.ETSformerForecaster.config_class" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>alias of <a class="reference internal" href="#merlion.models.forecast.etsformer.ETSformerConfig" title="merlion.models.forecast.etsformer.ETSformerConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ETSformerConfig</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.etsformer.ETSformerForecaster.deep_model_class">
<span class="sig-name descname"><span class="pre">deep_model_class</span></span><a class="headerlink" href="#merlion.models.forecast.etsformer.ETSformerForecaster.deep_model_class" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>alias of <a class="reference internal" href="#merlion.models.forecast.etsformer.ETSformerModel" title="merlion.models.forecast.etsformer.ETSformerModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ETSformerModel</span></code></a></p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-merlion.models.forecast.informer">
<span id="forecast-informer"></span><h3>forecast.informer<a class="headerlink" href="#module-merlion.models.forecast.informer" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>Implementation of Informer.</p>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.informer.InformerConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.informer.</span></span><span class="sig-name descname"><span class="pre">InformerConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_past</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_forecast_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_input_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder_input_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_encoder_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_decoder_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_token_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'timeF'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gelu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcn_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2048</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distil</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.informer.InformerConfig" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.deep_base.DeepForecasterConfig" title="merlion.models.forecast.deep_base.DeepForecasterConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeepForecasterConfig</span></code></a>, <a class="reference internal" href="merlion.models.html#merlion.models.base.NormalizingConfig" title="merlion.models.base.NormalizingConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">NormalizingConfig</span></code></a></p>
<p>Informer: Beyond Efficient Transformer for Long Sequence Time-Series Forecasting: <a class="reference external" href="https://arxiv.org/abs/2012.07436">https://arxiv.org/abs/2012.07436</a>
Code adapted from <a class="reference external" href="https://github.com/thuml/Autoformer">https://github.com/thuml/Autoformer</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_past</strong> ‚Äì # of past steps used for forecasting future.</p></li>
<li><p><strong>max_forecast_steps</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) ‚Äì Max # of steps we would like to forecast for.</p></li>
<li><p><strong>encoder_input_size</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) ‚Äì Input size of encoder. If <code class="docutils literal notranslate"><span class="pre">encoder_input_size</span> <span class="pre">=</span> <span class="pre">None</span></code>,
then the model will automatically use <code class="docutils literal notranslate"><span class="pre">config.dim</span></code>,  which is the dimension of the input data.</p></li>
<li><p><strong>decoder_input_size</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) ‚Äì Input size of decoder. If <code class="docutils literal notranslate"><span class="pre">decoder_input_size</span> <span class="pre">=</span> <span class="pre">None</span></code>,
then the model will automatically use <code class="docutils literal notranslate"><span class="pre">config.dim</span></code>, which is the dimension of the input data.</p></li>
<li><p><strong>num_encoder_layers</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì Number of encoder layers.</p></li>
<li><p><strong>num_decoder_layers</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì Number of decoder layers.</p></li>
<li><p><strong>start_token_len</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì Length of start token for deep transformer encoder-decoder based models.
The start token is similar to the special tokens for NLP models (e.g., bos, sep, eos tokens).</p></li>
<li><p><strong>factor</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì Attention factor.</p></li>
<li><p><strong>model_dim</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì Dimension of the model.</p></li>
<li><p><strong>embed</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) ‚Äì Time feature encoding type, options include <code class="docutils literal notranslate"><span class="pre">timeF</span></code>, <code class="docutils literal notranslate"><span class="pre">fixed</span></code> and <code class="docutils literal notranslate"><span class="pre">learned</span></code>.</p></li>
<li><p><strong>dropout</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) ‚Äì dropout rate.</p></li>
<li><p><strong>activation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) ‚Äì Activation function, can be <code class="docutils literal notranslate"><span class="pre">gelu</span></code>, <code class="docutils literal notranslate"><span class="pre">relu</span></code>, <code class="docutils literal notranslate"><span class="pre">sigmoid</span></code>, etc.</p></li>
<li><p><strong>n_heads</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì Number of heads of the model.</p></li>
<li><p><strong>fcn_dim</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì Hidden dimension of the MLP layer in the model.</p></li>
<li><p><strong>distil</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) ‚Äì whether to use distilling in the encoder of the model.</p></li>
<li><p><strong>batch_size</strong> ‚Äì Batch size of a batch for stochastic training of deep models</p></li>
<li><p><strong>num_epochs</strong> ‚Äì Total number of epochs for training.</p></li>
<li><p><strong>optimizer</strong> ‚Äì The optimizer for learning the parameters of the deep learning models. The value of optimizer
can be <code class="docutils literal notranslate"><span class="pre">Adam</span></code>, <code class="docutils literal notranslate"><span class="pre">AdamW</span></code>, <code class="docutils literal notranslate"><span class="pre">SGD</span></code>, <code class="docutils literal notranslate"><span class="pre">Adagrad</span></code>, <code class="docutils literal notranslate"><span class="pre">RMSprop</span></code>.</p></li>
<li><p><strong>loss_fn</strong> ‚Äì Loss function for optimizing deep learning models. The value of loss_fn can be
<code class="docutils literal notranslate"><span class="pre">mse</span></code> for l2 loss, <code class="docutils literal notranslate"><span class="pre">l1</span></code> for l1 loss, <code class="docutils literal notranslate"><span class="pre">huber</span></code> for huber loss.</p></li>
<li><p><strong>clip_gradient</strong> ‚Äì Clipping gradient norm of model parameters before updating. If <code class="docutils literal notranslate"><span class="pre">clip_gradient</span> <span class="pre">is</span> <span class="pre">None</span></code>,
then the gradient will not be clipped.</p></li>
<li><p><strong>use_gpu</strong> ‚Äì Whether to use gpu for training deep models. If <code class="docutils literal notranslate"><span class="pre">use_gpu</span> <span class="pre">=</span> <span class="pre">True</span></code> while thre is no GPU device,
the model will use CPU for training instead.</p></li>
<li><p><strong>ts_encoding</strong> ‚Äì whether the timestamp should be encoded to a float vector, which can be used
for training deep learning based time series models; if <code class="docutils literal notranslate"><span class="pre">None</span></code>, the timestamp is not encoded.
If not <code class="docutils literal notranslate"><span class="pre">None</span></code>, it represents the frequency for time features encoding options:[s:secondly, t:minutely, h:hourly,
d:daily, b:business days, w:weekly, m:monthly]</p></li>
<li><p><strong>lr</strong> ‚Äì Learning rate for optimizing deep learning models.</p></li>
<li><p><strong>weight_decay</strong> ‚Äì Weight decay (L2 penalty) (default: 0)</p></li>
<li><p><strong>valid_fraction</strong> ‚Äì Fraction of validation set to be split from training data</p></li>
<li><p><strong>early_stop_patience</strong> ‚Äì Number of epochs with no improvement after which training will be stopped for
early stopping function. If <code class="docutils literal notranslate"><span class="pre">early_stop_patience</span> <span class="pre">=</span> <span class="pre">None</span></code>, the training process will not stop early.</p></li>
<li><p><strong>transform</strong> ‚Äì Transformation to pre-process input time series.</p></li>
<li><p><strong>target_seq_index</strong> ‚Äì The index of the univariate (amongst all univariates in a general multivariate time
series) whose value we would like to forecast.</p></li>
<li><p><strong>invert_transform</strong> ‚Äì Whether to automatically invert the <code class="docutils literal notranslate"><span class="pre">transform</span></code> before returning a forecast.
By default, we will invert the transform for all base forecasters if it supports a proper inversion, but
we will not invert it for forecaster-based anomaly detectors or transforms without proper inversions.</p></li>
<li><p><strong>normalize</strong> ‚Äì Pre-trained normalization transformation (optional).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.informer.InformerModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.informer.</span></span><span class="sig-name descname"><span class="pre">InformerModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.informer.InformerModel" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="merlion.models.html#merlion.models.deep_base.TorchModel" title="merlion.models.deep_base.TorchModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">TorchModel</span></code></a></p>
<p>Implementaion of informer deep torch model.</p>
<p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.informer.InformerModel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">past</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_timestamp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_timestamp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enc_self_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec_self_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec_enc_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.informer.InformerModel.forward" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.informer.InformerForecaster">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.informer.</span></span><span class="sig-name descname"><span class="pre">InformerForecaster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.informer.InformerForecaster" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.deep_base.DeepForecaster" title="merlion.models.forecast.deep_base.DeepForecaster"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeepForecaster</span></code></a></p>
<p>Implementaion of Informer deep forecaster.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.informer.InformerForecaster.config_class">
<span class="sig-name descname"><span class="pre">config_class</span></span><a class="headerlink" href="#merlion.models.forecast.informer.InformerForecaster.config_class" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>alias of <a class="reference internal" href="#merlion.models.forecast.informer.InformerConfig" title="merlion.models.forecast.informer.InformerConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">InformerConfig</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.informer.InformerForecaster.deep_model_class">
<span class="sig-name descname"><span class="pre">deep_model_class</span></span><a class="headerlink" href="#merlion.models.forecast.informer.InformerForecaster.deep_model_class" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>alias of <a class="reference internal" href="#merlion.models.forecast.informer.InformerModel" title="merlion.models.forecast.informer.InformerModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">InformerModel</span></code></a></p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-merlion.models.forecast.transformer">
<span id="forecast-transformer"></span><h3>forecast.transformer<a class="headerlink" href="#module-merlion.models.forecast.transformer" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>Implementation of Transformer for time series data.</p>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.transformer.TransformerConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.transformer.</span></span><span class="sig-name descname"><span class="pre">TransformerConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_past</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_forecast_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_input_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder_input_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_encoder_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_decoder_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_token_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'timeF'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gelu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcn_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2048</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distil</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.transformer.TransformerConfig" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.deep_base.DeepForecasterConfig" title="merlion.models.forecast.deep_base.DeepForecasterConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeepForecasterConfig</span></code></a>, <a class="reference internal" href="merlion.models.html#merlion.models.base.NormalizingConfig" title="merlion.models.base.NormalizingConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">NormalizingConfig</span></code></a></p>
<p>Transformer for time series forecasting.
Code adapted from <a class="reference external" href="https://github.com/thuml/Autoformer">https://github.com/thuml/Autoformer</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_past</strong> ‚Äì # of past steps used for forecasting future.</p></li>
<li><p><strong>max_forecast_steps</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) ‚Äì Max # of steps we would like to forecast for.</p></li>
<li><p><strong>encoder_input_size</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) ‚Äì Input size of encoder. If <code class="docutils literal notranslate"><span class="pre">encoder_input_size</span> <span class="pre">=</span> <span class="pre">None</span></code>,
then the model will automatically use <code class="docutils literal notranslate"><span class="pre">config.dim</span></code>,  which is the dimension of the input data.</p></li>
<li><p><strong>decoder_input_size</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) ‚Äì Input size of decoder. If <code class="docutils literal notranslate"><span class="pre">decoder_input_size</span> <span class="pre">=</span> <span class="pre">None</span></code>,
then the model will automatically use <code class="docutils literal notranslate"><span class="pre">config.dim</span></code>, which is the dimension of the input data.</p></li>
<li><p><strong>num_encoder_layers</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì Number of encoder layers.</p></li>
<li><p><strong>num_decoder_layers</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì Number of decoder layers.</p></li>
<li><p><strong>start_token_len</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì Length of start token for deep transformer encoder-decoder based models.
The start token is similar to the special tokens for NLP models (e.g., bos, sep, eos tokens).</p></li>
<li><p><strong>factor</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì Attention factor.</p></li>
<li><p><strong>model_dim</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì Dimension of the model.</p></li>
<li><p><strong>embed</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) ‚Äì Time feature encoding type, options include <code class="docutils literal notranslate"><span class="pre">timeF</span></code>, <code class="docutils literal notranslate"><span class="pre">fixed</span></code> and <code class="docutils literal notranslate"><span class="pre">learned</span></code>.</p></li>
<li><p><strong>dropout</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) ‚Äì dropout rate.</p></li>
<li><p><strong>activation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) ‚Äì Activation function, can be <code class="docutils literal notranslate"><span class="pre">gelu</span></code>, <code class="docutils literal notranslate"><span class="pre">relu</span></code>, <code class="docutils literal notranslate"><span class="pre">sigmoid</span></code>, etc.</p></li>
<li><p><strong>n_heads</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì Number of heads of the model.</p></li>
<li><p><strong>fcn_dim</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) ‚Äì Hidden dimension of the MLP layer in the model.</p></li>
<li><p><strong>distil</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) ‚Äì whether to use distilling in the encoder of the model.</p></li>
<li><p><strong>batch_size</strong> ‚Äì Batch size of a batch for stochastic training of deep models</p></li>
<li><p><strong>num_epochs</strong> ‚Äì Total number of epochs for training.</p></li>
<li><p><strong>optimizer</strong> ‚Äì The optimizer for learning the parameters of the deep learning models. The value of optimizer
can be <code class="docutils literal notranslate"><span class="pre">Adam</span></code>, <code class="docutils literal notranslate"><span class="pre">AdamW</span></code>, <code class="docutils literal notranslate"><span class="pre">SGD</span></code>, <code class="docutils literal notranslate"><span class="pre">Adagrad</span></code>, <code class="docutils literal notranslate"><span class="pre">RMSprop</span></code>.</p></li>
<li><p><strong>loss_fn</strong> ‚Äì Loss function for optimizing deep learning models. The value of loss_fn can be
<code class="docutils literal notranslate"><span class="pre">mse</span></code> for l2 loss, <code class="docutils literal notranslate"><span class="pre">l1</span></code> for l1 loss, <code class="docutils literal notranslate"><span class="pre">huber</span></code> for huber loss.</p></li>
<li><p><strong>clip_gradient</strong> ‚Äì Clipping gradient norm of model parameters before updating. If <code class="docutils literal notranslate"><span class="pre">clip_gradient</span> <span class="pre">is</span> <span class="pre">None</span></code>,
then the gradient will not be clipped.</p></li>
<li><p><strong>use_gpu</strong> ‚Äì Whether to use gpu for training deep models. If <code class="docutils literal notranslate"><span class="pre">use_gpu</span> <span class="pre">=</span> <span class="pre">True</span></code> while thre is no GPU device,
the model will use CPU for training instead.</p></li>
<li><p><strong>ts_encoding</strong> ‚Äì whether the timestamp should be encoded to a float vector, which can be used
for training deep learning based time series models; if <code class="docutils literal notranslate"><span class="pre">None</span></code>, the timestamp is not encoded.
If not <code class="docutils literal notranslate"><span class="pre">None</span></code>, it represents the frequency for time features encoding options:[s:secondly, t:minutely, h:hourly,
d:daily, b:business days, w:weekly, m:monthly]</p></li>
<li><p><strong>lr</strong> ‚Äì Learning rate for optimizing deep learning models.</p></li>
<li><p><strong>weight_decay</strong> ‚Äì Weight decay (L2 penalty) (default: 0)</p></li>
<li><p><strong>valid_fraction</strong> ‚Äì Fraction of validation set to be split from training data</p></li>
<li><p><strong>early_stop_patience</strong> ‚Äì Number of epochs with no improvement after which training will be stopped for
early stopping function. If <code class="docutils literal notranslate"><span class="pre">early_stop_patience</span> <span class="pre">=</span> <span class="pre">None</span></code>, the training process will not stop early.</p></li>
<li><p><strong>transform</strong> ‚Äì Transformation to pre-process input time series.</p></li>
<li><p><strong>target_seq_index</strong> ‚Äì The index of the univariate (amongst all univariates in a general multivariate time
series) whose value we would like to forecast.</p></li>
<li><p><strong>invert_transform</strong> ‚Äì Whether to automatically invert the <code class="docutils literal notranslate"><span class="pre">transform</span></code> before returning a forecast.
By default, we will invert the transform for all base forecasters if it supports a proper inversion, but
we will not invert it for forecaster-based anomaly detectors or transforms without proper inversions.</p></li>
<li><p><strong>normalize</strong> ‚Äì Pre-trained normalization transformation (optional).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.transformer.TransformerModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.transformer.</span></span><span class="sig-name descname"><span class="pre">TransformerModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.transformer.TransformerModel" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="merlion.models.html#merlion.models.deep_base.TorchModel" title="merlion.models.deep_base.TorchModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">TorchModel</span></code></a></p>
<p>Implementaion of Transformer deep torch model.</p>
<p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.transformer.TransformerModel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">past</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_timestamp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_timestamp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enc_self_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec_self_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec_enc_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.transformer.TransformerModel.forward" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.transformer.TransformerForecaster">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.transformer.</span></span><span class="sig-name descname"><span class="pre">TransformerForecaster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.transformer.TransformerForecaster" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.deep_base.DeepForecaster" title="merlion.models.forecast.deep_base.DeepForecaster"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeepForecaster</span></code></a></p>
<p>Implementaion of Transformer deep forecaster</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.transformer.TransformerForecaster.config_class">
<span class="sig-name descname"><span class="pre">config_class</span></span><a class="headerlink" href="#merlion.models.forecast.transformer.TransformerForecaster.config_class" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>alias of <a class="reference internal" href="#merlion.models.forecast.transformer.TransformerConfig" title="merlion.models.forecast.transformer.TransformerConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">TransformerConfig</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.transformer.TransformerForecaster.deep_model_class">
<span class="sig-name descname"><span class="pre">deep_model_class</span></span><a class="headerlink" href="#merlion.models.forecast.transformer.TransformerForecaster.deep_model_class" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>alias of <a class="reference internal" href="#merlion.models.forecast.transformer.TransformerModel" title="merlion.models.forecast.transformer.TransformerModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">TransformerModel</span></code></a></p>
</dd></dl>

</dd></dl>

</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="merlion.models.anomaly.change_point.html" class="btn btn-neutral float-left" title="anomaly.change_point" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="merlion.models.ensemble.html" class="btn btn-neutral float-right" title="ensemble" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, salesforce.com, inc..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Versions</span>
      latest
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      
      <dl>
        <dt>Versions</dt>
        
           <strong> 
          
          <dd><a href="../latest/index.html">latest</a></dd>
           </strong> 
        
          
          
          <dd><a href="../v2.0.0/index.html">v2.0.0</a></dd>
          
        
          
          
          <dd><a href="../v1.3.1/index.html">v1.3.1</a></dd>
          
        
          
          
          <dd><a href="../v1.3.0/index.html">v1.3.0</a></dd>
          
        
          
          
          <dd><a href="../v1.2.5/index.html">v1.2.5</a></dd>
          
        
          
          
          <dd><a href="../v1.2.4/index.html">v1.2.4</a></dd>
          
        
          
          
          <dd><a href="../v1.2.3/index.html">v1.2.3</a></dd>
          
        
          
          
          <dd><a href="../v1.2.2/index.html">v1.2.2</a></dd>
          
        
          
          
          <dd><a href="../v1.2.1/index.html">v1.2.1</a></dd>
          
        
          
          
          <dd><a href="../v1.2.0/index.html">v1.2.0</a></dd>
          
        
          
          
          <dd><a href="../v1.1.3/index.html">v1.1.3</a></dd>
          
        
          
          
          <dd><a href="../v1.1.2/index.html">v1.1.2</a></dd>
          
        
          
          
          <dd><a href="../v1.1.1/index.html">v1.1.1</a></dd>
          
        
          
          
          <dd><a href="../v1.1.0/index.html">v1.1.0</a></dd>
          
        
          
          
          <dd><a href="../v1.0.2/index.html">v1.0.2</a></dd>
          
        
          
          
          <dd><a href="../v1.0.1/index.html">v1.0.1</a></dd>
          
        
          
          
          <dd><a href="../v1.0.0/index.html">v1.0.0</a></dd>
          
        
      </dl>
      
    </div>
  </div>

 <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>