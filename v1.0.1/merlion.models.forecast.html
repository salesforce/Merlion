<!DOCTYPE html>

<html class="writer-html5" lang="en">
<head>
<meta charset="utf-8"/><meta content="Docutils 0.17.1: http://docutils.sourceforge.net/" name="generator"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>merlion.models.forecast package — Merlion 1.0.1 documentation</title>
<link href="_static/pygments.css" rel="stylesheet" type="text/css"/>
<link href="_static/css/theme.css" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
<script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
<script src="_static/jquery.js"></script>
<script src="_static/underscore.js"></script>
<script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
<script src="_static/doctools.js"></script>
<script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
<script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
<script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script src="_static/js/theme.js"></script>
<link href="genindex.html" rel="index" title="Index"/>
<link href="search.html" rel="search" title="Search"/>
<link href="merlion.models.ensemble.html" rel="next" title="merlion.models.ensemble package"/>
<link href="merlion.models.anomaly.forecast_based.html" rel="prev" title="merlion.models.anomaly.forecast_based package"/>
</head>
<body class="wy-body-for-nav">
<div class="wy-grid-for-nav">
<nav class="wy-nav-side" data-toggle="wy-nav-shift">
<div class="wy-side-scroll">
<div class="wy-side-nav-search">
<a class="icon icon-home" href="index.html"> Merlion
          </a>
<div class="version">
                v1.0.1
              </div>
<div role="search">
<form action="search.html" class="wy-form" id="rtd-search-form" method="get">
<input name="q" placeholder="Search docs" type="text"/>
<input name="check_keywords" type="hidden" value="yes"/>
<input name="area" type="hidden" value="default"/>
</form>
</div>
</div><div aria-label="Navigation menu" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="merlion.html">merlion: Time Series Intelligence</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="merlion.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="merlion.models.html">merlion.models package</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="merlion.models.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l5"><a class="reference internal" href="merlion.models.anomaly.html">merlion.models.anomaly package</a></li>
<li class="toctree-l5"><a class="reference internal" href="merlion.models.anomaly.forecast_based.html">merlion.models.anomaly.forecast_based package</a></li>
<li class="toctree-l5 current"><a class="current reference internal" href="#">merlion.models.forecast package</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l6"><a class="reference internal" href="#module-merlion.models.forecast.base">merlion.models.forecast.base module</a></li>
<li class="toctree-l6"><a class="reference internal" href="#module-merlion.models.forecast.arima">merlion.models.forecast.arima module</a></li>
<li class="toctree-l6"><a class="reference internal" href="#module-merlion.models.forecast.sarima">merlion.models.forecast.sarima module</a></li>
<li class="toctree-l6"><a class="reference internal" href="#module-merlion.models.forecast.prophet">merlion.models.forecast.prophet module</a></li>
<li class="toctree-l6"><a class="reference internal" href="#module-merlion.models.forecast.smoother">merlion.models.forecast.smoother module</a></li>
<li class="toctree-l6"><a class="reference internal" href="#module-merlion.models.forecast.vector_ar">merlion.models.forecast.vector_ar module</a></li>
<li class="toctree-l6"><a class="reference internal" href="#module-merlion.models.forecast.baggingtrees">merlion.models.forecast.baggingtrees module</a></li>
<li class="toctree-l6"><a class="reference internal" href="#module-merlion.models.forecast.boostingtrees">merlion.models.forecast.bo0stingtrees module</a></li>
<li class="toctree-l6"><a class="reference internal" href="#module-merlion.models.forecast.lstm">merlion.models.forecast.lstm module</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="merlion.models.ensemble.html">merlion.models.ensemble package</a></li>
<li class="toctree-l5"><a class="reference internal" href="merlion.models.automl.html">merlion.models.automl package</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="merlion.models.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="merlion.models.html#module-merlion.models.base">merlion.models.base module</a></li>
<li class="toctree-l4"><a class="reference internal" href="merlion.models.html#module-merlion.models.factory">merlion.models.factory module</a></li>
<li class="toctree-l4"><a class="reference internal" href="merlion.models.html#module-merlion.models.defaults">merlion.models.defaults module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="merlion.transform.html">merlion.transform package</a></li>
<li class="toctree-l3"><a class="reference internal" href="merlion.post_process.html">merlion.post_process package</a></li>
<li class="toctree-l3"><a class="reference internal" href="merlion.evaluate.html">merlion.evaluate package</a></li>
<li class="toctree-l3"><a class="reference internal" href="merlion.utils.html">merlion.utils package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="merlion.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="merlion.html#module-merlion.plot">merlion.plot module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ts_datasets.html">ts_datasets: Easy Data Loading</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials &amp; Example Code</a></li>
</ul>
</div>
</div>
</nav>
<section class="wy-nav-content-wrap" data-toggle="wy-nav-shift"><nav aria-label="Mobile navigation menu" class="wy-nav-top">
<i class="fa fa-bars" data-toggle="wy-nav-top"></i>
<a href="index.html">Merlion</a>
</nav>
<div class="wy-nav-content">
<div class="rst-content">
<div aria-label="Page navigation" role="navigation">
<ul class="wy-breadcrumbs">
<li><a class="icon icon-home" href="index.html"></a> »</li>
<li><a href="merlion.html">merlion: Time Series Intelligence</a> »</li>
<li><a href="merlion.models.html">merlion.models package</a> »</li>
<li>merlion.models.forecast package</li>
<li class="wy-breadcrumbs-aside">
<a href="_sources/merlion.models.forecast.rst.txt" rel="nofollow"> View page source</a>
</li>
</ul>
<hr/>
</div>
<div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<div itemprop="articleBody">
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="module-merlion.models.forecast">
<span id="merlion-models-forecast-package"></span><h1>merlion.models.forecast package<a class="headerlink" href="#module-merlion.models.forecast" title="Permalink to this heading"></a></h1>
<p>Contains all forecasting models.</p>
<p>For forecasting, we define an abstract base <a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase" title="merlion.models.forecast.base.ForecasterBase"><code class="xref any py py-class docutils literal notranslate"><span class="pre">ForecasterBase</span></code></a> class which inherits from <a class="reference internal" href="merlion.models.html#merlion.models.base.ModelBase" title="merlion.models.base.ModelBase"><code class="xref any py py-class docutils literal notranslate"><span class="pre">ModelBase</span></code></a> and supports the
following interface, in addition to <code class="docutils literal notranslate"><span class="pre">model.save()</span></code> and <code class="docutils literal notranslate"><span class="pre">ForecasterClass.load</span></code> defined for <code class="docutils literal notranslate"><span class="pre">ModelBase</span></code>:</p>
<ol class="arabic">
<li><p><code class="docutils literal notranslate"><span class="pre">model</span> <span class="pre">=</span> <span class="pre">ForecasterClass(config)</span></code></p>
<blockquote>
<div><ul class="simple">
<li><p>initialization with a model-specific config (which inherits from <a class="reference internal" href="#merlion.models.forecast.base.ForecasterConfig" title="merlion.models.forecast.base.ForecasterConfig"><code class="xref any py py-class docutils literal notranslate"><span class="pre">ForecasterConfig</span></code></a>)</p></li>
<li><p>configs contain:</p>
<ul>
<li><p>a (potentially trainable) data pre-processing transform from <a class="reference internal" href="merlion.transform.html#module-merlion.transform" title="merlion.transform"><code class="xref py py-mod docutils literal notranslate"><span class="pre">merlion.transform</span></code></a>;
note that <code class="docutils literal notranslate"><span class="pre">model.transform</span></code> is a property which refers to <code class="docutils literal notranslate"><span class="pre">model.config.transform</span></code></p></li>
<li><p>model-specific hyperparameters</p></li>
<li><p><strong>optionally, a maximum number of steps the model can forecast for</strong></p></li>
</ul>
</li>
</ul>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">model.forecast(time_stamps,</span> <span class="pre">time_series_prev=None)</span></code></p>
<blockquote>
<div><ul class="simple">
<li><p>returns the forecast (<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref any py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>) for future values at the time stamps specified by <code class="docutils literal notranslate"><span class="pre">time_stamps</span></code>,
as well as the standard error of that forecast (<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref any py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, may be <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p>if <code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code> is specified, it is used as the most recent context. Otherwise, the training data is used</p></li>
</ul>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">model.train(train_data,</span> <span class="pre">train_config=None)</span></code></p>
<ul class="simple">
<li><p>trains the model on the <a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref any py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a> <code class="docutils literal notranslate"><span class="pre">train_data</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">train_config</span></code> (optional): extra configuration describing how the model should be trained (e.g. learning rate
for <a class="reference internal" href="#merlion.models.forecast.lstm.LSTM" title="merlion.models.forecast.lstm.LSTM"><code class="xref any py py-class docutils literal notranslate"><span class="pre">LSTM</span></code></a>). Not used for all models. Class-level default provided for models which do use it.</p></li>
<li><p>returns the model’s prediction <code class="docutils literal notranslate"><span class="pre">train_data</span></code>, in the same format as if you called <a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase.forecast" title="merlion.models.forecast.base.ForecasterBase.forecast"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">ForecasterBase.forecast</span></code></a>
on the time stamps of <code class="docutils literal notranslate"><span class="pre">train_data</span></code></p></li>
</ul>
</li>
</ol>
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%"/>
<col style="width: 90%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-merlion.models.forecast.base" title="merlion.models.forecast.base"><code class="xref py py-obj docutils literal notranslate"><span class="pre">base</span></code></a></p></td>
<td><p>Base class for forecasting models.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#module-merlion.models.forecast.arima" title="merlion.models.forecast.arima"><code class="xref py py-obj docutils literal notranslate"><span class="pre">arima</span></code></a></p></td>
<td><p>The classic statistical forecasting model ARIMA (AutoRegressive Integrated Moving Average).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-merlion.models.forecast.sarima" title="merlion.models.forecast.sarima"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sarima</span></code></a></p></td>
<td><p>A variant of ARIMA with a user-specified Seasonality.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#module-merlion.models.forecast.prophet" title="merlion.models.forecast.prophet"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prophet</span></code></a></p></td>
<td><p>Wrapper around Facebook's popular Prophet model for time series forecasting.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-merlion.models.forecast.smoother" title="merlion.models.forecast.smoother"><code class="xref py py-obj docutils literal notranslate"><span class="pre">smoother</span></code></a></p></td>
<td><p>Multi-Scale Exponential Smoother for univariate time series forecasting.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#module-merlion.models.forecast.vector_ar" title="merlion.models.forecast.vector_ar"><code class="xref py py-obj docutils literal notranslate"><span class="pre">vector_ar</span></code></a></p></td>
<td><p>Vector AutoRegressive model for multivariate time series forecasting.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-merlion.models.forecast.baggingtrees" title="merlion.models.forecast.baggingtrees"><code class="xref py py-obj docutils literal notranslate"><span class="pre">baggingtrees</span></code></a></p></td>
<td><p>Bagging Tree-based models for multivariate time series forecasting.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#module-merlion.models.forecast.boostingtrees" title="merlion.models.forecast.boostingtrees"><code class="xref py py-obj docutils literal notranslate"><span class="pre">boostingtrees</span></code></a></p></td>
<td><p>Boosting Tree-based models for multivariate time series forecasting.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-merlion.models.forecast.lstm" title="merlion.models.forecast.lstm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lstm</span></code></a></p></td>
<td><p>A forecaster based on a LSTM neural net.</p></td>
</tr>
</tbody>
</table>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-merlion.models.forecast.base">
<span id="merlion-models-forecast-base-module"></span><h2>merlion.models.forecast.base module<a class="headerlink" href="#module-merlion.models.forecast.base" title="Permalink to this heading"></a></h2>
<p>Base class for forecasting models.</p>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.base.</span></span><span class="sig-name descname"><span class="pre">ForecasterConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_forecast_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_seq_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterConfig" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="merlion.models.html#merlion.models.base.Config" title="merlion.models.base.Config"><code class="xref py py-class docutils literal notranslate"><span class="pre">Config</span></code></a></p>
<p>Config object used to define a forecaster model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_forecast_steps</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – Max # of steps we would like to forecast for.
Required for some models which pre-compute a forecast, like ARIMA,
SARIMA, and LSTM.</p></li>
<li><p><strong>target_seq_index</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – The index of the univariate (amongst all
univariates in a general multivariate time series) whose value we
would like to forecast.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterConfig.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_unused_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterConfig.from_dict" title="Permalink to this definition"></a></dt>
<dd><p>Constructs a <a class="reference internal" href="merlion.models.html#merlion.models.base.Config" title="merlion.models.base.Config"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Config</span></code></a> from a Python dictionary of parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config_dict</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]) – dict that will be used to instantiate this object.</p></li>
<li><p><strong>return_unused_kwargs</strong> – whether to return any unused keyword args.</p></li>
<li><p><strong>kwargs</strong> – any additional parameters to set (overriding config_dict).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="merlion.models.html#merlion.models.base.Config" title="merlion.models.base.Config"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Config</span></code></a> object initialized from the dict.</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.base.</span></span><span class="sig-name descname"><span class="pre">ForecasterBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterBase" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="merlion.models.html#merlion.models.base.ModelBase" title="merlion.models.base.ModelBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelBase</span></code></a></p>
<p>Base class for a forecaster model.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If your model depends on an evenly spaced time series, make sure to</p>
<ol class="arabic simple">
<li><p>Call <a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase.train_pre_process" title="merlion.models.forecast.base.ForecasterBase.train_pre_process"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">ForecasterBase.train_pre_process</span></code></a> in <a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase.train" title="merlion.models.forecast.base.ForecasterBase.train"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">ForecasterBase.train</span></code></a></p></li>
<li><p>Call <a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase.resample_time_stamps" title="merlion.models.forecast.base.ForecasterBase.resample_time_stamps"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">ForecasterBase.resample_time_stamps</span></code></a> at the start of
<a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase.forecast" title="merlion.models.forecast.base.ForecasterBase.forecast"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">ForecasterBase.forecast</span></code></a> to get a set of resampled time stamps, and
call <code class="docutils literal notranslate"><span class="pre">time_series.align(reference=time_stamps)</span></code> to align the forecast
with the original time stamps.</p></li>
</ol>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterBase.config_class">
<span class="sig-name descname"><span class="pre">config_class</span></span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterBase.config_class" title="Permalink to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#merlion.models.forecast.base.ForecasterConfig" title="merlion.models.forecast.base.ForecasterConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForecasterConfig</span></code></a></p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterBase.max_forecast_steps">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">max_forecast_steps</span></span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterBase.max_forecast_steps" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterBase.target_seq_index">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">target_seq_index</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#merlion.models.forecast.base.ForecasterBase.target_seq_index" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the index of the univariate (amongst all univariates in a
general multivariate time series) whose value we would like to forecast.</p>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterBase.dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dim</span></span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterBase.dim" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterBase.resample_time_stamps">
<span class="sig-name descname"><span class="pre">resample_time_stamps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_stamps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_series_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterBase.resample_time_stamps" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterBase.train_pre_process">
<span class="sig-name descname"><span class="pre">train_pre_process</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">require_even_sampling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">require_univariate</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterBase.train_pre_process" title="Permalink to this definition"></a></dt>
<dd><p>Applies pre-processing steps common for training most models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_data</strong> (<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>) – the original time series of training data</p></li>
<li><p><strong>require_even_sampling</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether the model assumes that training
data is sampled at a fixed frequency</p></li>
<li><p><strong>require_univariate</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether the model only works with univariate
time series</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the training data, after any necessary pre-processing has been applied</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterBase.train">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterBase.train" title="Permalink to this definition"></a></dt>
<dd><p>Trains the forecaster on the input time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_data</strong> (<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>) – a <a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref any py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a> of metric values to train the model.</p></li>
<li><p><strong>train_config</strong> – Additional training configs, if needed. Only
required for some models.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the model’s prediction on <code class="docutils literal notranslate"><span class="pre">train_data</span></code>, in the same format as
if you called <a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase.forecast" title="merlion.models.forecast.base.ForecasterBase.forecast"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">ForecasterBase.forecast</span></code></a> on the time stamps of
<code class="docutils literal notranslate"><span class="pre">train_data</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterBase.forecast">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_stamps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_series_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_iqr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterBase.forecast" title="Permalink to this definition"></a></dt>
<dd><p>Returns the model’s forecast on the timestamps given. Note that if
<code class="docutils literal notranslate"><span class="pre">self.transform</span></code> is specified in the config, the forecast is a forecast
of transformed values! It is up to you to manually invert the transform
if desired.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_stamps</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – Either a <code class="docutils literal notranslate"><span class="pre">list</span></code> of timestamps we wish to forecast for,
or the number of steps (<code class="docutils literal notranslate"><span class="pre">int</span></code>) we wish to forecast for.</p></li>
<li><p><strong>time_series_prev</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]) – a list of (timestamp, value) pairs immediately
preceding <code class="docutils literal notranslate"><span class="pre">time_series</span></code>. If given, we use it to initialize the time
series model. Otherwise, we assume that <code class="docutils literal notranslate"><span class="pre">time_series</span></code> immediately
follows the training data.</p></li>
<li><p><strong>return_iqr</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to return the inter-quartile range for the
forecast. Note that not all models support this option.</p></li>
<li><p><strong>return_prev</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to return the forecast for
<code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code> (and its stderr or IQR if relevant), in addition
to the forecast for <code class="docutils literal notranslate"><span class="pre">time_stamps</span></code>. Only used if <code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code>
is provided.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]], <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p><code class="docutils literal notranslate"><span class="pre">(forecast,</span> <span class="pre">forecast_stderr)</span></code> if <code class="docutils literal notranslate"><span class="pre">return_iqr</span></code> is false,
<code class="docutils literal notranslate"><span class="pre">(forecast,</span> <span class="pre">forecast_lb,</span> <span class="pre">forecast_ub)</span></code> otherwise.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">forecast</span></code>: the forecast for the timestamps given</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">forecast_stderr</span></code>: the standard error of each forecast value.</dt><dd><p>May be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">forecast_lb</span></code>: 25th percentile of forecast values for each timestamp</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">forecast_ub</span></code>: 75th percentile of forecast values for each timestamp</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterBase.batch_forecast">
<span class="sig-name descname"><span class="pre">batch_forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_stamps_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_series_prev_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_iqr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterBase.batch_forecast" title="Permalink to this definition"></a></dt>
<dd><p>Returns the model’s forecast on a batch of timestamps given. Note that if
<code class="docutils literal notranslate"><span class="pre">self.transform</span></code> is specified in the config, the forecast is a forecast
of transformed values! It is up to you to manually invert the transform
if desired.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_stamps_list</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – a list of lists of timestamps we wish to forecast for</p></li>
<li><p><strong>time_series_prev_list</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]) – a list of TimeSeries immediately preceding the time stamps in time_stamps_list</p></li>
<li><p><strong>return_iqr</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to return the inter-quartile range for the
forecast. Note that not all models support this option.</p></li>
<li><p><strong>return_prev</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to return the forecast for
<code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code> (and its stderr or IQR if relevant), in addition
to the forecast for <code class="docutils literal notranslate"><span class="pre">time_stamps</span></code>. Only used if <code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code>
is provided.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]], <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]]]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p><code class="docutils literal notranslate"><span class="pre">(forecast,</span> <span class="pre">forecast_stderr)</span></code> if <code class="docutils literal notranslate"><span class="pre">return_iqr</span></code> is false,
<code class="docutils literal notranslate"><span class="pre">(forecast,</span> <span class="pre">forecast_lb,</span> <span class="pre">forecast_ub)</span></code> otherwise.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">forecast</span></code>: the forecast for the timestamps given</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">forecast_stderr</span></code>: the standard error of each forecast value.</dt><dd><p>May be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">forecast_lb</span></code>: 25th percentile of forecast values for each timestamp</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">forecast_ub</span></code>: 75th percentile of forecast values for each timestamp</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterBase.invert_transform">
<span class="sig-name descname"><span class="pre">invert_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forecast</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_series_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterBase.invert_transform" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterBase.get_figure">
<span class="sig-name descname"><span class="pre">get_figure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_series</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_stamps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_series_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_forecast_uncertainty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_time_series_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterBase.get_figure" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_series</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]) – the time series over whose timestamps we wish to
make a forecast. Exactly one of <code class="docutils literal notranslate"><span class="pre">time_series</span></code> or <code class="docutils literal notranslate"><span class="pre">time_stamps</span></code>
should be provided.</p></li>
<li><p><strong>time_stamps</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – a list of timestamps we wish to forecast for. Exactly
one of <code class="docutils literal notranslate"><span class="pre">time_series</span></code> or <code class="docutils literal notranslate"><span class="pre">time_stamps</span></code> should be provided.</p></li>
<li><p><strong>time_series_prev</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]) – a <a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref any py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a> immediately preceding
<code class="docutils literal notranslate"><span class="pre">time_stamps</span></code>. If given, we use it to initialize the time series
model. Otherwise, we assume that <code class="docutils literal notranslate"><span class="pre">time_stamps</span></code> immediately follows
the training data.</p></li>
<li><p><strong>plot_forecast_uncertainty</strong> – whether to plot uncertainty estimates (the
inter-quartile range) for forecast values. Not supported for all
models.</p></li>
<li><p><strong>plot_time_series_prev</strong> – whether to plot <code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code> (and
the model’s fit for it). Only used if <code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code> is given.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="merlion.html#merlion.plot.Figure" title="merlion.plot.Figure"><code class="xref py py-class docutils literal notranslate"><span class="pre">Figure</span></code></a></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a <a class="reference internal" href="merlion.html#merlion.plot.Figure" title="merlion.plot.Figure"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Figure</span></code></a> of the model’s forecast.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterBase.plot_forecast">
<span class="sig-name descname"><span class="pre">plot_forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_series</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_stamps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_series_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_forecast_uncertainty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_time_series_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1000,</span> <span class="pre">600)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterBase.plot_forecast" title="Permalink to this definition"></a></dt>
<dd><p>Plots the forecast for the time series in matplotlib, optionally also
plotting the uncertainty of the forecast, as well as the past values
(both true and predicted) of the time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_series</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]) – the time series over whose timestamps we wish to
make a forecast. Exactly one of <code class="docutils literal notranslate"><span class="pre">time_series</span></code> or <code class="docutils literal notranslate"><span class="pre">time_stamps</span></code>
should be provided.</p></li>
<li><p><strong>time_stamps</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – a list of timestamps we wish to forecast for. Exactly
one of <code class="docutils literal notranslate"><span class="pre">time_series</span></code> or <code class="docutils literal notranslate"><span class="pre">time_stamps</span></code> should be provided.</p></li>
<li><p><strong>time_series_prev</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]) – a <a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref any py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a> immediately preceding
<code class="docutils literal notranslate"><span class="pre">time_stamps</span></code>. If given, we use it to initialize the time series
model. Otherwise, we assume that <code class="docutils literal notranslate"><span class="pre">time_stamps</span></code> immediately follows
the training data.</p></li>
<li><p><strong>plot_forecast_uncertainty</strong> – whether to plot uncertainty estimates (the
inter-quartile range) for forecast values. Not supported for all
models.</p></li>
<li><p><strong>plot_time_series_prev</strong> – whether to plot <code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code> (and
the model’s fit for it). Only used if <code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code> is given.</p></li>
<li><p><strong>figsize</strong> – figure size in pixels</p></li>
<li><p><strong>ax</strong> – matplotlib axis to add this plot to</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(fig, ax): matplotlib figure &amp; axes the figure was plotted on</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.base.ForecasterBase.plot_forecast_plotly">
<span class="sig-name descname"><span class="pre">plot_forecast_plotly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_series</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_stamps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_series_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_forecast_uncertainty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_time_series_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1000,</span> <span class="pre">600)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.base.ForecasterBase.plot_forecast_plotly" title="Permalink to this definition"></a></dt>
<dd><p>Plots the forecast for the time series in plotly, optionally also
plotting the uncertainty of the forecast, as well as the past values
(both true and predicted) of the time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_series</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]) – the time series over whose timestamps we wish to
make a forecast. Exactly one of <code class="docutils literal notranslate"><span class="pre">time_series</span></code> or <code class="docutils literal notranslate"><span class="pre">time_stamps</span></code>
should be provided.</p></li>
<li><p><strong>time_stamps</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – a list of timestamps we wish to forecast for. Exactly
one of <code class="docutils literal notranslate"><span class="pre">time_series</span></code> or <code class="docutils literal notranslate"><span class="pre">time_stamps</span></code> should be provided.</p></li>
<li><p><strong>time_series_prev</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]) – a <a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref any py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a> immediately preceding
<code class="docutils literal notranslate"><span class="pre">time_stamps</span></code>. If given, we use it to initialize the time series
model. Otherwise, we assume that <code class="docutils literal notranslate"><span class="pre">time_stamps</span></code> immediately follows
the training data.</p></li>
<li><p><strong>plot_forecast_uncertainty</strong> – whether to plot uncertainty estimates (the
inter-quartile range) for forecast values. Not supported for all
models.</p></li>
<li><p><strong>plot_time_series_prev</strong> – whether to plot <code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code> (and
the model’s fit for it). Only used if <code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code> is given.</p></li>
<li><p><strong>figsize</strong> – figure size in pixels</p></li>
</ul>
</dd>
</dl>
</dd></dl>
</dd></dl>
</section>
<section id="module-merlion.models.forecast.arima">
<span id="merlion-models-forecast-arima-module"></span><h2>merlion.models.forecast.arima module<a class="headerlink" href="#module-merlion.models.forecast.arima" title="Permalink to this heading"></a></h2>
<p>The classic statistical forecasting model ARIMA (AutoRegressive Integrated
Moving Average).</p>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.arima.ArimaConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.arima.</span></span><span class="sig-name descname"><span class="pre">ArimaConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_forecast_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_seq_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(4,</span> <span class="pre">1,</span> <span class="pre">2)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.arima.ArimaConfig" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.sarima.SarimaConfig" title="merlion.models.forecast.sarima.SarimaConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">SarimaConfig</span></code></a></p>
<p>Config object used to define a forecaster model.</p>
<p>Configuration class for Arima. Just a Sarima model with seasonal order
(0, 0, 0, 0).</p>
<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.arima.ArimaConfig.seasonal_order">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">seasonal_order</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#merlion.models.forecast.arima.ArimaConfig.seasonal_order" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(0, 0, 0, 0) because ARIMA has no seasonal order.</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.arima.Arima">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.arima.</span></span><span class="sig-name descname"><span class="pre">Arima</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.arima.Arima" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.sarima.Sarima" title="merlion.models.forecast.sarima.Sarima"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sarima</span></code></a></p>
<p>Implementation of the classic statistical model ARIMA (AutoRegressive
Integrated Moving Average) for forecasting.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.arima.Arima.config_class">
<span class="sig-name descname"><span class="pre">config_class</span></span><a class="headerlink" href="#merlion.models.forecast.arima.Arima.config_class" title="Permalink to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#merlion.models.forecast.arima.ArimaConfig" title="merlion.models.forecast.arima.ArimaConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ArimaConfig</span></code></a></p>
</dd></dl>
</dd></dl>
</section>
<section id="module-merlion.models.forecast.sarima">
<span id="merlion-models-forecast-sarima-module"></span><h2>merlion.models.forecast.sarima module<a class="headerlink" href="#module-merlion.models.forecast.sarima" title="Permalink to this heading"></a></h2>
<p>A variant of ARIMA with a user-specified Seasonality.</p>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.sarima.SarimaConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.sarima.</span></span><span class="sig-name descname"><span class="pre">SarimaConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_forecast_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_seq_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(4,</span> <span class="pre">1,</span> <span class="pre">2)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seasonal_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(2,</span> <span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">24)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.sarima.SarimaConfig" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.base.ForecasterConfig" title="merlion.models.forecast.base.ForecasterConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForecasterConfig</span></code></a></p>
<p>Config object used to define a forecaster model.</p>
<p>Configuration class for Sarima.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_forecast_steps</strong> – Number of steps we would like to forecast for.</p></li>
<li><p><strong>target_seq_index</strong> – The index of the univariate (amongst all
univariates in a general multivariate time series) whose value we
would like to forecast.</p></li>
<li><p><strong>order</strong> – Order is (p, d, q) for an ARIMA(p, d, q) process. d must
be an integer indicating the integration order of the process, while
p and q must be integers indicating the AR and MA orders (so that
all lags up to those orders are included).</p></li>
<li><p><strong>seasonal_order</strong> – Seasonal order is (P, D, Q, S) for seasonal ARIMA
process, where s is the length of the seasonality cycle (e.g. s=24
for 24 hours on hourly granularity). P, D, Q are as for ARIMA.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.sarima.Sarima">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.sarima.</span></span><span class="sig-name descname"><span class="pre">Sarima</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.sarima.Sarima" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase" title="merlion.models.forecast.base.ForecasterBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForecasterBase</span></code></a>, <a class="reference internal" href="merlion.models.automl.html#merlion.models.automl.seasonality_mixin.SeasonalityModel" title="merlion.models.automl.seasonality_mixin.SeasonalityModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeasonalityModel</span></code></a></p>
<p>Implementation of the classic statistical model SARIMA (Seasonal
AutoRegressive Integrated Moving Average) for forecasting.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.sarima.Sarima.config_class">
<span class="sig-name descname"><span class="pre">config_class</span></span><a class="headerlink" href="#merlion.models.forecast.sarima.Sarima.config_class" title="Permalink to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#merlion.models.forecast.sarima.SarimaConfig" title="merlion.models.forecast.sarima.SarimaConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">SarimaConfig</span></code></a></p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.sarima.Sarima.order">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">order</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#merlion.models.forecast.sarima.Sarima.order" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the order (p, d, q) of the model, where p is the AR order,
d is the integration order, and q is the MA order.</p>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.sarima.Sarima.seasonal_order">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">seasonal_order</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#merlion.models.forecast.sarima.Sarima.seasonal_order" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the seasonal order (P, D, Q, S) for the seasonal ARIMA
process, where p is the AR order, D is the integration order,
Q is the MA order, and S is the length of the seasonality cycle.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.sarima.Sarima.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.sarima.Sarima.train" title="Permalink to this definition"></a></dt>
<dd><p>Trains the forecaster on the input time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_data</strong> (<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>) – a <a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref any py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a> of metric values to train the model.</p></li>
<li><p><strong>train_config</strong> – Additional training configs, if needed. Only
required for some models.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the model’s prediction on <code class="docutils literal notranslate"><span class="pre">train_data</span></code>, in the same format as
if you called <a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase.forecast" title="merlion.models.forecast.base.ForecasterBase.forecast"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">ForecasterBase.forecast</span></code></a> on the time stamps of
<code class="docutils literal notranslate"><span class="pre">train_data</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.sarima.Sarima.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_stamps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_series_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_iqr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.sarima.Sarima.forecast" title="Permalink to this definition"></a></dt>
<dd><p>Returns the model’s forecast on the timestamps given. Note that if
<code class="docutils literal notranslate"><span class="pre">self.transform</span></code> is specified in the config, the forecast is a forecast
of transformed values! It is up to you to manually invert the transform
if desired.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_stamps</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – Either a <code class="docutils literal notranslate"><span class="pre">list</span></code> of timestamps we wish to forecast for,
or the number of steps (<code class="docutils literal notranslate"><span class="pre">int</span></code>) we wish to forecast for.</p></li>
<li><p><strong>time_series_prev</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]) – a list of (timestamp, value) pairs immediately
preceding <code class="docutils literal notranslate"><span class="pre">time_series</span></code>. If given, we use it to initialize the time
series model. Otherwise, we assume that <code class="docutils literal notranslate"><span class="pre">time_series</span></code> immediately
follows the training data.</p></li>
<li><p><strong>return_iqr</strong> – whether to return the inter-quartile range for the
forecast. Note that not all models support this option.</p></li>
<li><p><strong>return_prev</strong> – whether to return the forecast for
<code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code> (and its stderr or IQR if relevant), in addition
to the forecast for <code class="docutils literal notranslate"><span class="pre">time_stamps</span></code>. Only used if <code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code>
is provided.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p><code class="docutils literal notranslate"><span class="pre">(forecast,</span> <span class="pre">forecast_stderr)</span></code> if <code class="docutils literal notranslate"><span class="pre">return_iqr</span></code> is false,
<code class="docutils literal notranslate"><span class="pre">(forecast,</span> <span class="pre">forecast_lb,</span> <span class="pre">forecast_ub)</span></code> otherwise.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">forecast</span></code>: the forecast for the timestamps given</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">forecast_stderr</span></code>: the standard error of each forecast value.</dt><dd><p>May be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">forecast_lb</span></code>: 25th percentile of forecast values for each timestamp</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">forecast_ub</span></code>: 75th percentile of forecast values for each timestamp</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.sarima.Sarima.set_seasonality">
<span class="sig-name descname"><span class="pre">set_seasonality</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.sarima.Sarima.set_seasonality" title="Permalink to this definition"></a></dt>
<dd><p>Implement this method to do any model-specific adjustments on the seasonality that was provided by
<a class="reference internal" href="merlion.models.automl.html#merlion.models.automl.seasonality_mixin.SeasonalityLayer" title="merlion.models.automl.seasonality_mixin.SeasonalityLayer"><code class="xref any py py-class docutils literal notranslate"><span class="pre">SeasonalityLayer</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> – Seasonality processed by <a class="reference internal" href="merlion.models.automl.html#merlion.models.automl.seasonality_mixin.SeasonalityLayer" title="merlion.models.automl.seasonality_mixin.SeasonalityLayer"><code class="xref any py py-class docutils literal notranslate"><span class="pre">SeasonalityLayer</span></code></a>.</p></li>
<li><p><strong>train_data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">array</span></code>) – Training data (or numpy array representing the target univariate)
for any model-specific adjustments you might want to make.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
</dd></dl>
</section>
<section id="module-merlion.models.forecast.prophet">
<span id="merlion-models-forecast-prophet-module"></span><h2>merlion.models.forecast.prophet module<a class="headerlink" href="#module-merlion.models.forecast.prophet" title="Permalink to this heading"></a></h2>
<p>Wrapper around Facebook’s popular Prophet model for time series forecasting.</p>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.prophet.ProphetConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.prophet.</span></span><span class="sig-name descname"><span class="pre">ProphetConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_forecast_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_seq_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yearly_seasonality</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weekly_seasonality</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">daily_seasonality</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_seasonality</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uncertainty_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.prophet.ProphetConfig" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.base.ForecasterConfig" title="merlion.models.forecast.base.ForecasterConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForecasterConfig</span></code></a></p>
<p>Config object used to define a forecaster model.</p>
<p>Configuration class for Facebook’s Prophet model, as described in this
<a class="reference external" href="https://peerj.com/preprints/3190/">paper</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_forecast_steps</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – Max # of steps we would like to forecast for.</p></li>
<li><p><strong>target_seq_index</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – The index of the univariate (amongst all
univariates in a general multivariate time series) whose value we
would like to forecast.</p></li>
<li><p><strong>yearly_seasonality</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – If bool, whether to enable yearly seasonality.
By default, it is activated if there are &gt;= 2 years of history, but
deactivated otherwise. If int, this is the number of Fourier series
components used to model the seasonality (default = 10).</p></li>
<li><p><strong>weekly_seasonality</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – If bool, whether to enable weekly seasonality.
By default, it is activated if there are &gt;= 2 weeks of history, but
deactivated otherwise. If int, this is the number of Fourier series
components used to model the seasonality (default = 3).</p></li>
<li><p><strong>daily_seasonality</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – If bool, whether to enable daily seasonality.
By default, it is activated if there are &gt;= 2 days of history, but
deactivated otherwise. If int, this is the number of Fourier series
components used to model the seasonality (default = 4).</p></li>
<li><p><strong>add_seasonality</strong> – ‘auto’ indicates automatically adding extra
seasonaltiy by detection methods (default = None).</p></li>
<li><p><strong>uncertainty_samples</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of posterior samples to draw in
order to calibrate the anomaly scores.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.prophet.Prophet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.prophet.</span></span><span class="sig-name descname"><span class="pre">Prophet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.prophet.Prophet" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase" title="merlion.models.forecast.base.ForecasterBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForecasterBase</span></code></a></p>
<p>Facebook’s model for time series forecasting. See docs for <a class="reference internal" href="#merlion.models.forecast.prophet.ProphetConfig" title="merlion.models.forecast.prophet.ProphetConfig"><code class="xref any py py-class docutils literal notranslate"><span class="pre">ProphetConfig</span></code></a>
and the <a class="reference external" href="https://peerj.com/preprints/3190/">paper</a> for more details.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.prophet.Prophet.config_class">
<span class="sig-name descname"><span class="pre">config_class</span></span><a class="headerlink" href="#merlion.models.forecast.prophet.Prophet.config_class" title="Permalink to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#merlion.models.forecast.prophet.ProphetConfig" title="merlion.models.forecast.prophet.ProphetConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProphetConfig</span></code></a></p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.prophet.Prophet.yearly_seasonality">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">yearly_seasonality</span></span><a class="headerlink" href="#merlion.models.forecast.prophet.Prophet.yearly_seasonality" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.prophet.Prophet.weekly_seasonality">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">weekly_seasonality</span></span><a class="headerlink" href="#merlion.models.forecast.prophet.Prophet.weekly_seasonality" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.prophet.Prophet.daily_seasonality">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">daily_seasonality</span></span><a class="headerlink" href="#merlion.models.forecast.prophet.Prophet.daily_seasonality" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.prophet.Prophet.add_seasonality">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">add_seasonality</span></span><a class="headerlink" href="#merlion.models.forecast.prophet.Prophet.add_seasonality" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.prophet.Prophet.uncertainty_samples">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">uncertainty_samples</span></span><a class="headerlink" href="#merlion.models.forecast.prophet.Prophet.uncertainty_samples" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.prophet.Prophet.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.prophet.Prophet.train" title="Permalink to this definition"></a></dt>
<dd><p>Trains the forecaster on the input time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_data</strong> (<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>) – a <a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref any py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a> of metric values to train the model.</p></li>
<li><p><strong>train_config</strong> – Additional training configs, if needed. Only
required for some models.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the model’s prediction on <code class="docutils literal notranslate"><span class="pre">train_data</span></code>, in the same format as
if you called <a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase.forecast" title="merlion.models.forecast.base.ForecasterBase.forecast"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">ForecasterBase.forecast</span></code></a> on the time stamps of
<code class="docutils literal notranslate"><span class="pre">train_data</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.prophet.Prophet.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_stamps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_series_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_iqr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.prophet.Prophet.forecast" title="Permalink to this definition"></a></dt>
<dd><p>Returns the model’s forecast on the timestamps given. Note that if
<code class="docutils literal notranslate"><span class="pre">self.transform</span></code> is specified in the config, the forecast is a forecast
of transformed values! It is up to you to manually invert the transform
if desired.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_stamps</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – Either a <code class="docutils literal notranslate"><span class="pre">list</span></code> of timestamps we wish to forecast for,
or the number of steps (<code class="docutils literal notranslate"><span class="pre">int</span></code>) we wish to forecast for.</p></li>
<li><p><strong>time_series_prev</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]) – a list of (timestamp, value) pairs immediately
preceding <code class="docutils literal notranslate"><span class="pre">time_series</span></code>. If given, we use it to initialize the time
series model. Otherwise, we assume that <code class="docutils literal notranslate"><span class="pre">time_series</span></code> immediately
follows the training data.</p></li>
<li><p><strong>return_iqr</strong> – whether to return the inter-quartile range for the
forecast. Note that not all models support this option.</p></li>
<li><p><strong>return_prev</strong> – whether to return the forecast for
<code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code> (and its stderr or IQR if relevant), in addition
to the forecast for <code class="docutils literal notranslate"><span class="pre">time_stamps</span></code>. Only used if <code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code>
is provided.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p><code class="docutils literal notranslate"><span class="pre">(forecast,</span> <span class="pre">forecast_stderr)</span></code> if <code class="docutils literal notranslate"><span class="pre">return_iqr</span></code> is false,
<code class="docutils literal notranslate"><span class="pre">(forecast,</span> <span class="pre">forecast_lb,</span> <span class="pre">forecast_ub)</span></code> otherwise.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">forecast</span></code>: the forecast for the timestamps given</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">forecast_stderr</span></code>: the standard error of each forecast value.</dt><dd><p>May be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">forecast_lb</span></code>: 25th percentile of forecast values for each timestamp</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">forecast_ub</span></code>: 75th percentile of forecast values for each timestamp</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
</section>
<section id="module-merlion.models.forecast.smoother">
<span id="merlion-models-forecast-smoother-module"></span><h2>merlion.models.forecast.smoother module<a class="headerlink" href="#module-merlion.models.forecast.smoother" title="Permalink to this heading"></a></h2>
<p>Multi-Scale Exponential Smoother for univariate time series forecasting.</p>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.MSESConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.smoother.</span></span><span class="sig-name descname"><span class="pre">MSESConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_forecast_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_seq_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_backstep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recency_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accel_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimize_acc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inflation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.MSESConfig" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.base.ForecasterConfig" title="merlion.models.forecast.base.ForecasterConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForecasterConfig</span></code></a></p>
<p>Configuration class for an MSES forecasting model.</p>
<p>Letting <code class="docutils literal notranslate"><span class="pre">w</span></code> be the recency weight, <code class="docutils literal notranslate"><span class="pre">B</span></code> the maximum backstep, <code class="docutils literal notranslate"><span class="pre">x_t</span></code> the last seen data point,
and <code class="docutils literal notranslate"><span class="pre">l_s,t</span></code> the series of losses for scale <code class="docutils literal notranslate"><span class="pre">s</span></code>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
\hat{x}_{t+h} &amp; = \sum_{b=0}^B p_{b} \cdot (x_{t-b} + v_{b+h,t} + a_{b+h,t}) \\
\space \\
\text{where} \space\space &amp; v_{b+h,t} = \text{EMA}_w(\Delta_{b+h} x_t)   \\
&amp; a_{b+h,t} = \text{EMA}_w(\Delta_{b+h}^2 x_t) \\
\text{and} \space\space &amp; p_b = \sigma(z)_b \space\space \\
\text{if} &amp; \space\space  z_b = (b+h)^\phi \cdot \text{EMA}_w(l_{b+h,t}) \cdot \text{RWSE}_w(l_{b+h,t})\\
\end{align*}\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_forecast_steps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Max number of steps to forecast ahead.</p></li>
<li><p><strong>target_seq_index</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – The index of the univariate (amongst all
univariates in a general multivariate time series) whose value we
would like to forecast.</p></li>
<li><p><strong>max_backstep</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – Max backstep to use in forecasting. If we train with x(0),…,x(t),
Then, the b-th model MSES uses will forecast x(t+h) by anchoring at x(t-b) and 
predicting xhat(t+h) = x(t-b) + delta_hat(b+h).</p></li>
<li><p><strong>recency_weight</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The recency weight parameter to use when estimating delta_hat.</p></li>
<li><p><strong>accel_weight</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The weight to scale the acceleration by when computing delta_hat.
Specifically, delta_hat(b+h) = velocity(b+h) + accel_weight * acceleration(b+h).</p></li>
<li><p><strong>optimize_acc</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If True, the acceleration correction will only be used at scales
ranging from 1,…(max_backstep+max_forecast_steps)/2.</p></li>
<li><p><strong>eta</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The parameter used to control the rate at which recency_weight gets
tuned when online updates are made to the model and losses can be computed.</p></li>
<li><p><strong>rho</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The parameter that determines what fraction of the overall error is due to
velcity error, while the rest is due to the complement. The error at any scale 
will be determined as <code class="docutils literal notranslate"><span class="pre">rho</span> <span class="pre">*</span> <span class="pre">velocity_error</span> <span class="pre">+</span> <span class="pre">(1-rho)</span> <span class="pre">*</span> <span class="pre">loss_error</span></code>.</p></li>
<li><p><strong>phi</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The parameter used to exponentially inflate the magnitude of loss error at
different scales. Loss error for scale <code class="docutils literal notranslate"><span class="pre">s</span></code> will be increased by a factor of <code class="docutils literal notranslate"><span class="pre">phi</span> <span class="pre">**</span> <span class="pre">s</span></code>.</p></li>
<li><p><strong>inflation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The inflation exponent to use when computing the distribution
p(b|h) over the models when forecasting at horizon h according to standard
errors of the estimated velocities over the models; inflation=1 is equivalent
to using the softmax function.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.MSESConfig.max_scale">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">max_scale</span></span><a class="headerlink" href="#merlion.models.forecast.smoother.MSESConfig.max_scale" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.MSESConfig.backsteps">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">backsteps</span></span><a class="headerlink" href="#merlion.models.forecast.smoother.MSESConfig.backsteps" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.MSESTrainConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.smoother.</span></span><span class="sig-name descname"><span class="pre">MSESTrainConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">incremental</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_losses</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tune_recency_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_batch_sz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_cadence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.MSESTrainConfig" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>MSES training configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>incremental</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If True, train the MSES model incrementally with the initial
training data at the given <code class="docutils literal notranslate"><span class="pre">train_cadence</span></code>. This allows MSES to return a
forecast for the training data.</p></li>
<li><p><strong>init_batch_sz</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The size of the inital training batch for MSES. This is
necessary because MSES cannot predict the past, but needs to start with some
data. This should be very small. 2 is the minimum, and is recommended because
2 will result in the most representative train forecast.</p></li>
<li><p><strong>train_cadence</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – The frequency at which the training forecasts will be generated
during incremental training.</p></li>
</ul>
</dd>
<dt class="field-even">Param</dt>
<dd class="field-even"><p>If True, track the losses encountered during incremental initial training.</p>
</dd>
<dt class="field-odd">Tune_recency_weights</dt>
<dd class="field-odd"><p>If True, tune recency weights during incremental initial
training.</p>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.MSES">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.smoother.</span></span><span class="sig-name descname"><span class="pre">MSES</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.MSES" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase" title="merlion.models.forecast.base.ForecasterBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForecasterBase</span></code></a></p>
<p>Multi-scale Exponential Smoother (MSES) is a forecasting algorithm modeled heavily 
after classical mechanical concepts, namely, velocity and acceleration.</p>
<p>Having seen data points of a time series up to time t, MSES forecasts x(t+h) by
anchoring at a value b steps back from the last known value, x(t-b), and estimating the
delta between x(t-b) and x(t+h). The delta over these b+h timesteps, delta(b+h), also known 
as the delta at scale b+h, is predicted by estimating the velocity over these timesteps 
as well as the change in the velocity, acceleration. Specifically,</p>
<blockquote>
<div><p>xhat(t+h) = x(t-b) + velocity_hat(b+h) + acceleration_hat(b+h)</p>
</div></blockquote>
<p>This estimation is done for each b, known as a backstep, from 0, which anchors at x(t), 
1,… up to a maximum backstep configurable by the user. The algorithm then takes the 
seperate forecasts of x(t+h), indexed by which backstep was used, xhat_b(t+h), and determines
a final forecast: p(b|h) dot xhat_b, where p(b|h) is a distribution over the xhat_b’s that is 
determined according to the lowest standard errors of the recency-weighted velocity estimates.</p>
<p>Letting <code class="docutils literal notranslate"><span class="pre">w</span></code> be the recency weight, <code class="docutils literal notranslate"><span class="pre">B</span></code> the maximum backstep, <code class="docutils literal notranslate"><span class="pre">x_t</span></code> the last seen data point,
and <code class="docutils literal notranslate"><span class="pre">l_s,t</span></code> the series of losses for scale <code class="docutils literal notranslate"><span class="pre">s</span></code>.</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
\hat{x}_{t+h} &amp; = \sum_{b=0}^B p_{b} \cdot (x_{t-b} + v_{b+h,t} + a_{b+h,t}) \\
\space \\
\text{where} \space\space &amp; v_{b+h,t} = \text{EMA}_w(\Delta_{b+h} x_t)   \\
&amp; a_{b+h,t} = \text{EMA}_w(\Delta_{b+h}^2 x_t) \\
\text{and} \space\space &amp; p_b = \sigma(z)_b \space\space \\
\text{if} &amp; \space\space  z_b = (b+h)^\phi \cdot \text{EMA}_w(l_{b+h,t}) \cdot \text{RWSE}_w(l_{b+h,t})\\
\end{align*}\end{split}\]</div>
</div></blockquote>
<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.MSES.config_class">
<span class="sig-name descname"><span class="pre">config_class</span></span><a class="headerlink" href="#merlion.models.forecast.smoother.MSES.config_class" title="Permalink to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#merlion.models.forecast.smoother.MSESConfig" title="merlion.models.forecast.smoother.MSESConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">MSESConfig</span></code></a></p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.MSES.rho">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rho</span></span><a class="headerlink" href="#merlion.models.forecast.smoother.MSES.rho" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.MSES.backsteps">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">backsteps</span></span><a class="headerlink" href="#merlion.models.forecast.smoother.MSES.backsteps" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.MSES.max_horizon">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">max_horizon</span></span><a class="headerlink" href="#merlion.models.forecast.smoother.MSES.max_horizon" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.MSES.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.MSES.train" title="Permalink to this definition"></a></dt>
<dd><p>Trains the forecaster on the input time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_data</strong> (<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>) – a <a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref any py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a> of metric values to train the model.</p></li>
<li><p><strong>train_config</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="#merlion.models.forecast.smoother.MSESTrainConfig" title="merlion.models.forecast.smoother.MSESTrainConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">MSESTrainConfig</span></code></a>]) – Additional training configs, if needed. Only
required for some models.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the model’s prediction on <code class="docutils literal notranslate"><span class="pre">train_data</span></code>, in the same format as
if you called <a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase.forecast" title="merlion.models.forecast.base.ForecasterBase.forecast"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">ForecasterBase.forecast</span></code></a> on the time stamps of
<code class="docutils literal notranslate"><span class="pre">train_data</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.MSES.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tune_recency_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_cadence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.MSES.update" title="Permalink to this definition"></a></dt>
<dd><p>Updates the MSES model with new data that has been acquired since the model’s
initial training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>new_data</strong> (<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>) – New data that has occured since the last training time.</p></li>
<li><p><strong>tune_recency_weights</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If True, the model will first forecast the values at the
new_data’s timestamps, calculate the associated losses, and use these losses
to make updates to the recency weight.</p></li>
<li><p><strong>train_cadence</strong> – The frequency at which the training forecasts will be generated
during incremental training.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.MSES.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_stamps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_series_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_iqr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.MSES.forecast" title="Permalink to this definition"></a></dt>
<dd><p>Returns the model’s forecast on the timestamps given. Note that if
<code class="docutils literal notranslate"><span class="pre">self.transform</span></code> is specified in the config, the forecast is a forecast
of transformed values! It is up to you to manually invert the transform
if desired.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_stamps</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – Either a <code class="docutils literal notranslate"><span class="pre">list</span></code> of timestamps we wish to forecast for,
or the number of steps (<code class="docutils literal notranslate"><span class="pre">int</span></code>) we wish to forecast for.</p></li>
<li><p><strong>time_series_prev</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]) – a list of (timestamp, value) pairs immediately
preceding <code class="docutils literal notranslate"><span class="pre">time_series</span></code>. If given, we use it to initialize the time
series model. Otherwise, we assume that <code class="docutils literal notranslate"><span class="pre">time_series</span></code> immediately
follows the training data.</p></li>
<li><p><strong>return_iqr</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to return the inter-quartile range for the
forecast. Note that not all models support this option.</p></li>
<li><p><strong>return_prev</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – whether to return the forecast for
<code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code> (and its stderr or IQR if relevant), in addition
to the forecast for <code class="docutils literal notranslate"><span class="pre">time_stamps</span></code>. Only used if <code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code>
is provided.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p><code class="docutils literal notranslate"><span class="pre">(forecast,</span> <span class="pre">forecast_stderr)</span></code> if <code class="docutils literal notranslate"><span class="pre">return_iqr</span></code> is false,
<code class="docutils literal notranslate"><span class="pre">(forecast,</span> <span class="pre">forecast_lb,</span> <span class="pre">forecast_ub)</span></code> otherwise.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">forecast</span></code>: the forecast for the timestamps given</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">forecast_stderr</span></code>: the standard error of each forecast value.</dt><dd><p>May be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">forecast_lb</span></code>: 25th percentile of forecast values for each timestamp</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">forecast_ub</span></code>: 75th percentile of forecast values for each timestamp</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.MSES.xhat_h">
<span class="sig-name descname"><span class="pre">xhat_h</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">horizon</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.MSES.xhat_h" title="Permalink to this definition"></a></dt>
<dd><p>Returns the forecasts for the input horizon at every backstep.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.MSES.marginalize_xhat_h">
<span class="sig-name descname"><span class="pre">marginalize_xhat_h</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">horizon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xhat_h</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.MSES.marginalize_xhat_h" title="Permalink to this definition"></a></dt>
<dd><p>Given a list of forecasted values produced by delta estimators at
different backsteps, compute a weighted average of these values. The
weights are assigned based on the standard errors of the velocities,
where the b’th estimate will be given more weight if its velocity has a
lower standard error relative to the other estimates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>horizon</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – the horizon at which we want to predict</p></li>
<li><p><strong>xhat_h</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – the forecasted values at this horizon, using each of
the possible backsteps</p></li>
</ul>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaStats">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.smoother.</span></span><span class="sig-name descname"><span class="pre">DeltaStats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recency_weight</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaStats" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A wrapper around the statistics used to estimate deltas at a given scale.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scale</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The scale associated with the statistics</p></li>
<li><p><strong>recency_weight</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The recency weight parameter that that the incremental
velocity, acceleration and standard error statistics should use.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaStats.lag">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">lag</span></span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaStats.lag" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaStats.update_velocity">
<span class="sig-name descname"><span class="pre">update_velocity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vels</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaStats.update_velocity" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaStats.update_acceleration">
<span class="sig-name descname"><span class="pre">update_acceleration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">accs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaStats.update_acceleration" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaStats.update_loss">
<span class="sig-name descname"><span class="pre">update_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">losses</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaStats.update_loss" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaStats.tune">
<span class="sig-name descname"><span class="pre">tune</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">losses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaStats.tune" title="Permalink to this definition"></a></dt>
<dd><p>Tunes the recency weight according to recent forecast losses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>losses</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – List of recent losses.</p></li>
<li><p><strong>eta</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Constant by which to scale the update to the recency weight.
A bigger eta means more aggressive updates to the recency_weight.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.smoother.</span></span><span class="sig-name descname"><span class="pre">DeltaEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recency_weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accel_weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimize_acc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaEstimator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for estimating the delta for MSES.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_scale</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Delta Estimator can estimate delta over multiple scales, or
time steps, ranging from 1,2,…,max_scale.</p></li>
<li><p><strong>recency_weight</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The recency weight parameter to use when estimating delta_hat.</p></li>
<li><p><strong>accel_weight</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The weight to scale the acceleration by when computing delta_hat.
Specifically, delta_hat(b+h) = velocity(b+h) + accel_weight * acceleration(b+h).</p></li>
<li><p><strong>optimize_acc</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If True, the acceleration correction will only be used at scales
ranging from 1,…,max_scale/2.</p></li>
<li><p><strong>eta</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The parameter used to control the rate at which recency_weight gets
tuned when online updates are made to the model and losses can be computed.</p></li>
<li><p><strong>data</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.UnivariateTimeSeries" title="merlion.utils.time_series.UnivariateTimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">UnivariateTimeSeries</span></code></a>]) – The data to initialize the delta estimator with.</p></li>
<li><p><strong>stats</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <a class="reference internal" href="#merlion.models.forecast.smoother.DeltaStats" title="merlion.models.forecast.smoother.DeltaStats"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeltaStats</span></code></a>]]) – Dictionary mapping scales to DeltaStats objects to be used for delta
estimation.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaEstimator.acc_max_scale">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">acc_max_scale</span></span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaEstimator.acc_max_scale" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaEstimator.max_scale">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">max_scale</span></span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaEstimator.max_scale" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaEstimator.data">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data</span></span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaEstimator.data" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaEstimator.x">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">x</span></span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaEstimator.x" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaEstimator.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaEstimator.train" title="Permalink to this definition"></a></dt>
<dd><p>Updates the delta statistics: velocity, acceleration and velocity
standard error at each scale using new data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>new_data</strong> (<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.UnivariateTimeSeries" title="merlion.utils.time_series.UnivariateTimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">UnivariateTimeSeries</span></code></a>) – new datapoints in the time series.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaEstimator.process_losses">
<span class="sig-name descname"><span class="pre">process_losses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale_losses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tune_recency_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaEstimator.process_losses" title="Permalink to this definition"></a></dt>
<dd><p>Uses recent forecast errors to improve the delta estimator. This is done by updating
the recency_weight that is used by delta stats at particular scales.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scale_losses</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – A dictionary mapping a scale to a list of forecasting errors
that associated with that scale.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaEstimator.velocity">
<span class="sig-name descname"><span class="pre">velocity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaEstimator.velocity" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaEstimator.acceleration">
<span class="sig-name descname"><span class="pre">acceleration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaEstimator.acceleration" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaEstimator.vel_err">
<span class="sig-name descname"><span class="pre">vel_err</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaEstimator.vel_err" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaEstimator.pos_err">
<span class="sig-name descname"><span class="pre">pos_err</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaEstimator.pos_err" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaEstimator.neg_err">
<span class="sig-name descname"><span class="pre">neg_err</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaEstimator.neg_err" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaEstimator.loss_err">
<span class="sig-name descname"><span class="pre">loss_err</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaEstimator.loss_err" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.smoother.DeltaEstimator.delta_hat">
<span class="sig-name descname"><span class="pre">delta_hat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.smoother.DeltaEstimator.delta_hat" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>
</dd></dl>
</section>
<section id="module-merlion.models.forecast.vector_ar">
<span id="merlion-models-forecast-vector-ar-module"></span><h2>merlion.models.forecast.vector_ar module<a class="headerlink" href="#module-merlion.models.forecast.vector_ar" title="Permalink to this heading"></a></h2>
<p>Vector AutoRegressive model for multivariate time series forecasting.</p>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.vector_ar.VectorARConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.vector_ar.</span></span><span class="sig-name descname"><span class="pre">VectorARConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_forecast_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxlags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_seq_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.vector_ar.VectorARConfig" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.base.ForecasterConfig" title="merlion.models.forecast.base.ForecasterConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForecasterConfig</span></code></a></p>
<p>Config object used to define a forecaster model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_forecast_steps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Max # of steps we would like to forecast for.</p></li>
<li><p><strong>maxlags</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Max # of lags for AR</p></li>
<li><p><strong>target_seq_index</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – The index of the univariate (amongst all
univariates in a general multivariate time series) whose value we
would like to forecast.</p></li>
<li><p><strong>maxlags</strong> – Max # of lags for AR</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.vector_ar.VectorAR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.vector_ar.</span></span><span class="sig-name descname"><span class="pre">VectorAR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.vector_ar.VectorAR" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase" title="merlion.models.forecast.base.ForecasterBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForecasterBase</span></code></a></p>
<p>Vector AutoRegressive model for multivariate time series forecasting.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.vector_ar.VectorAR.config_class">
<span class="sig-name descname"><span class="pre">config_class</span></span><a class="headerlink" href="#merlion.models.forecast.vector_ar.VectorAR.config_class" title="Permalink to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#merlion.models.forecast.vector_ar.VectorARConfig" title="merlion.models.forecast.vector_ar.VectorARConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">VectorARConfig</span></code></a></p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.vector_ar.VectorAR.maxlags">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">maxlags</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#merlion.models.forecast.vector_ar.VectorAR.maxlags" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.vector_ar.VectorAR.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.vector_ar.VectorAR.train" title="Permalink to this definition"></a></dt>
<dd><p>Trains the forecaster on the input time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_data</strong> (<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>) – a <a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref any py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a> of metric values to train the model.</p></li>
<li><p><strong>train_config</strong> – Additional training configs, if needed. Only
required for some models.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the model’s prediction on <code class="docutils literal notranslate"><span class="pre">train_data</span></code>, in the same format as
if you called <a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase.forecast" title="merlion.models.forecast.base.ForecasterBase.forecast"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">ForecasterBase.forecast</span></code></a> on the time stamps of
<code class="docutils literal notranslate"><span class="pre">train_data</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.vector_ar.VectorAR.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_stamps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_series_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_iqr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.vector_ar.VectorAR.forecast" title="Permalink to this definition"></a></dt>
<dd><p>Returns the model’s forecast on the timestamps given. Note that if
<code class="docutils literal notranslate"><span class="pre">self.transform</span></code> is specified in the config, the forecast is a forecast
of transformed values! It is up to you to manually invert the transform
if desired.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_stamps</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – Either a <code class="docutils literal notranslate"><span class="pre">list</span></code> of timestamps we wish to forecast for,
or the number of steps (<code class="docutils literal notranslate"><span class="pre">int</span></code>) we wish to forecast for.</p></li>
<li><p><strong>time_series_prev</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]) – a list of (timestamp, value) pairs immediately
preceding <code class="docutils literal notranslate"><span class="pre">time_series</span></code>. If given, we use it to initialize the time
series model. Otherwise, we assume that <code class="docutils literal notranslate"><span class="pre">time_series</span></code> immediately
follows the training data.</p></li>
<li><p><strong>return_iqr</strong> – whether to return the inter-quartile range for the
forecast. Note that not all models support this option.</p></li>
<li><p><strong>return_prev</strong> – whether to return the forecast for
<code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code> (and its stderr or IQR if relevant), in addition
to the forecast for <code class="docutils literal notranslate"><span class="pre">time_stamps</span></code>. Only used if <code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code>
is provided.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p><code class="docutils literal notranslate"><span class="pre">(forecast,</span> <span class="pre">forecast_stderr)</span></code> if <code class="docutils literal notranslate"><span class="pre">return_iqr</span></code> is false,
<code class="docutils literal notranslate"><span class="pre">(forecast,</span> <span class="pre">forecast_lb,</span> <span class="pre">forecast_ub)</span></code> otherwise.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">forecast</span></code>: the forecast for the timestamps given</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">forecast_stderr</span></code>: the standard error of each forecast value.</dt><dd><p>May be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">forecast_lb</span></code>: 25th percentile of forecast values for each timestamp</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">forecast_ub</span></code>: 75th percentile of forecast values for each timestamp</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.vector_ar.VectorAR.set_data_already_transformed">
<span class="sig-name descname"><span class="pre">set_data_already_transformed</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.vector_ar.VectorAR.set_data_already_transformed" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.vector_ar.VectorAR.reset_data_already_transformed">
<span class="sig-name descname"><span class="pre">reset_data_already_transformed</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.vector_ar.VectorAR.reset_data_already_transformed" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
</dd></dl>
</section>
<section id="module-merlion.models.forecast.baggingtrees">
<span id="merlion-models-forecast-baggingtrees-module"></span><h2>merlion.models.forecast.baggingtrees module<a class="headerlink" href="#module-merlion.models.forecast.baggingtrees" title="Permalink to this heading"></a></h2>
<p>Bagging Tree-based models for multivariate time series forecasting.
Random Forest
ExtraTreesRegressor</p>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.baggingtrees.BaggingTreeForecasterConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.baggingtrees.</span></span><span class="sig-name descname"><span class="pre">BaggingTreeForecasterConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_forecast_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxlags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_seq_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'normal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_estimators</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_samples_split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.baggingtrees.BaggingTreeForecasterConfig" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.base.ForecasterConfig" title="merlion.models.forecast.base.ForecasterConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForecasterConfig</span></code></a></p>
<p>Configuration class for bagging Tree-based forecaster model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_forecast_steps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Max # of steps we would like to forecast for.</p></li>
<li><p><strong>maxlags</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Max # of lags for forecasting</p></li>
<li><p><strong>target_seq_index</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – The index of the univariate (amongst all
univariates in a general multivariate time series) whose value we
would like to forecast.</p></li>
<li><p><strong>sampling_mode</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – how to process time series data for the tree model. If “normal”,
then concatenate all sequences over the window. If “stats”, then give statistics
measures over the window. Note: “stats” mode is statistical summary for a multivariate dataset,
mainly to reduce the computation cost for high-dimensional time series. For univariate data, it is
not necessary to use “stats” instead of the sequence itself as the input. Therefore, for univariate,
the model will automatically adopt “normal” mode.</p></li>
<li><p><strong>prediction_stride</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – <p>the prediction step for training and forecasting</p>
<ul>
<li><p>If univariate: the sequence target of the length of prediction_stride will be utilized, forecasting will be
done by means of autoregression with the stride unit of prediction_stride</p></li>
<li><p>If multivariate:</p>
<blockquote>
<div><ul class="simple">
<li><p>if = 1: the autoregression with the stride unit of 1</p></li>
<li><p>if &gt; 1: only support sequence mode, and the model will set prediction_stride = max_forecast_steps</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</p></li>
<li><p><strong>n_estimators</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of base estimators for the tree ensemble</p></li>
<li><p><strong>random_state</strong> – random seed for bagging</p></li>
<li><p><strong>max_depth</strong> – max depth of base estimators</p></li>
<li><p><strong>min_samples_split</strong> – min split for tree leaves</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.baggingtrees.BaggingTreeForecaster">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.baggingtrees.</span></span><span class="sig-name descname"><span class="pre">BaggingTreeForecaster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.baggingtrees.BaggingTreeForecaster" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase" title="merlion.models.forecast.base.ForecasterBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForecasterBase</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">MultiVariateAutoRegressionMixin</span></code></p>
<p>Tree model for multivariate time series forecasting.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.baggingtrees.BaggingTreeForecaster.config_class">
<span class="sig-name descname"><span class="pre">config_class</span></span><a class="headerlink" href="#merlion.models.forecast.baggingtrees.BaggingTreeForecaster.config_class" title="Permalink to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#merlion.models.forecast.baggingtrees.BaggingTreeForecasterConfig" title="merlion.models.forecast.baggingtrees.BaggingTreeForecasterConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaggingTreeForecasterConfig</span></code></a></p>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.baggingtrees.BaggingTreeForecaster.model">
<span class="sig-name descname"><span class="pre">model</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#merlion.models.forecast.baggingtrees.BaggingTreeForecaster.model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.baggingtrees.BaggingTreeForecaster.maxlags">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">maxlags</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#merlion.models.forecast.baggingtrees.BaggingTreeForecaster.maxlags" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.baggingtrees.BaggingTreeForecaster.sampling_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sampling_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#merlion.models.forecast.baggingtrees.BaggingTreeForecaster.sampling_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.baggingtrees.BaggingTreeForecaster.prediction_stride">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">prediction_stride</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#merlion.models.forecast.baggingtrees.BaggingTreeForecaster.prediction_stride" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.baggingtrees.BaggingTreeForecaster.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.baggingtrees.BaggingTreeForecaster.train" title="Permalink to this definition"></a></dt>
<dd><p>Trains the forecaster on the input time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_data</strong> (<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>) – a <a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref any py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a> of metric values to train the model.</p></li>
<li><p><strong>train_config</strong> – Additional training configs, if needed. Only
required for some models.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the model’s prediction on <code class="docutils literal notranslate"><span class="pre">train_data</span></code>, in the same format as
if you called <a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase.forecast" title="merlion.models.forecast.base.ForecasterBase.forecast"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">ForecasterBase.forecast</span></code></a> on the time stamps of
<code class="docutils literal notranslate"><span class="pre">train_data</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.baggingtrees.BaggingTreeForecaster.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_stamps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_series_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_iqr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.baggingtrees.BaggingTreeForecaster.forecast" title="Permalink to this definition"></a></dt>
<dd><p>Returns the model’s forecast on the timestamps given. Note that if
<code class="docutils literal notranslate"><span class="pre">self.transform</span></code> is specified in the config, the forecast is a forecast
of transformed values! It is up to you to manually invert the transform
if desired.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_stamps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – Either a <code class="docutils literal notranslate"><span class="pre">list</span></code> of timestamps we wish to forecast for,
or the number of steps (<code class="docutils literal notranslate"><span class="pre">int</span></code>) we wish to forecast for.</p></li>
<li><p><strong>time_series_prev</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]) – a list of (timestamp, value) pairs immediately
preceding <code class="docutils literal notranslate"><span class="pre">time_series</span></code>. If given, we use it to initialize the time
series model. Otherwise, we assume that <code class="docutils literal notranslate"><span class="pre">time_series</span></code> immediately
follows the training data.</p></li>
<li><p><strong>return_iqr</strong> – whether to return the inter-quartile range for the
forecast. Note that not all models support this option.</p></li>
<li><p><strong>return_prev</strong> – whether to return the forecast for
<code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code> (and its stderr or IQR if relevant), in addition
to the forecast for <code class="docutils literal notranslate"><span class="pre">time_stamps</span></code>. Only used if <code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code>
is provided.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><code class="docutils literal notranslate"><span class="pre">(forecast,</span> <span class="pre">forecast_stderr)</span></code> if <code class="docutils literal notranslate"><span class="pre">return_iqr</span></code> is false,
<code class="docutils literal notranslate"><span class="pre">(forecast,</span> <span class="pre">forecast_lb,</span> <span class="pre">forecast_ub)</span></code> otherwise.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">forecast</span></code>: the forecast for the timestamps given</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">forecast_stderr</span></code>: the standard error of each forecast value.</dt><dd><p>May be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">forecast_lb</span></code>: 25th percentile of forecast values for each timestamp</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">forecast_ub</span></code>: 75th percentile of forecast values for each timestamp</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.baggingtrees.BaggingTreeForecaster.set_data_already_transformed">
<span class="sig-name descname"><span class="pre">set_data_already_transformed</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.baggingtrees.BaggingTreeForecaster.set_data_already_transformed" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.baggingtrees.BaggingTreeForecaster.reset_data_already_transformed">
<span class="sig-name descname"><span class="pre">reset_data_already_transformed</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.baggingtrees.BaggingTreeForecaster.reset_data_already_transformed" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.baggingtrees.RandomForestForecasterConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.baggingtrees.</span></span><span class="sig-name descname"><span class="pre">RandomForestForecasterConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_forecast_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxlags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_seq_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'normal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_estimators</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_samples_split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.baggingtrees.RandomForestForecasterConfig" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.baggingtrees.BaggingTreeForecasterConfig" title="merlion.models.forecast.baggingtrees.BaggingTreeForecasterConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaggingTreeForecasterConfig</span></code></a></p>
<p>Configuration class for bagging Tree-based forecaster model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_forecast_steps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Max # of steps we would like to forecast for.</p></li>
<li><p><strong>maxlags</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Max # of lags for forecasting</p></li>
<li><p><strong>target_seq_index</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – The index of the univariate (amongst all
univariates in a general multivariate time series) whose value we
would like to forecast.</p></li>
<li><p><strong>sampling_mode</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – how to process time series data for the tree model. If “normal”,
then concatenate all sequences over the window. If “stats”, then give statistics
measures over the window. Note: “stats” mode is statistical summary for a multivariate dataset,
mainly to reduce the computation cost for high-dimensional time series. For univariate data, it is
not necessary to use “stats” instead of the sequence itself as the input. Therefore, for univariate,
the model will automatically adopt “normal” mode.</p></li>
<li><p><strong>prediction_stride</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – <p>the prediction step for training and forecasting</p>
<ul>
<li><p>If univariate: the sequence target of the length of prediction_stride will be utilized, forecasting will be
done by means of autoregression with the stride unit of prediction_stride</p></li>
<li><p>If multivariate:</p>
<blockquote>
<div><ul class="simple">
<li><p>if = 1: the autoregression with the stride unit of 1</p></li>
<li><p>if &gt; 1: only support sequence mode, and the model will set prediction_stride = max_forecast_steps</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</p></li>
<li><p><strong>n_estimators</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of base estimators for the tree ensemble</p></li>
<li><p><strong>random_state</strong> – random seed for bagging</p></li>
<li><p><strong>max_depth</strong> – max depth of base estimators</p></li>
<li><p><strong>min_samples_split</strong> – min split for tree leaves</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.baggingtrees.RandomForestForecaster">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.baggingtrees.</span></span><span class="sig-name descname"><span class="pre">RandomForestForecaster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.baggingtrees.RandomForestForecaster" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.baggingtrees.BaggingTreeForecaster" title="merlion.models.forecast.baggingtrees.BaggingTreeForecaster"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaggingTreeForecaster</span></code></a></p>
<p>Random Forest Regressor for time series forecasting</p>
<p>Random Forest is a meta estimator that fits a number of classifying decision
trees on various sub-samples of the dataset, and uses averaging to improve
the predictive accuracy and control over-fitting.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.baggingtrees.RandomForestForecaster.config_class">
<span class="sig-name descname"><span class="pre">config_class</span></span><a class="headerlink" href="#merlion.models.forecast.baggingtrees.RandomForestForecaster.config_class" title="Permalink to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#merlion.models.forecast.baggingtrees.RandomForestForecasterConfig" title="merlion.models.forecast.baggingtrees.RandomForestForecasterConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">RandomForestForecasterConfig</span></code></a></p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.baggingtrees.ExtraTreesForecasterConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.baggingtrees.</span></span><span class="sig-name descname"><span class="pre">ExtraTreesForecasterConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_forecast_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxlags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_seq_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'normal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_estimators</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_samples_split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.baggingtrees.ExtraTreesForecasterConfig" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.baggingtrees.BaggingTreeForecasterConfig" title="merlion.models.forecast.baggingtrees.BaggingTreeForecasterConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaggingTreeForecasterConfig</span></code></a></p>
<p>Configuration class for bagging Tree-based forecaster model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_forecast_steps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Max # of steps we would like to forecast for.</p></li>
<li><p><strong>maxlags</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Max # of lags for forecasting</p></li>
<li><p><strong>target_seq_index</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – The index of the univariate (amongst all
univariates in a general multivariate time series) whose value we
would like to forecast.</p></li>
<li><p><strong>sampling_mode</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – how to process time series data for the tree model. If “normal”,
then concatenate all sequences over the window. If “stats”, then give statistics
measures over the window. Note: “stats” mode is statistical summary for a multivariate dataset,
mainly to reduce the computation cost for high-dimensional time series. For univariate data, it is
not necessary to use “stats” instead of the sequence itself as the input. Therefore, for univariate,
the model will automatically adopt “normal” mode.</p></li>
<li><p><strong>prediction_stride</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – <p>the prediction step for training and forecasting</p>
<ul>
<li><p>If univariate: the sequence target of the length of prediction_stride will be utilized, forecasting will be
done by means of autoregression with the stride unit of prediction_stride</p></li>
<li><p>If multivariate:</p>
<blockquote>
<div><ul class="simple">
<li><p>if = 1: the autoregression with the stride unit of 1</p></li>
<li><p>if &gt; 1: only support sequence mode, and the model will set prediction_stride = max_forecast_steps</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</p></li>
<li><p><strong>n_estimators</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – number of base estimators for the tree ensemble</p></li>
<li><p><strong>random_state</strong> – random seed for bagging</p></li>
<li><p><strong>max_depth</strong> – max depth of base estimators</p></li>
<li><p><strong>min_samples_split</strong> – min split for tree leaves</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.baggingtrees.ExtraTreesForecaster">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.baggingtrees.</span></span><span class="sig-name descname"><span class="pre">ExtraTreesForecaster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.baggingtrees.ExtraTreesForecaster" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.baggingtrees.BaggingTreeForecaster" title="merlion.models.forecast.baggingtrees.BaggingTreeForecaster"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaggingTreeForecaster</span></code></a></p>
<p>Extra Trees Regressor for time series forecasting</p>
<p>Extra Trees Regressor implements a meta estimator that fits a number of
randomized decision trees (a.k.a. extra-trees) on various sub-samples of
the dataset and uses averaging to improve the predictive accuracy and
control over-fitting.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.baggingtrees.ExtraTreesForecaster.config_class">
<span class="sig-name descname"><span class="pre">config_class</span></span><a class="headerlink" href="#merlion.models.forecast.baggingtrees.ExtraTreesForecaster.config_class" title="Permalink to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#merlion.models.forecast.baggingtrees.ExtraTreesForecasterConfig" title="merlion.models.forecast.baggingtrees.ExtraTreesForecasterConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExtraTreesForecasterConfig</span></code></a></p>
</dd></dl>
</dd></dl>
</section>
<section id="module-merlion.models.forecast.boostingtrees">
<span id="merlion-models-forecast-bo0stingtrees-module"></span><h2>merlion.models.forecast.bo0stingtrees module<a class="headerlink" href="#module-merlion.models.forecast.boostingtrees" title="Permalink to this heading"></a></h2>
<p>Boosting Tree-based models for multivariate time series forecasting.
LightGBM</p>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.boostingtrees.BoostingTreeForecasterConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.boostingtrees.</span></span><span class="sig-name descname"><span class="pre">BoostingTreeForecasterConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_forecast_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxlags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_seq_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'normal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_estimators</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.boostingtrees.BoostingTreeForecasterConfig" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.base.ForecasterConfig" title="merlion.models.forecast.base.ForecasterConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForecasterConfig</span></code></a></p>
<p>Configuration class for boosting Tree-based forecaster model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_forecast_steps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Max # of steps we would like to forecast for.</p></li>
<li><p><strong>target_seq_index</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – The index of the univariate (amongst all
univariates in a general multivariate time series) whose value we
would like to forecast.</p></li>
<li><p><strong>maxlags</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Max # of lags for forecasting</p></li>
<li><p><strong>sampling_mode</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – how to process time series data for the tree model. If “normal”,
then concatenate all sequences over the window. If “stats”, then give statistics
measures over the window. Note: “stats” mode is statistical summary for a multivariate dataset,
mainly to reduce the computation cost for high-dimensional time series. For univariate data, it is
not necessary to use “stats” instead of the sequence itself as the input. Therefore, for univariate,
the model will automatically adopt “normal” mode.</p></li>
<li><p><strong>prediction_stride</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – <p>the prediction step for training and forecasting</p>
<ul>
<li><p>If univariate: the sequence target of the length of prediction_stride will be utilized, forecasting will be
done by means of autoregression with the stride unit of prediction_stride</p></li>
<li><p>If multivariate:</p>
<blockquote>
<div><ul class="simple">
<li><p>if = 1: the autoregression with the stride unit of 1</p></li>
<li><p>if &gt; 1: only support sequence mode, and the model will set prediction_stride = max_forecast_steps</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</p></li>
<li><p><strong>learning_rate</strong> – learning rate for boosting</p></li>
<li><p><strong>n_estimators</strong> – number of base estimators for the tree ensemble</p></li>
<li><p><strong>random_state</strong> – random seed for boosting</p></li>
<li><p><strong>max_depth</strong> – max depth of base estimators</p></li>
<li><p><strong>n_jobs</strong> – num of threading, -1 or 0 indicates device default,
positive int indicates num of threads</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.boostingtrees.BoostingTreeForecaster">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.boostingtrees.</span></span><span class="sig-name descname"><span class="pre">BoostingTreeForecaster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.boostingtrees.BoostingTreeForecaster" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase" title="merlion.models.forecast.base.ForecasterBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForecasterBase</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">MultiVariateAutoRegressionMixin</span></code></p>
<p>Tree model for multivariate time series forecasting.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.boostingtrees.BoostingTreeForecaster.config_class">
<span class="sig-name descname"><span class="pre">config_class</span></span><a class="headerlink" href="#merlion.models.forecast.boostingtrees.BoostingTreeForecaster.config_class" title="Permalink to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#merlion.models.forecast.boostingtrees.BoostingTreeForecasterConfig" title="merlion.models.forecast.boostingtrees.BoostingTreeForecasterConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">BoostingTreeForecasterConfig</span></code></a></p>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.boostingtrees.BoostingTreeForecaster.model">
<span class="sig-name descname"><span class="pre">model</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#merlion.models.forecast.boostingtrees.BoostingTreeForecaster.model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.boostingtrees.BoostingTreeForecaster.maxlags">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">maxlags</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#merlion.models.forecast.boostingtrees.BoostingTreeForecaster.maxlags" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.boostingtrees.BoostingTreeForecaster.sampling_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sampling_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#merlion.models.forecast.boostingtrees.BoostingTreeForecaster.sampling_mode" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="merlion.models.forecast.boostingtrees.BoostingTreeForecaster.prediction_stride">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">prediction_stride</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#merlion.models.forecast.boostingtrees.BoostingTreeForecaster.prediction_stride" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.boostingtrees.BoostingTreeForecaster.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.boostingtrees.BoostingTreeForecaster.train" title="Permalink to this definition"></a></dt>
<dd><p>Trains the forecaster on the input time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_data</strong> (<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>) – a <a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref any py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a> of metric values to train the model.</p></li>
<li><p><strong>train_config</strong> – Additional training configs, if needed. Only
required for some models.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the model’s prediction on <code class="docutils literal notranslate"><span class="pre">train_data</span></code>, in the same format as
if you called <a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase.forecast" title="merlion.models.forecast.base.ForecasterBase.forecast"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">ForecasterBase.forecast</span></code></a> on the time stamps of
<code class="docutils literal notranslate"><span class="pre">train_data</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.boostingtrees.BoostingTreeForecaster.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_stamps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_series_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_iqr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.boostingtrees.BoostingTreeForecaster.forecast" title="Permalink to this definition"></a></dt>
<dd><p>Returns the model’s forecast on the timestamps given. Note that if
<code class="docutils literal notranslate"><span class="pre">self.transform</span></code> is specified in the config, the forecast is a forecast
of transformed values! It is up to you to manually invert the transform
if desired.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_stamps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – Either a <code class="docutils literal notranslate"><span class="pre">list</span></code> of timestamps we wish to forecast for,
or the number of steps (<code class="docutils literal notranslate"><span class="pre">int</span></code>) we wish to forecast for.</p></li>
<li><p><strong>time_series_prev</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]) – a list of (timestamp, value) pairs immediately
preceding <code class="docutils literal notranslate"><span class="pre">time_series</span></code>. If given, we use it to initialize the time
series model. Otherwise, we assume that <code class="docutils literal notranslate"><span class="pre">time_series</span></code> immediately
follows the training data.</p></li>
<li><p><strong>return_iqr</strong> – whether to return the inter-quartile range for the
forecast. Note that not all models support this option.</p></li>
<li><p><strong>return_prev</strong> – whether to return the forecast for
<code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code> (and its stderr or IQR if relevant), in addition
to the forecast for <code class="docutils literal notranslate"><span class="pre">time_stamps</span></code>. Only used if <code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code>
is provided.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><code class="docutils literal notranslate"><span class="pre">(forecast,</span> <span class="pre">forecast_stderr)</span></code> if <code class="docutils literal notranslate"><span class="pre">return_iqr</span></code> is false,
<code class="docutils literal notranslate"><span class="pre">(forecast,</span> <span class="pre">forecast_lb,</span> <span class="pre">forecast_ub)</span></code> otherwise.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">forecast</span></code>: the forecast for the timestamps given</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">forecast_stderr</span></code>: the standard error of each forecast value.</dt><dd><p>May be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">forecast_lb</span></code>: 25th percentile of forecast values for each timestamp</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">forecast_ub</span></code>: 75th percentile of forecast values for each timestamp</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.boostingtrees.BoostingTreeForecaster.set_data_already_transformed">
<span class="sig-name descname"><span class="pre">set_data_already_transformed</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.boostingtrees.BoostingTreeForecaster.set_data_already_transformed" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.boostingtrees.BoostingTreeForecaster.reset_data_already_transformed">
<span class="sig-name descname"><span class="pre">reset_data_already_transformed</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.boostingtrees.BoostingTreeForecaster.reset_data_already_transformed" title="Permalink to this definition"></a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.boostingtrees.LGBMForecasterConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.boostingtrees.</span></span><span class="sig-name descname"><span class="pre">LGBMForecasterConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_forecast_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxlags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_seq_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'normal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_estimators</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.boostingtrees.LGBMForecasterConfig" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.boostingtrees.BoostingTreeForecasterConfig" title="merlion.models.forecast.boostingtrees.BoostingTreeForecasterConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">BoostingTreeForecasterConfig</span></code></a></p>
<p>Configuration class for boosting Tree-based forecaster model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_forecast_steps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Max # of steps we would like to forecast for.</p></li>
<li><p><strong>target_seq_index</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – The index of the univariate (amongst all
univariates in a general multivariate time series) whose value we
would like to forecast.</p></li>
<li><p><strong>maxlags</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Max # of lags for forecasting</p></li>
<li><p><strong>sampling_mode</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – how to process time series data for the tree model. If “normal”,
then concatenate all sequences over the window. If “stats”, then give statistics
measures over the window. Note: “stats” mode is statistical summary for a multivariate dataset,
mainly to reduce the computation cost for high-dimensional time series. For univariate data, it is
not necessary to use “stats” instead of the sequence itself as the input. Therefore, for univariate,
the model will automatically adopt “normal” mode.</p></li>
<li><p><strong>prediction_stride</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – <p>the prediction step for training and forecasting</p>
<ul>
<li><p>If univariate: the sequence target of the length of prediction_stride will be utilized, forecasting will be
done by means of autoregression with the stride unit of prediction_stride</p></li>
<li><p>If multivariate:</p>
<blockquote>
<div><ul class="simple">
<li><p>if = 1: the autoregression with the stride unit of 1</p></li>
<li><p>if &gt; 1: only support sequence mode, and the model will set prediction_stride = max_forecast_steps</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</p></li>
<li><p><strong>learning_rate</strong> – learning rate for boosting</p></li>
<li><p><strong>n_estimators</strong> – number of base estimators for the tree ensemble</p></li>
<li><p><strong>random_state</strong> – random seed for boosting</p></li>
<li><p><strong>max_depth</strong> – max depth of base estimators</p></li>
<li><p><strong>n_jobs</strong> – num of threading, -1 or 0 indicates device default,
positive int indicates num of threads</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.boostingtrees.LGBMForecaster">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.boostingtrees.</span></span><span class="sig-name descname"><span class="pre">LGBMForecaster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.boostingtrees.LGBMForecaster" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.boostingtrees.BoostingTreeForecaster" title="merlion.models.forecast.boostingtrees.BoostingTreeForecaster"><code class="xref py py-class docutils literal notranslate"><span class="pre">BoostingTreeForecaster</span></code></a></p>
<p>Light gradient boosting (LGBM) regressor for time series forecasting</p>
<p>LightGBM is a light weight and fast gradient boosting framework that uses tree based learning algorithms, for more
details, please refer to the document <a class="reference external" href="https://lightgbm.readthedocs.io/en/latest/Features.html">https://lightgbm.readthedocs.io/en/latest/Features.html</a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.boostingtrees.LGBMForecaster.config_class">
<span class="sig-name descname"><span class="pre">config_class</span></span><a class="headerlink" href="#merlion.models.forecast.boostingtrees.LGBMForecaster.config_class" title="Permalink to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#merlion.models.forecast.boostingtrees.LGBMForecasterConfig" title="merlion.models.forecast.boostingtrees.LGBMForecasterConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">LGBMForecasterConfig</span></code></a></p>
</dd></dl>
</dd></dl>
</section>
<section id="module-merlion.models.forecast.lstm">
<span id="merlion-models-forecast-lstm-module"></span><h2>merlion.models.forecast.lstm module<a class="headerlink" href="#module-merlion.models.forecast.lstm" title="Permalink to this heading"></a></h2>
<p>A forecaster based on a LSTM neural net.</p>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.lstm.LSTMConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.lstm.</span></span><span class="sig-name descname"><span class="pre">LSTMConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_forecast_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_seq_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nhid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1024</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_strides</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.lstm.LSTMConfig" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.base.ForecasterConfig" title="merlion.models.forecast.base.ForecasterConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForecasterConfig</span></code></a></p>
<p>Config object used to define a forecaster model.</p>
<p>Configuration class for <a class="reference internal" href="#merlion.models.forecast.lstm.LSTM" title="merlion.models.forecast.lstm.LSTM"><code class="xref any py py-class docutils literal notranslate"><span class="pre">LSTM</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_forecast_steps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Max # of steps we would like to forecast for.</p></li>
<li><p><strong>target_seq_index</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – The index of the univariate (amongst all
univariates in a general multivariate time series) whose value we
would like to forecast.</p></li>
<li><p><strong>nhid</strong> – hidden dimension of LSTM</p></li>
<li><p><strong>model_strides</strong> – tuple indicating the stride(s) at which we would
like to subsample the input data before giving it to the model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.lstm.LSTMTrainConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.lstm.</span></span><span class="sig-name descname"><span class="pre">LSTMTrainConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'checkpoint.pt'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.lstm.LSTMTrainConfig" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>LSTM training configuration.</p>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="merlion.models.forecast.lstm.LSTM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">merlion.models.forecast.lstm.</span></span><span class="sig-name descname"><span class="pre">LSTM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.lstm.LSTM" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase" title="merlion.models.forecast.base.ForecasterBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForecasterBase</span></code></a></p>
<p>LSTM forecaster: this assume the input time series has equal intervals across all its values
so that we can use sequence modeling to make forecast.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="merlion.models.forecast.lstm.LSTM.config_class">
<span class="sig-name descname"><span class="pre">config_class</span></span><a class="headerlink" href="#merlion.models.forecast.lstm.LSTM.config_class" title="Permalink to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#merlion.models.forecast.lstm.LSTMConfig" title="merlion.models.forecast.lstm.LSTMConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">LSTMConfig</span></code></a></p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.lstm.LSTM.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.lstm.LSTM.train" title="Permalink to this definition"></a></dt>
<dd><p>Trains the forecaster on the input time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_data</strong> (<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>) – a <a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref any py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a> of metric values to train the model.</p></li>
<li><p><strong>train_config</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="#merlion.models.forecast.lstm.LSTMTrainConfig" title="merlion.models.forecast.lstm.LSTMTrainConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">LSTMTrainConfig</span></code></a>]) – Additional training configs, if needed. Only
required for some models.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the model’s prediction on <code class="docutils literal notranslate"><span class="pre">train_data</span></code>, in the same format as
if you called <a class="reference internal" href="#merlion.models.forecast.base.ForecasterBase.forecast" title="merlion.models.forecast.base.ForecasterBase.forecast"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">ForecasterBase.forecast</span></code></a> on the time stamps of
<code class="docutils literal notranslate"><span class="pre">train_data</span></code></p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="merlion.models.forecast.lstm.LSTM.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_stamps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_series_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_iqr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_prev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#merlion.models.forecast.lstm.LSTM.forecast" title="Permalink to this definition"></a></dt>
<dd><p>Returns the model’s forecast on the timestamps given. Note that if
<code class="docutils literal notranslate"><span class="pre">self.transform</span></code> is specified in the config, the forecast is a forecast
of transformed values! It is up to you to manually invert the transform
if desired.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_stamps</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – Either a <code class="docutils literal notranslate"><span class="pre">list</span></code> of timestamps we wish to forecast for,
or the number of steps (<code class="docutils literal notranslate"><span class="pre">int</span></code>) we wish to forecast for.</p></li>
<li><p><strong>time_series_prev</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]) – a list of (timestamp, value) pairs immediately
preceding <code class="docutils literal notranslate"><span class="pre">time_series</span></code>. If given, we use it to initialize the time
series model. Otherwise, we assume that <code class="docutils literal notranslate"><span class="pre">time_series</span></code> immediately
follows the training data.</p></li>
<li><p><strong>return_iqr</strong> – whether to return the inter-quartile range for the
forecast. Note that not all models support this option.</p></li>
<li><p><strong>return_prev</strong> – whether to return the forecast for
<code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code> (and its stderr or IQR if relevant), in addition
to the forecast for <code class="docutils literal notranslate"><span class="pre">time_stamps</span></code>. Only used if <code class="docutils literal notranslate"><span class="pre">time_series_prev</span></code>
is provided.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="merlion.utils.html#merlion.utils.time_series.TimeSeries" title="merlion.utils.time_series.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p><code class="docutils literal notranslate"><span class="pre">(forecast,</span> <span class="pre">forecast_stderr)</span></code> if <code class="docutils literal notranslate"><span class="pre">return_iqr</span></code> is false,
<code class="docutils literal notranslate"><span class="pre">(forecast,</span> <span class="pre">forecast_lb,</span> <span class="pre">forecast_ub)</span></code> otherwise.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">forecast</span></code>: the forecast for the timestamps given</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">forecast_stderr</span></code>: the standard error of each forecast value.</dt><dd><p>May be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">forecast_lb</span></code>: 25th percentile of forecast values for each timestamp</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">forecast_ub</span></code>: 75th percentile of forecast values for each timestamp</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
</section>
</section>
</div>
</div>
<footer><div aria-label="Footer" class="rst-footer-buttons" role="navigation">
<a accesskey="p" class="btn btn-neutral float-left" href="merlion.models.anomaly.forecast_based.html" rel="prev" title="merlion.models.anomaly.forecast_based package"><span aria-hidden="true" class="fa fa-arrow-circle-left"></span> Previous</a>
<a accesskey="n" class="btn btn-neutral float-right" href="merlion.models.ensemble.html" rel="next" title="merlion.models.ensemble package">Next <span aria-hidden="true" class="fa fa-arrow-circle-right"></span></a>
</div>
<hr/>
<div role="contentinfo">
<p>© Copyright 2021, salesforce.com, inc..</p>
</div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
</div>
</div>
</section>
</div>
<div aria-label="versions" class="rst-versions" data-toggle="rst-versions" role="note">
<span class="rst-current-version" data-toggle="rst-current-version">
<span class="fa fa-book"> Versions</span>
      v1.0.1
      <span class="fa fa-caret-down"></span>
</span>
<div class="rst-other-versions">
<dl><dt>Versions</dt><dd><a href="../latest/index.html">latest</a></dd><dd><a href="../v2.0.0/index.html">v2.0.0</a></dd><dd><a href="../v1.3.1/index.html">v1.3.1</a></dd><dd><a href="../v1.3.0/index.html">v1.3.0</a></dd><dd><a href="../v1.2.5/index.html">v1.2.5</a></dd><dd><a href="../v1.2.4/index.html">v1.2.4</a></dd><dd><a href="../v1.2.3/index.html">v1.2.3</a></dd><dd><a href="../v1.2.2/index.html">v1.2.2</a></dd><dd><a href="../v1.2.1/index.html">v1.2.1</a></dd><dd><a href="../v1.2.0/index.html">v1.2.0</a></dd><dd><a href="../v1.1.3/index.html">v1.1.3</a></dd><dd><a href="../v1.1.2/index.html">v1.1.2</a></dd><dd><a href="../v1.1.1/index.html">v1.1.1</a></dd><dd><a href="../v1.1.0/index.html">v1.1.0</a></dd><dd><a href="../v1.0.2/index.html">v1.0.2</a></dd><dd><strong><a href="../v1.0.1/index.html">v1.0.1</a></strong></dd><dd><a href="../v1.0.0/index.html">v1.0.0</a></dd></dl>
</div>
</div>
<script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
</body>
</html>